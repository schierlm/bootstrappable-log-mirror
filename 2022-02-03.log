<!DOCTYPE html><html><head><title>IRC channel logs</title><style>html {
  background: #fdfdfd;
}

h1 {
  font-weight: 300;
}

h2 {
  font-weight: 200;
}

h3 {
  padding: .5em 0;
  border-top: 3px dotted #ddd;
  margin-bottom: 0;
}

form {
  width: 400px;
  display: flex;
}

input {
  width: 100%;
  display: flex;
  border-radius: .25em 0 0 .25em;
  border: 1px solid #aaa;
  border-right: 0;
  padding: 0.5em;
}

button {
  display: flex;
  border-radius: 0 .25em .25em 0;
  background-color: #007bff;
  border: 1px solid #007bff;
  padding: .5em;
  cursor: pointer;
  color: white;
}

button:hover {
  background-color: #0069d9;
  border-color: #0062cc;
}

a {
  color: #007bff;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h4 {
  margin-bottom: .5em;
}

table td {
  padding: 0.75em;
}

table tr:hover {
  background: #eee;
}

.year {
  display: table;
}

.month {
  display: table-cell;
  padding-right: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.nick {
  padding-right: 0.6rem;
  font-weight: bold;
  text-align: right;
  width: 13rem;
  display: table-cell;
}

.nick a {
  color: inherit;
  text-decoration: none;
}

.message {
  display: table-cell;
  padding-left: 0.6rem;
  border-left: 2px solid #333;
}

.notice {
  color: #859900;
  font-style: italic;
}

.line {
  line-height: 1.8rem;
  display: table;
}

#logs {
  margin-top: 1.5rem;
  padding: 1.5rem;
}
</style></head><body><h1>IRC channel logs</h1><h2>2022-02-03.log</h2><p><a href="/bootstrappable">back to list of logs</a></p><div id="logs"><div class="line" id="001523"><span class="nick" style="color:#8dd3c7"><a href="#001523" label="[00:15:23]">&lt;siraben&gt;</a></span><span class="message"> <a rel="nofollow" href="https://github.com/Kindelia/HVM">https://github.com/Kindelia/HVM</a> </span></div><div class="line" id="002724"><span class="nick" style="color:#2e2a4a"><a href="#002724" label="[00:27:24]">&lt;stikonas&gt;</a></span><span class="message">at least it's written in Rust and not HVM :D</span></div><div class="line" id="002952"><span class="nick" style="color:#2e2a4a"><a href="#002952" label="[00:29:52]">&lt;stikonas&gt;</a></span><span class="message">rekado: any luck building nHandle.so?</span></div><div class="line" id="003007"><span class="nick" style="color:#2e2a4a"><a href="#003007" label="[00:30:07]">&lt;stikonas&gt;</a></span><span class="message">I've actually found a toolchain that can build it (with some patches) but that's outside Guix</span></div><div class="line" id="003021"><span class="nick" style="color:#2e2a4a"><a href="#003021" label="[00:30:21]">&lt;stikonas&gt;</a></span><span class="message">(patches are probably needed because I've used GCC4)</span></div><div class="line" id="003041"><span class="nick" style="color:#6b8072"><a href="#003041" label="[00:30:41]">&lt;rekado&gt;</a></span><span class="message">stikonas: I can build it just fine with different toolchains including the latest GCC (with a small change), but I can’t use it with the built hugs</span></div><div class="line" id="003116"><span class="nick" style="color:#6b8072"><a href="#003116" label="[00:31:16]">&lt;rekado&gt;</a></span><span class="message">when I just rebuild that file with a different GCC and start ./hugs from the ghc/interpreter directory I get this error:</span></div><div class="line" id="003117"><span class="nick" style="color:#6b8072"><a href="#003117" label="[00:31:17]">&lt;rekado&gt;</a></span><span class="message">gs: dynamic-link.h:62: elf_get_dynamic_info: Assertion `! &quot;bad dynamic tag&quot;' failed.</span></div><div class="line" id="003148"><span class="nick" style="color:#6b8072"><a href="#003148" label="[00:31:48]">&lt;rekado&gt;</a></span><span class="message">so I guess I probably shouldn’t build that one library with a different toolchain than the rest of the interpreter.</span></div><div class="line" id="003600"><span class="nick" style="color:#2e2a4a"><a href="#003600" label="[00:36:00]">&lt;stikonas&gt;</a></span><span class="message">yeah, probably need the same toolchain</span></div><div class="line" id="003614"><span class="nick" style="color:#2e2a4a"><a href="#003614" label="[00:36:14]">&lt;stikonas&gt;</a></span><span class="message">hmm, what if you try my GCC4 patches?</span></div><div class="line" id="003625"><span class="nick" style="color:#2e2a4a"><a href="#003625" label="[00:36:25]">&lt;stikonas&gt;</a></span><span class="message">maybe then you can use newer toolchain for the rest of the stuff</span></div><div class="line" id="003649"><span class="nick" style="color:#2e2a4a"><a href="#003649" label="[00:36:49]">&lt;stikonas&gt;</a></span><span class="message">(but I wasn't able to get hugs to link yet)</span></div><div class="line" id="003806"><span class="nick" style="color:#6b8072"><a href="#003806" label="[00:38:06]">&lt;rekado&gt;</a></span><span class="message">stikonas: could you point me to those patches?</span></div><div class="line" id="003832"><span class="nick" style="color:#6b8072"><a href="#003832" label="[00:38:32]">&lt;rekado&gt;</a></span><span class="message">I also have a few patches for building with GCC4, but I never got it all to work</span></div><div class="line" id="003900"><span class="nick" style="color:#2e2a4a"><a href="#003900" label="[00:39:00]">&lt;stikonas&gt;</a></span><span class="message">rekado: one moment need to get them out of chroot</span></div><div class="line" id="003908"><span class="nick" style="color:#2e2a4a"><a href="#003908" label="[00:39:08]">&lt;stikonas&gt;</a></span><span class="message">yeah, mine are not finished either</span></div><div class="line" id="003921"><span class="nick" style="color:#6b8072"><a href="#003921" label="[00:39:21]">&lt;rekado&gt;</a></span><span class="message">thanks, I’ll check them out tomorrow</span></div><div class="line" id="003936"><span class="nick" style="color:#2e2a4a"><a href="#003936" label="[00:39:36]">&lt;stikonas&gt;</a></span><span class="message">so maybe you already have somethign like that</span></div><div class="line" id="003936"><span class="nick" style="color:#80b1d3"><a href="#003936" label="[00:39:36]">*</a></span><span class="message">rekado —&gt; zzZ</span></div><div class="line" id="003938"><span class="nick" style="color:#2e2a4a"><a href="#003938" label="[00:39:38]">&lt;stikonas&gt;</a></span><span class="message"> <a rel="nofollow" href="https://stikonas.eu/files/ghc/">https://stikonas.eu/files/ghc/</a> </span></div><div class="line" id="004658"><span class="nick" style="color:#2e2a4a"><a href="#004658" label="[00:46:58]">&lt;stikonas&gt;</a></span><span class="message">ok, longlong.h patch needs fixing to get linking working, (that one was just big hack)</span></div><div class="line" id="005525"><span class="nick" style="color:#2e2a4a"><a href="#005525" label="[00:55:25]">&lt;stikonas&gt;</a></span><span class="message">ok, longlong patch fixed, fewer link errors but still quite a few</span></div><div class="line" id="010131"><span class="nick" style="color:#2e2a4a"><a href="#010131" label="[01:01:31]">&lt;stikonas&gt;</a></span><span class="message"> <a rel="nofollow" href="https://paste.debian.net/1229404/">https://paste.debian.net/1229404/</a> </span></div><div class="line" id="011716"><span class="nick" style="color:#2e2a4a"><a href="#011716" label="[01:17:16]">&lt;stikonas&gt;</a></span><span class="message">oh that's because .o files are empty...</span></div><div class="line" id="011742"><span class="nick" style="color:#2e2a4a"><a href="#011742" label="[01:17:42]">&lt;stikonas&gt;</a></span><span class="message">build system was running</span></div><div class="line" id="011821"><span class="nick" style="color:#2e2a4a"><a href="#011821" label="[01:18:21]">&lt;stikonas&gt;</a></span><span class="message">../../ghc/driver/ghc-inplace -I../includes -I. -Iparallel -optc-Wall  -optc-W -optc-Wstrict-prototypes  -optc-Wmissing-prototypes  -optc-Wmissing-declarations -optc-Winline -optc-Waggregate-return -optc-Wpointer-arith -optc-Wbad-function-cast -O2 -optc-DCOMPILING_RTS -static     -O2 -optc-fomit-frame-pointer   -I../interpreter -c Assembler.c -o Assembler.o</span></div><div class="line" id="011837"><span class="nick" style="color:#2e2a4a"><a href="#011837" label="[01:18:37]">&lt;stikonas&gt;</a></span><span class="message">and this ghc-inplace is broken</span></div><div class="line" id="011843"><span class="nick" style="color:#2e2a4a"><a href="#011843" label="[01:18:43]">&lt;stikonas&gt;</a></span><span class="message">rekado:  did you do something here?</span></div><div class="line" id="011852"><span class="nick" style="color:#2e2a4a"><a href="#011852" label="[01:18:52]">&lt;stikonas&gt;</a></span><span class="message">I'm probably missing some steps</span></div><div class="line" id="011952"><span class="nick" style="color:#2e2a4a"><a href="#011952" label="[01:19:52]">&lt;stikonas&gt;</a></span><span class="message">oh actually it's non-0 size, looked at the wrong field</span></div><div class="line" id="012032"><span class="nick" style="color:#2e2a4a"><a href="#012032" label="[01:20:32]">&lt;stikonas&gt;</a></span><span class="message">but still it's way too small 61 KB C file got translated into 625 bytes</span></div><div class="line" id="012514"><span class="nick" style="color:#2e2a4a"><a href="#012514" label="[01:25:14]">&lt;stikonas&gt;</a></span><span class="message">ok, I think workaround might be to use gcc -D INTERPRETER</span></div><div class="line" id="012524"><span class="nick" style="color:#2e2a4a"><a href="#012524" label="[01:25:24]">&lt;stikonas&gt;</a></span><span class="message">although that means I need to do more gcc4 fixes</span></div><div class="line" id="014518"><span class="nick" style="color:#2e2a4a"><a href="#014518" label="[01:45:18]">&lt;stikonas&gt;</a></span><span class="message">ok, with all those patches in <a rel="nofollow" href="https://stikonas.eu/files/ghc/">https://stikonas.eu/files/ghc/</a>  and &quot;./configure --host=i386-unknown-linux-gnu --enable-hc-boot  --with-gcc=&quot;gcc -DINTERPRETER&quot; &quot;make boot&quot; &quot;cd ghc/interpreter&quot; &quot;make&quot;</span></div><div class="line" id="014523"><span class="nick" style="color:#2e2a4a"><a href="#014523" label="[01:45:23]">&lt;stikonas&gt;</a></span><span class="message">I was able to build hugs</span></div><div class="line" id="014538"><span class="nick" style="color:#2e2a4a"><a href="#014538" label="[01:45:38]">&lt;stikonas&gt;</a></span><span class="message">but make does fail later</span></div><div class="line" id="014557"><span class="nick" style="color:#2e2a4a"><a href="#014557" label="[01:45:57]">&lt;stikonas&gt;</a></span><span class="message">and i can at least run &quot;./hugs --version&quot;</span></div><div class="line" id="014718"><span class="nick" style="color:#2e2a4a"><a href="#014718" label="[01:47:18]">&lt;stikonas&gt;</a></span><span class="message">oh actually make seems to complete if I first build utils/hscpp</span></div><div class="line" id="015709"><span class="nick" style="color:#2e2a4a"><a href="#015709" label="[01:57:09]">&lt;stikonas&gt;</a></span><span class="message">rekado_: so I got to here: <a rel="nofollow" href="https://paste.debian.net/1229406/">https://paste.debian.net/1229406/</a> </span></div><div class="line" id="015734"><span class="nick" style="color:#2e2a4a"><a href="#015734" label="[01:57:34]">&lt;stikonas&gt;</a></span><span class="message">there still seems to be some issue with hugs</span></div><div class="line" id="015734"><span class="nick" style="color:#2e2a4a"><a href="#015734" label="[01:57:34]">&lt;stikonas&gt;</a></span><span class="message">or maybe I don't know how to use it</span></div><div class="line" id="082758"><span class="nick">***</span><span class="message notice">iridium.libera.chat sets mode: +o oriansj</span></div><div class="line" id="093045"><span class="nick">***</span><span class="message notice">ChanServ sets mode: +o rekado_</span></div><div class="line" id="093047"><span class="nick" style="color:#6d2462"><a href="#093047" label="[09:30:47]">&lt;rekado_&gt;</a></span><span class="message"> <a rel="nofollow" href="https://elephly.net/paste/1643877019.html">https://elephly.net/paste/1643877019.html</a> </span></div><div class="line" id="093053"><span class="nick" style="color:#6d2462"><a href="#093053" label="[09:30:53]">&lt;rekado_&gt;</a></span><span class="message">I get to the output there</span></div><div class="line" id="093200"><span class="nick" style="color:#6d2462"><a href="#093200" label="[09:32:00]">&lt;rekado_&gt;</a></span><span class="message">my ghc-4 patch: <a rel="nofollow" href="https://elephly.net/paste/1643877096.patch.html">https://elephly.net/paste/1643877096.patch.html</a> </span></div><div class="line" id="093233"><span class="nick" style="color:#6d2462"><a href="#093233" label="[09:32:33]">&lt;rekado_&gt;</a></span><span class="message">but I also do additional ad-hoc patching in the Guix package definition</span></div><div class="line" id="093406"><span class="nick" style="color:#6d2462"><a href="#093406" label="[09:34:06]">&lt;rekado_&gt;</a></span><span class="message">for building with a more recent GCC I also needed at least this: <a rel="nofollow" href="https://elephly.net/paste/1643877229.scm.html">https://elephly.net/paste/1643877229.scm.html</a> </span></div><div class="line" id="093432"><span class="nick" style="color:#6d2462"><a href="#093432" label="[09:34:32]">&lt;rekado_&gt;</a></span><span class="message">and this too: <a rel="nofollow" href="https://elephly.net/paste/1643877264.scm.html">https://elephly.net/paste/1643877264.scm.html</a> </span></div><div class="line" id="120833"><span class="nick" style="color:#6d2462"><a href="#120833" label="[12:08:33]">&lt;rekado_&gt;</a></span><span class="message">haven’t been able to build the interpreter with GCC 5 (that’s the oldest toolchain I can easily use in Guix), because it fails to link hugs with the previously built RTS objects</span></div><div class="line" id="120856"><span class="nick" style="color:#6d2462"><a href="#120856" label="[12:08:56]">&lt;rekado_&gt;</a></span><span class="message">and building those with a recent GCC requires even more patches</span></div><div class="line" id="120950"><span class="nick" style="color:#234e69"><a href="#120950" label="[12:09:50]">&lt;muurkha&gt;</a></span><span class="message">it's great that you've gotten so far!</span></div><div class="line" id="121015"><span class="nick" style="color:#234e69"><a href="#121015" label="[12:10:15]">&lt;muurkha&gt;</a></span><span class="message">it'll be fantastic when we have GHC fully bootstrapped in Guix!</span></div><div class="line" id="121135"><span class="nick" style="color:#6d2462"><a href="#121135" label="[12:11:35]">&lt;rekado_&gt;</a></span><span class="message">it’s fun, but also really frustrating.  We *have* a hugs package, but we need this modified, older hugs that comes with GHC 4 to be able to interpret the GHC 4 libraries.</span></div><div class="line" id="121212"><span class="nick" style="color:#6d2462"><a href="#121212" label="[12:12:12]">&lt;rekado_&gt;</a></span><span class="message">my hope is that — if I can get the GHC 4 hugs to work — we can use that to interpret the compiler sources and compile them with itself.</span></div><div class="line" id="121242"><span class="nick" style="color:#234e69"><a href="#121242" label="[12:12:42]">&lt;muurkha&gt;</a></span><span class="message">right!</span></div><div class="line" id="121250"><span class="nick" style="color:#6d2462"><a href="#121250" label="[12:12:50]">&lt;rekado_&gt;</a></span><span class="message">I previously tried to use plain Hugs to do that, but didn’t get far because the GHC haskell sources refer to the GHC RTS.</span></div><div class="line" id="121313"><span class="nick" style="color:#234e69"><a href="#121313" label="[12:13:13]">&lt;muurkha&gt;</a></span><span class="message">does GHC 4 include a modified Hugs specifically to help with bootstrapping?</span></div><div class="line" id="121324"><span class="nick" style="color:#6d2462"><a href="#121324" label="[12:13:24]">&lt;rekado_&gt;</a></span><span class="message">no, not for bootstrapping purposes</span></div><div class="line" id="121336"><span class="nick" style="color:#6d2462"><a href="#121336" label="[12:13:36]">&lt;rekado_&gt;</a></span><span class="message">this is just so that one can have an interactive environment</span></div><div class="line" id="121339"><span class="nick" style="color:#6d2462"><a href="#121339" label="[12:13:39]">&lt;rekado_&gt;</a></span><span class="message">this predates ghci</span></div><div class="line" id="121345"><span class="nick" style="color:#234e69"><a href="#121345" label="[12:13:45]">&lt;muurkha&gt;</a></span><span class="message">oh, I see</span></div><div class="line" id="121406"><span class="nick" style="color:#234e69"><a href="#121406" label="[12:14:06]">&lt;muurkha&gt;</a></span><span class="message">so they had to work pretty hard to keep its capabilitie in sync with GHC's</span></div><div class="line" id="121430"><span class="nick" style="color:#234e69"><a href="#121430" label="[12:14:30]">&lt;muurkha&gt;</a></span><span class="message">exciting!</span></div><div class="line" id="121433"><span class="nick" style="color:#6d2462"><a href="#121433" label="[12:14:33]">&lt;rekado_&gt;</a></span><span class="message">that’s why they stopped :)</span></div><div class="line" id="121443"><span class="nick" style="color:#6d2462"><a href="#121443" label="[12:14:43]">&lt;rekado_&gt;</a></span><span class="message">when building the modified hugs the build system skips building of a few libraries.</span></div><div class="line" id="121455"><span class="nick" style="color:#6d2462"><a href="#121455" label="[12:14:55]">&lt;rekado_&gt;</a></span><span class="message">because hugs couldn’t be modified to support them.</span></div><div class="line" id="121516"><span class="nick" style="color:#6d2462"><a href="#121516" label="[12:15:16]">&lt;rekado_&gt;</a></span><span class="message">my hope is just that it supports *enough* to compile a few small things</span></div><div class="line" id="121536"><span class="nick" style="color:#6d2462"><a href="#121536" label="[12:15:36]">&lt;rekado_&gt;</a></span><span class="message">like those Haskell files that it currently skips because no Haskell compiler is available</span></div><div class="line" id="121601"><span class="nick" style="color:#6d2462"><a href="#121601" label="[12:16:01]">&lt;rekado_&gt;</a></span><span class="message">e.g. Array.o and utils/Argv.o</span></div><div class="line" id="121622"><span class="nick" style="color:#6d2462"><a href="#121622" label="[12:16:22]">&lt;rekado_&gt;</a></span><span class="message">the former is needed for libHSstd.a, the core part of the GHC standard library.</span></div><div class="line" id="121654"><span class="nick" style="color:#6d2462"><a href="#121654" label="[12:16:54]">&lt;rekado_&gt;</a></span><span class="message">we may need a couple of iterations to build more of GHC 4 in each round</span></div><div class="line" id="121753"><span class="nick" style="color:#6d2462"><a href="#121753" label="[12:17:53]">&lt;rekado_&gt;</a></span><span class="message">the first round is just enough to build the RTS and hugs, the second to build the core standard library, the third perhaps to build the whole thing again, but with the compiler sources, etc</span></div><div class="line" id="121824"><span class="nick" style="color:#6d2462"><a href="#121824" label="[12:18:24]">&lt;rekado_&gt;</a></span><span class="message">I don’t think it will be possible to build it all in one go (hence my disbelief when I first “finished” building my ghc-4 package).</span></div><div class="line" id="133145"><span class="nick" style="color:#6c3d55"><a href="#133145" label="[13:31:45]">&lt;oriansj&gt;</a></span><span class="message">rekado_: well I have faith that you'll sort it out with a good bit of work and I know that I look forward to all of the exciting possibilities this brings</span></div><div class="line" id="140548"><span class="nick" style="color:#6d2462"><a href="#140548" label="[14:05:48]">&lt;rekado_&gt;</a></span><span class="message">PSA: please consider subscribing to the mailing list if you want to post.  I keep having to manually approve on-topic emails to keep discussions going.</span></div><div class="line" id="140607"><span class="nick" style="color:#234e69"><a href="#140607" label="[14:06:07]">&lt;muurkha&gt;</a></span><span class="message">I didn't realize there was a list</span></div><div class="line" id="144710"><span class="nick" style="color:#6d2462"><a href="#144710" label="[14:47:10]">&lt;rekado_&gt;</a></span><span class="message">I feel like an idiot now: of course this shared library doesn’t work — because the glibc was built with --disable-shared.  It’s a bootstrap glibc, so what did I expect?</span></div><div class="line" id="144741"><span class="nick" style="color:#6d2462"><a href="#144741" label="[14:47:41]">&lt;rekado_&gt;</a></span><span class="message">I just built it again with --enable-shared, and now I just need to mess around with the linker wrapper</span></div><div class="line" id="145821"><span class="nick" style="color:#234e69"><a href="#145821" label="[14:58:21]">&lt;muurkha&gt;</a></span><span class="message">haha hooray!</span></div><div class="line" id="145843"><span class="nick" style="color:#234e69"><a href="#145843" label="[14:58:43]">&lt;muurkha&gt;</a></span><span class="message">the vast majority of bugs are simple things like that when you get down to it</span></div><div class="line" id="145937"><span class="nick" style="color:#234e69"><a href="#145937" label="[14:59:37]">&lt;muurkha&gt;</a></span><span class="message">it's just that the space of possible simple things that could cause a given bug is vast, so it takes a lot of work to figure out which one it is</span></div><div class="line" id="163954"><span class="nick" style="color:#6d2462"><a href="#163954" label="[16:39:54]">&lt;rekado_&gt;</a></span><span class="message">hugs works now</span></div><div class="line" id="164018"><span class="nick" style="color:#6d2462"><a href="#164018" label="[16:40:18]">&lt;rekado_&gt;</a></span><span class="message">whee!  So … now it won’t take long until we know if we can interpret the GHC compiler sources</span></div><div class="line" id="171143"><span class="nick" style="color:#d9d9d9"><a href="#171143" label="[17:11:43]">&lt;gbrlwck&gt;</a></span><span class="message">\o/</span></div><div class="line" id="174125"><span class="nick" style="color:#bc80bd"><a href="#174125" label="[17:41:25]">&lt;civodul&gt;</a></span><span class="message">rekado_: woohoo!</span></div><div class="line" id="202236"><span class="nick" style="color:#234e69"><a href="#202236" label="[20:22:36]">&lt;muurkha&gt;</a></span><span class="message">wonderful!</span></div><div class="line" id="202920"><span class="nick" style="color:#2e2a4a"><a href="#202920" label="[20:29:20]">&lt;stikonas&gt;</a></span><span class="message">rekado_: oh nice to hear that! I've got hugs to build but as you might have seen from the paste, I was getting some assertion failures</span></div><div class="line" id="203006"><span class="nick" style="color:#2e2a4a"><a href="#203006" label="[20:30:06]">&lt;stikonas&gt;</a></span><span class="message">you are not geting those with your build?</span></div><div class="line" id="214046"><span class="nick" style="color:#6d2462"><a href="#214046" label="[21:40:46]">&lt;rekado_&gt;</a></span><span class="message">stikonas: nope, no assertion failures</span></div><div class="line" id="214122"><span class="nick" style="color:#2e2a4a"><a href="#214122" label="[21:41:22]">&lt;stikonas&gt;</a></span><span class="message">it might be that your patches are better and I broke someting</span></div><div class="line" id="214140"><span class="nick" style="color:#6d2462"><a href="#214140" label="[21:41:40]">&lt;rekado_&gt;</a></span><span class="message">with my patches to the C sources I also got a broken hugs.  It would crash on putStrLn &quot;hello&quot;.</span></div><div class="line" id="214143"><span class="nick" style="color:#6d2462"><a href="#214143" label="[21:41:43]">&lt;rekado_&gt;</a></span><span class="message">but now it’s fine.</span></div><div class="line" id="214232"><span class="nick" style="color:#6d2462"><a href="#214232" label="[21:42:32]">&lt;rekado_&gt;</a></span><span class="message">I overrode the search path and preprocessor, so I can already load some of the GHC sources, but it seems that the biggest obstacle is that GHC and hugs use different parsers.</span></div><div class="line" id="214306"><span class="nick" style="color:#6d2462"><a href="#214306" label="[21:43:06]">&lt;rekado_&gt;</a></span><span class="message">so I can’t interpret all of the standard library, which the GHC sources depend on</span></div><div class="line" id="214328"><span class="nick" style="color:#6d2462"><a href="#214328" label="[21:43:28]">&lt;rekado_&gt;</a></span><span class="message">simple example: ERROR &quot;PrelAddr.lhs&quot; (line 37): Syntax error in input (unexpected symbol &quot;#&quot;)</span></div><div class="line" id="214342"><span class="nick" style="color:#6d2462"><a href="#214342" label="[21:43:42]">&lt;rekado_&gt;</a></span><span class="message">that’s: data Addr = A# Addr# 	deriving (Eq, Ord)</span></div><div class="line" id="214410"><span class="nick" style="color:#6d2462"><a href="#214410" label="[21:44:10]">&lt;rekado_&gt;</a></span><span class="message">IIRC in GHC that is for expressing boxed values(?)</span></div><div class="line" id="214413"><span class="nick" style="color:#2e2a4a"><a href="#214413" label="[21:44:13]">&lt;stikonas&gt;</a></span><span class="message">I see...</span></div><div class="line" id="214444"><span class="nick" style="color:#2e2a4a"><a href="#214444" label="[21:44:44]">&lt;stikonas&gt;</a></span><span class="message">yeah, it's not easy  for me to tell what's going on since I don't know any haskell...</span></div><div class="line" id="214542"><span class="nick" style="color:#2e2a4a"><a href="#214542" label="[21:45:42]">&lt;stikonas&gt;</a></span><span class="message">is it too much to patch out those # symbols?</span></div><div class="line" id="214543"><span class="nick" style="color:#234e69"><a href="#214543" label="[21:45:43]">&lt;muurkha&gt;</a></span><span class="message">rekado_: you haven't pushed the GHC bootstrapping stuff anywhere publicly yet, have you?</span></div><div class="line" id="214607"><span class="nick" style="color:#2e2a4a"><a href="#214607" label="[21:46:07]">&lt;stikonas&gt;</a></span><span class="message">into something that hugs can parse</span></div><div class="line" id="214852"><span class="nick" style="color:#6d2462"><a href="#214852" label="[21:48:52]">&lt;rekado_&gt;</a></span><span class="message">stikonas: in some cases it’s fine to just replace the # with '</span></div><div class="line" id="214859"><span class="nick" style="color:#6d2462"><a href="#214859" label="[21:48:59]">&lt;rekado_&gt;</a></span><span class="message">I’ve done this where I could</span></div><div class="line" id="214912"><span class="nick" style="color:#6d2462"><a href="#214912" label="[21:49:12]">&lt;rekado_&gt;</a></span><span class="message">but others are harder for me to understand</span></div><div class="line" id="214927"><span class="nick" style="color:#2e2a4a"><a href="#214927" label="[21:49:27]">&lt;stikonas&gt;</a></span><span class="message">maybe somebody with haskell experience can help</span></div><div class="line" id="214930"><span class="nick" style="color:#2e2a4a"><a href="#214930" label="[21:49:30]">&lt;stikonas&gt;</a></span><span class="message">siraben?</span></div><div class="line" id="215307"><span class="nick" style="color:#234e69"><a href="#215307" label="[21:53:07]">&lt;muurkha&gt;</a></span><span class="message">I think janus has haskell experience, maybe they can help</span></div><div class="line" id="215330"><span class="nick" style="color:#234e69"><a href="#215330" label="[21:53:30]">&lt;muurkha&gt;</a></span><span class="message">context:</span></div><div class="line" id="215345"><span class="nick" style="color:#234e69"><a href="#215345" label="[21:53:45]">&lt;muurkha&gt;</a></span><span class="message">20:42 &lt;@rekado_&gt; I overrode the search path and preprocessor, so I can already load some of the GHC sources, but it seems that the</span></div><div class="line" id="215348"><span class="nick" style="color:#234e69"><a href="#215348" label="[21:53:48]">&lt;muurkha&gt;</a></span><span class="message">                 biggest obstacle is that GHC and hugs use different parsers.</span></div><div class="line" id="215353"><span class="nick" style="color:#234e69"><a href="#215353" label="[21:53:53]">&lt;muurkha&gt;</a></span><span class="message">20:43 &lt;@rekado_&gt; so I can’t interpret all of the standard library, which the GHC sources depend on</span></div><div class="line" id="215354"><span class="nick" style="color:#234e69"><a href="#215354" label="[21:53:54]">&lt;muurkha&gt;</a></span><span class="message">20:43 &lt;@rekado_&gt; simple example: ERROR &quot;PrelAddr.lhs&quot; (line 37): Syntax error in input (unexpected symbol &quot;#&quot;)</span></div><div class="line" id="215357"><span class="nick" style="color:#234e69"><a href="#215357" label="[21:53:57]">&lt;muurkha&gt;</a></span><span class="message">20:43 &lt;@rekado_&gt; that’s: data Addr = A# Addr# Ideriving (Eq, Ord)</span></div><div class="line" id="215359"><span class="nick" style="color:#234e69"><a href="#215359" label="[21:53:59]">&lt;muurkha&gt;</a></span><span class="message">20:44 &lt;@rekado_&gt; IIRC in GHC that is for expressing boxed values(?)</span></div><div class="line" id="215427"><span class="nick" style="color:#234e69"><a href="#215427" label="[21:54:27]">&lt;muurkha&gt;</a></span><span class="message">20:48 &lt;@rekado_&gt; stikonas: in some cases it’s fine to just replace the # with '</span></div><div class="line" id="215427"><span class="nick" style="color:#234e69"><a href="#215427" label="[21:54:27]">&lt;muurkha&gt;</a></span><span class="message">20:48 &lt;@rekado_&gt; I’ve done this where I could</span></div><div class="line" id="215427"><span class="nick" style="color:#234e69"><a href="#215427" label="[21:54:27]">&lt;muurkha&gt;</a></span><span class="message">20:49 &lt;@rekado_&gt; but others are harder for me to understand</span></div><div class="line" id="215503"><span class="nick" style="color:#234e69"><a href="#215503" label="[21:55:03]">&lt;muurkha&gt;</a></span><span class="message">(hoping that flood isn't too annoying)</span></div><div class="line" id="215732"><span class="nick" style="color:#3c5b35"><a href="#215732" label="[21:57:32]">&lt;janus&gt;</a></span><span class="message">i am working right now but looks like this is the MagicHash extension <a rel="nofollow" href="https://ghc.gitlab.haskell.org/ghc/doc/users_guide/exts/magic_hash.html">https://ghc.gitlab.haskell.org/ghc/doc/users_guide/exts/magic_hash.html</a> </span></div><div class="line" id="215913"><span class="nick" style="color:#3c5b35"><a href="#215913" label="[21:59:13]">&lt;janus&gt;</a></span><span class="message">i don't know the details of GHC.Prim but i think it is important to note that the extension doesn't involve the runtime at all, it is just about parsing</span></div><div class="line" id="215955"><span class="nick" style="color:#3c5b35"><a href="#215955" label="[21:59:55]">&lt;janus&gt;</a></span><span class="message">if it never had any special meaning i suppose it would be sufficient to just replace it with a different character as you have done</span></div><div class="line" id="225350"><span class="nick" style="color:#3c5b35"><a href="#225350" label="[22:53:50]">&lt;janus&gt;</a></span><span class="message">i guess MagicHash was invented after the fact since those docs talk about 6.8 and you're working with version 5 or 6</span></div><br /></div></body></html>