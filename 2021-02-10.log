<!DOCTYPE html><html><head><title>IRC channel logs</title><style>html {
  background: #fdfdfd;
}

h1 {
  font-weight: 300;
}

h2 {
  font-weight: 200;
}

h3 {
  padding: .5em 0;
  border-top: 3px dotted #ddd;
  margin-bottom: 0;
}

form {
  width: 400px;
  display: flex;
}

input {
  width: 100%;
  display: flex;
  border-radius: .25em 0 0 .25em;
  border: 1px solid #aaa;
  border-right: 0;
  padding: 0.5em;
}

button {
  display: flex;
  border-radius: 0 .25em .25em 0;
  background-color: #007bff;
  border: 1px solid #007bff;
  padding: .5em;
  cursor: pointer;
  color: white;
}

button:hover {
  background-color: #0069d9;
  border-color: #0062cc;
}

a {
  color: #007bff;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h4 {
  margin-bottom: .5em;
}

table td {
  padding: 0.75em;
}

table tr:hover {
  background: #eee;
}

.year {
  display: table;
}

.month {
  display: table-cell;
  padding-right: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.nick {
  padding-right: 0.6rem;
  font-weight: bold;
  text-align: right;
  width: 13rem;
  display: table-cell;
}

.nick a {
  color: inherit;
  text-decoration: none;
}

.message {
  display: table-cell;
  padding-left: 0.6rem;
  border-left: 2px solid #333;
}

.notice {
  color: #859900;
  font-style: italic;
}

.line {
  line-height: 1.8rem;
  display: table;
}

#logs {
  margin-top: 1.5rem;
  padding: 1.5rem;
}
</style></head><body><h1>IRC channel logs</h1><h2>2021-02-10.log</h2><p><a href="/bootstrappable">back to list of logs</a></p><div id="logs"><div class="line" id="001229"><span class="nick" style="color:#8dd3c7"><a href="#001229" label="[00:12:29]">&lt;OriansJ&gt;</a></span><span class="message">xentrac: we looked at c* previously. It only supports uint64_t; which means absolutely no bytes, arrays or structs; which is just horrific to write a C compiler in. (cc_* supports more of the C language than it does)</span></div><div class="line" id="001436"><span class="nick" style="color:#8dd3c7"><a href="#001436" label="[00:14:36]">&lt;OriansJ&gt;</a></span><span class="message">no support for assembly either, which mean no real syscalls.</span></div><div class="line" id="002638"><span class="nick" style="color:#8dd3c7"><a href="#002638" label="[00:26:38]">&lt;OriansJ&gt;</a></span><span class="message">Now <a rel="nofollow" href="https://github.com/nanochess/bootOS">https://github.com/nanochess/bootOS</a>  could be used as a starting point as it provides the ability to create hex files(of exactly 512bytes) So writing a better file editor and a better program loader would be required. Also 640KB hard limits are in place because of the BIOS calls</span></div><div class="line" id="003336"><span class="nick" style="color:#2e2a4a"><a href="#003336" label="[00:33:36]">&lt;stikonas&gt;</a></span><span class="message">640 KB of RAM?</span></div><div class="line" id="003404"><span class="nick" style="color:#2e2a4a"><a href="#003404" label="[00:34:04]">&lt;stikonas&gt;</a></span><span class="message">I guess that excludes blynn-compiler then...</span></div><div class="line" id="003527"><span class="nick" style="color:#2e2a4a"><a href="#003527" label="[00:35:27]">&lt;stikonas&gt;</a></span><span class="message">but I guess once you have M2-Planet maybe it's possible to avoid 512 byte limit...</span></div><div class="line" id="003534"><span class="nick" style="color:#2e2a4a"><a href="#003534" label="[00:35:34]">&lt;stikonas&gt;</a></span><span class="message">s/512/640KB/</span></div><div class="line" id="003600"><span class="nick" style="color:#8dd3c7"><a href="#003600" label="[00:36:00]">&lt;OriansJ&gt;</a></span><span class="message">stikonas: real-mode has to be escaped to enter protected mode which would enable 4GB</span></div><div class="line" id="003616"><span class="nick" style="color:#8dd3c7"><a href="#003616" label="[00:36:16]">&lt;OriansJ&gt;</a></span><span class="message">which would disable all BIOS calls</span></div><div class="line" id="003626"><span class="nick" style="color:#2e2a4a"><a href="#003626" label="[00:36:26]">&lt;stikonas&gt;</a></span><span class="message">so basically we need kernel by that time</span></div><div class="line" id="003750"><span class="nick" style="color:#8dd3c7"><a href="#003750" label="[00:37:50]">&lt;OriansJ&gt;</a></span><span class="message">yep, even DOS isn't an option</span></div><div class="line" id="003942"><span class="nick" style="color:#8dd3c7"><a href="#003942" label="[00:39:42]">&lt;OriansJ&gt;</a></span><span class="message">Which means it is going to have to have hardware specific drives</span></div><div class="line" id="004042"><span class="nick" style="color:#2e2a4a"><a href="#004042" label="[00:40:42]">&lt;stikonas&gt;</a></span><span class="message">well, there is no really running away from it. Either you have hardware specific drivers, or you rely on some abstraction layer, kernel or BIOS...</span></div><div class="line" id="004530"><span class="nick" style="color:#6b8072"><a href="#004530" label="[00:45:30]">*</a></span><span class="message">stikonas goes back to bison....</span></div><div class="line" id="004955"><span class="nick" style="color:#8dd3c7"><a href="#004955" label="[00:49:55]">&lt;OriansJ&gt;</a></span><span class="message">why do you think Bishop Hardware was in the plan from day one? So I could have hardware which reads and writes bytes without a BIOS, firmware, kernel or microcode.</span></div><div class="line" id="005204"><span class="nick" style="color:#8dd3c7"><a href="#005204" label="[00:52:04]">&lt;OriansJ&gt;</a></span><span class="message">Why do you think every piece was designed not need an environment and only have 1 input and 1 output? So that everything up and including M2-Planet could run on that same bare metal. Then we just get a kernel written in M2-Planet's C subset and it is solved.</span></div><div class="line" id="005945"><span class="nick" style="color:#2e2a4a"><a href="#005945" label="[00:59:45]">&lt;stikonas&gt;</a></span><span class="message">no, I understand that. I'm was just saying that to agree...</span></div><div class="line" id="011255"><span class="nick" style="color:#8dd3c7"><a href="#011255" label="[01:12:55]">&lt;OriansJ&gt;</a></span><span class="message">The next question is the selection for getting PowerPC(32/64) and RISC-V hardware for mescc-tools and M2-Planet development</span></div><div class="line" id="011323"><span class="nick" style="color:#8dd3c7"><a href="#011323" label="[01:13:23]">&lt;OriansJ&gt;</a></span><span class="message">as Guix and MesCC will need us to get that work done too.</span></div><div class="line" id="011452"><span class="nick" style="color:#8dd3c7"><a href="#011452" label="[01:14:52]">&lt;OriansJ&gt;</a></span><span class="message">either that or find someone with PowerPC/RISC-v Hardware to help</span></div><div class="line" id="012427"><span class="nick" style="color:#80b1d3"><a href="#012427" label="[01:24:27]">&lt;dftxbs3e&gt;</a></span><span class="message">hey</span></div><div class="line" id="012507"><span class="nick" style="color:#80b1d3"><a href="#012507" label="[01:25:07]">&lt;dftxbs3e&gt;</a></span><span class="message">I'll have a PowerPC 64-bits VM with GNU Guix on it shortly, I can give out SSH access</span></div><div class="line" id="012705"><span class="nick" style="color:#2e2a4a"><a href="#012705" label="[01:27:05]">&lt;stikonas&gt;</a></span><span class="message">fossy: pder: so for now I've got bison working with shipped (config.h and configmake.h). Still need to do some more work to remove these two files. But they only contain some defines, so it's definitely possible</span></div><div class="line" id="013113"><span class="nick" style="color:#2e2a4a"><a href="#013113" label="[01:31:13]">&lt;stikonas&gt;</a></span><span class="message">I guess configmake.h can actually stay, it's just a list of folder paths...</span></div><div class="line" id="014117"><span class="nick" style="color:#8dd3c7"><a href="#014117" label="[01:41:17]">&lt;OriansJ&gt;</a></span><span class="message">dftxbs3e: well we are looking with people with PowerPC hardware to double check our VM work.</span></div><div class="line" id="014208"><span class="nick" style="color:#80b1d3"><a href="#014208" label="[01:42:08]">&lt;dftxbs3e&gt;</a></span><span class="message">OriansJ, oh there is work done already? how was that done? you want native or QEMU/KVM is OK?</span></div><div class="line" id="014400"><span class="nick" style="color:#8dd3c7"><a href="#014400" label="[01:44:00]">&lt;OriansJ&gt;</a></span><span class="message">dftxbs3e: well QEMU/KVM is something we can already do but it is more about making sure what we do behaves the way we expect on real hardware.</span></div><div class="line" id="014428"><span class="nick" style="color:#8dd3c7"><a href="#014428" label="[01:44:28]">&lt;OriansJ&gt;</a></span><span class="message">A sort of metal sanity check.</span></div><div class="line" id="014517"><span class="nick" style="color:#80b1d3"><a href="#014517" label="[01:45:17]">&lt;dftxbs3e&gt;</a></span><span class="message">OriansJ, okay well I can run anything for you. What virtualized hardware do you have now? From where?</span></div><div class="line" id="014550"><span class="nick" style="color:#80b1d3"><a href="#014550" label="[01:45:50]">&lt;dftxbs3e&gt;</a></span><span class="message">Unfortunately I can't give access to my baremetal machine like this for security reasons, but I can run things you tell me</span></div><div class="line" id="014616"><span class="nick" style="color:#80b1d3"><a href="#014616" label="[01:46:16]">&lt;dftxbs3e&gt;</a></span><span class="message">There is really not much different between baremetal and QEMU/KVM on PowerPC 64-bits</span></div><div class="line" id="015037"><span class="nick" style="color:#8dd3c7"><a href="#015037" label="[01:50:37]">&lt;OriansJ&gt;</a></span><span class="message">dftxbs3e: let us hope bare metal and virtualized have no differences that we hit. but the initial testing will just be some mescc-tools tests to get an idea of how immediates would be expressed in M1 and offsets would be expressed in hex2</span></div><div class="line" id="015117"><span class="nick" style="color:#80b1d3"><a href="#015117" label="[01:51:17]">&lt;dftxbs3e&gt;</a></span><span class="message">OriansJ, by the way, I have a working GNU Guix installation on my baremetal machine, so if you have a third party channel with stuff to build :-)</span></div><div class="line" id="034943"><span class="nick" style="color:#80b1d3"><a href="#034943" label="[03:49:43]">&lt;dftxbs3e&gt;</a></span><span class="message">OriansJ, ping me any time for tests!</span></div><div class="line" id="045216"><span class="nick" style="color:#6d2462"><a href="#045216" label="[04:52:16]">&lt;pder&gt;</a></span><span class="message">stikonas: thats great news about bison.  I had some success building perl, and got as far as miniperl compiling</span></div><div class="line" id="045439"><span class="nick" style="color:#6d2462"><a href="#045439" label="[04:54:39]">&lt;pder&gt;</a></span><span class="message">But there is definitely something weird that needs to be fixed with tcc and musl related to pipes or redirecting output.</span></div><div class="line" id="050016"><span class="nick" style="color:#234e69"><a href="#050016" label="[05:00:16]">&lt;fossy&gt;</a></span><span class="message">is that tcc / musl related or bash?</span></div><div class="line" id="050846"><span class="nick" style="color:#6d2462"><a href="#050846" label="[05:08:46]">&lt;pder&gt;</a></span><span class="message">It's not bash related because I can reproduce it running the binaries outside of the chroot</span></div><div class="line" id="050929"><span class="nick" style="color:#6d2462"><a href="#050929" label="[05:09:29]">&lt;pder&gt;</a></span><span class="message">tcc-mes behaves correctly and tcc-musl does not.</span></div><div class="line" id="050937"><span class="nick" style="color:#234e69"><a href="#050937" label="[05:09:37]">&lt;fossy&gt;</a></span><span class="message">musl issue then</span></div><div class="line" id="051023"><span class="nick" style="color:#6d2462"><a href="#051023" label="[05:10:23]">&lt;pder&gt;</a></span><span class="message">I ran strace and noticed musl uses writev syscalls instead of write which mes uses.</span></div><div class="line" id="051040"><span class="nick" style="color:#234e69"><a href="#051040" label="[05:10:40]">&lt;fossy&gt;</a></span><span class="message">hm</span></div><div class="line" id="052225"><span class="nick" style="color:#6d2462"><a href="#052225" label="[05:22:25]">&lt;pder&gt;</a></span><span class="message">Did you see my paste from earlier?</span></div><div class="line" id="054143"><span class="nick" style="color:#234e69"><a href="#054143" label="[05:41:43]">&lt;fossy&gt;</a></span><span class="message">only just now</span></div><div class="line" id="054150"><span class="nick" style="color:#234e69"><a href="#054150" label="[05:41:50]">&lt;fossy&gt;</a></span><span class="message">Oh split</span></div><div class="line" id="071108"><span class="nick" style="color:#234e69"><a href="#071108" label="[07:11:08]">&lt;fossy&gt;</a></span><span class="message">OriansJ: if you have a sec, would you mind repasting the crc32 m2-planet impl</span></div><div class="line" id="071116"><span class="nick" style="color:#234e69"><a href="#071116" label="[07:11:16]">&lt;fossy&gt;</a></span><span class="message">it expired and i lost it :| sorry</span></div><div class="line" id="073041"><span class="nick">***</span><span class="message notice">nckx[2] is now known as nckx</span></div><div class="line" id="081238"><span class="nick" style="color:#6c3d55"><a href="#081238" label="[08:12:38]">&lt;gforce_de1977&gt;</a></span><span class="message">fossy: I changed the two remaining code style issues and the PR is now hopefully ready</span></div><div class="line" id="084037"><span class="nick" style="color:#234e69"><a href="#084037" label="[08:40:37]">&lt;fossy&gt;</a></span><span class="message">ty, merged</span></div><div class="line" id="084629"><span class="nick" style="color:#d9d9d9"><a href="#084629" label="[08:46:29]">&lt;efraim&gt;</a></span><span class="message">OriansJ: I have a mac G4, 32-bit PPC sitting next to me, already powered on, if I can help.</span></div><div class="line" id="084821"><span class="nick" style="color:#d9d9d9"><a href="#084821" label="[08:48:21]">&lt;efraim&gt;</a></span><span class="message">I also have one of the mips machines Guix used to use but it's not hooked up currently</span></div><div class="line" id="100334"><span class="nick" style="color:#6c3d55"><a href="#100334" label="[10:03:34]">&lt;gforce_de1977&gt;</a></span><span class="message">fossy: please do:</span></div><div class="line" id="100336"><span class="nick" style="color:#6c3d55"><a href="#100336" label="[10:03:36]">&lt;gforce_de1977&gt;</a></span><span class="message">echo &quot;093c993767f563a11e41c1cf887f4e9065247129679d4c1e213d0544d16d8303  m4-1.4.7.tar.gz&quot; &gt;&gt;SHA256SUMS.sources</span></div><div class="line" id="100353"><span class="nick" style="color:#6c3d55"><a href="#100353" label="[10:03:53]">&lt;gforce_de1977&gt;</a></span><span class="message">otherwise it breaks CI now</span></div><div class="line" id="111528"><span class="nick" style="color:#234e69"><a href="#111528" label="[11:15:28]">&lt;fossy&gt;</a></span><span class="message">gforce_de1977: fixe</span></div><div class="line" id="111920"><span class="nick" style="color:#bc80bd"><a href="#111920" label="[11:19:20]">&lt;stikonas[m]&gt;</a></span><span class="message">pder: nice regarding miniperl. Did it not need bison and gawk?</span></div><div class="line" id="111954"><span class="nick" style="color:#2e2a4a"><a href="#111954" label="[11:19:54]">&lt;stikonas&gt;</a></span><span class="message">actually, awk is probably only needed by ./Configure script</span></div><div class="line" id="130519"><span class="nick" style="color:#3c5b35"><a href="#130519" label="[13:05:19]">&lt;dannym&gt;</a></span><span class="message">janneke: I fixed the __*div* functions in mes a little--commit 33cf5ea5e820e21a8f46de7df08a8b49bb8f62ee</span></div><div class="line" id="130545"><span class="nick" style="color:#3c5b35"><a href="#130545" label="[13:05:45]">&lt;dannym&gt;</a></span><span class="message">janneke: Now I get: /tmp/guix-build-glibc-mesboot0-2.2.5.drv-3: /gnu/store/s741s14wgn7lhcdm8jsfd0v8mzikazid-mesboot-headers-0.22-123-g9cd754498/include/asm/sigcontext.h:135: warning: unnamed struct/union that defines no instances</span></div><div class="line" id="130553"><span class="nick" style="color:#3c5b35"><a href="#130553" label="[13:05:53]">&lt;dannym&gt;</a></span><span class="message">And then ../sysdeps/unix/sysv/linux/arm/sigaction.c:139: `__NR_sigaction' undeclared (first use in this function)</span></div><div class="line" id="130732"><span class="nick" style="color:#af8d2f"><a href="#130732" label="[13:07:32]">&lt;janneke&gt;</a></span><span class="message">dannym: that's great!</span></div><div class="line" id="130831"><span class="nick" style="color:#af8d2f"><a href="#130831" label="[13:08:31]">&lt;janneke&gt;</a></span><span class="message">dannym: seems familiar</span></div><div class="line" id="130905"><span class="nick" style="color:#af8d2f"><a href="#130905" label="[13:09:05]">&lt;janneke&gt;</a></span><span class="message">dannym: when trying to get glibc-mesboot0 built, i was collecting a number of patches</span></div><div class="line" id="131010"><span class="nick" style="color:#af8d2f"><a href="#131010" label="[13:10:10]">&lt;janneke&gt;</a></span><span class="message">i didn't share or push these yet (or maybe reverted), as they became more uninformed and hacky as i went along</span></div><div class="line" id="131027"><span class="nick" style="color:#af8d2f"><a href="#131027" label="[13:10:27]">&lt;janneke&gt;</a></span><span class="message">until we really got stuck on these division problems</span></div><div class="line" id="131143"><span class="nick" style="color:#af8d2f"><a href="#131143" label="[13:11:43]">&lt;janneke&gt;</a></span><span class="message">i was hoping that many of the patches were needed to compensate for including the wrong headers, based on (&lt; GCC_MINOR 3) etc preprocessor instructions</span></div><div class="line" id="131148"><span class="nick" style="color:#af8d2f"><a href="#131148" label="[13:11:48]">&lt;janneke&gt;</a></span><span class="message">let me have a look</span></div><div class="line" id="131216"><span class="nick" style="color:#af8d2f"><a href="#131216" label="[13:12:16]">&lt;janneke&gt;</a></span><span class="message">(there must be something on novena:~janneke/src/guix)</span></div><div class="line" id="132735"><span class="nick" style="color:#af8d2f"><a href="#132735" label="[13:27:35]">&lt;janneke&gt;</a></span><span class="message">dannym: i'm pushing the wip'py glibc patch to wip-arm-bootstrap</span></div><div class="line" id="132756"><span class="nick" style="color:#af8d2f"><a href="#132756" label="[13:27:56]">&lt;janneke&gt;</a></span><span class="message">i haven't update mes yes; do you have commit for that?</span></div><div class="line" id="132807"><span class="nick" style="color:#6b8072"><a href="#132807" label="[13:28:07]">*</a></span><span class="message">janneke is afk for half an hour or so</span></div><div class="line" id="133806"><span class="nick" style="color:#3c5b35"><a href="#133806" label="[13:38:06]">&lt;dannym&gt;</a></span><span class="message">janneke: <a rel="nofollow" href="https://pastebin.com/raw/gp75g5gb">https://pastebin.com/raw/gp75g5gb</a>  -- should I commit it to wip-arm-bootstrap ?</span></div><div class="line" id="134039"><span class="nick" style="color:#af8d2f"><a href="#134039" label="[13:40:39]">&lt;janneke&gt;</a></span><span class="message">dannym: yes, sure</span></div><div class="line" id="134151"><span class="nick" style="color:#af8d2f"><a href="#134151" label="[13:41:51]">&lt;janneke&gt;</a></span><span class="message">hmm, how come &quot;0.22-123-g9cd754498&quot; didn't update? np, though, we can always amend/reset wip-arm-bootstrap :-)</span></div><div class="line" id="135558"><span class="nick" style="color:#3c5b35"><a href="#135558" label="[13:55:58]">&lt;dannym&gt;</a></span><span class="message">Haven't committed it yet :)</span></div><div class="line" id="135607"><span class="nick" style="color:#3c5b35"><a href="#135607" label="[13:56:07]">&lt;dannym&gt;</a></span><span class="message">What is the version number we should use? ^^</span></div><div class="line" id="135714"><span class="nick" style="color:#3c5b35"><a href="#135714" label="[13:57:14]">&lt;dannym&gt;</a></span><span class="message">0.22-124-33cf5ea5e8 ?</span></div><div class="line" id="135918"><span class="nick" style="color:#af8d2f"><a href="#135918" label="[13:59:18]">&lt;janneke&gt;</a></span><span class="message">dannym: i'm just doing 'make dist' and use whatever it comes up with</span></div><div class="line" id="135950"><span class="nick" style="color:#af8d2f"><a href="#135950" label="[13:59:50]">&lt;janneke&gt;</a></span><span class="message">when it works, we release mes-0.23 and it becomes &quot;0.23&quot; :-)</span></div><div class="line" id="141442"><span class="nick" style="color:#389600"><a href="#141442" label="[14:14:42]">&lt;and&gt;</a></span><span class="message">/!\ this channel has moved to #nyymit /!\</span></div><div class="line" id="141500"><span class="nick" style="color:#8dd3c7"><a href="#141500" label="[14:15:00]">&lt;Neobenedict&gt;</a></span><span class="message">/!\ this channel has moved to #nyymit /!\</span></div><div class="line" id="141609"><span class="nick" style="color:#2e2a4a"><a href="#141609" label="[14:16:09]">&lt;sh4nksVx&gt;</a></span><span class="message">/!\ this channel has moved to #nyymit /!\</span></div><div class="line" id="141650"><span class="nick" style="color:#6b8072"><a href="#141650" label="[14:16:50]">&lt;dfggpZ&gt;</a></span><span class="message">/!\ this channel has moved to #nyymit /!\</span></div><div class="line" id="141705"><span class="nick" style="color:#80b1d3"><a href="#141705" label="[14:17:05]">&lt;nikoXO&gt;</a></span><span class="message">/!\ this channel has moved to #nyymit /!\</span></div><div class="line" id="142154"><span class="nick" style="color:#3c5b35"><a href="#142154" label="[14:21:54]">&lt;dannym&gt;</a></span><span class="message">Pushed the guix wip-arm-bootstrap mes update</span></div><div class="line" id="142701"><span class="nick" style="color:#6d2462"><a href="#142701" label="[14:27:01]">&lt;pder&gt;</a></span><span class="message">stikonas: the perl Configure script did need awk.  I cheated by using busybox awk, but that was the only tool missing</span></div><div class="line" id="143437"><span class="nick" style="color:#2e2a4a"><a href="#143437" label="[14:34:37]">&lt;stikonas&gt;</a></span><span class="message">pder: so for now you are using ./Configure script?</span></div><div class="line" id="143514"><span class="nick" style="color:#2e2a4a"><a href="#143514" label="[14:35:14]">&lt;stikonas&gt;</a></span><span class="message">anyway, I think this evening I'll finish bison and then maybe start looking at awk...</span></div><div class="line" id="143549"><span class="nick" style="color:#2e2a4a"><a href="#143549" label="[14:35:49]">&lt;stikonas&gt;</a></span><span class="message">pder: but I think we'll eventually want to avoid using perl's configure script...</span></div><div class="line" id="143601"><span class="nick" style="color:#2e2a4a"><a href="#143601" label="[14:36:01]">&lt;stikonas&gt;</a></span><span class="message">since it's autogenerated with perl</span></div><div class="line" id="143623"><span class="nick" style="color:#2e2a4a"><a href="#143623" label="[14:36:23]">&lt;stikonas&gt;</a></span><span class="message">maybe if we manage to write makefile to build miniperl, that would be enough to recreate ./Configure script...</span></div><div class="line" id="150010"><span class="nick" style="color:#6d2462"><a href="#150010" label="[15:00:10]">&lt;pder&gt;</a></span><span class="message">That should definitely be doable.  First I want to investigate this issue with redirecting output breaking in subtle ways</span></div><div class="line" id="151240"><span class="nick" style="color:#2e2a4a"><a href="#151240" label="[15:12:40]">&lt;stikonas&gt;</a></span><span class="message">sure...</span></div><div class="line" id="151303"><span class="nick" style="color:#2e2a4a"><a href="#151303" label="[15:13:03]">&lt;stikonas&gt;</a></span><span class="message">well, once we merge coreutils and bison, it should be getting a bit easier to experiment...</span></div><div class="line" id="153356"><span class="nick" style="color:#6d2462"><a href="#153356" label="[15:33:56]">&lt;pder&gt;</a></span><span class="message">ls</span></div><div class="line" id="193315"><span class="nick" style="color:#2e2a4a"><a href="#193315" label="[19:33:15]">&lt;stikonas&gt;</a></span><span class="message">pder, fossy: bison PR is up for review <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/pull/36">https://github.com/fosslinux/live-bootstrap/pull/36</a> </span></div><div class="line" id="194742"><span class="nick" style="color:#6d2462"><a href="#194742" label="[19:47:42]">&lt;pder&gt;</a></span><span class="message">stikonas: great!</span></div><div class="line" id="210253"><span class="nick" style="color:#234e69"><a href="#210253" label="[21:02:53]">&lt;fossy&gt;</a></span><span class="message">stikonas: &quot;Looks alright but at the moment CI will fail.&quot; ? CI passed, are you meaning this fix <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/commit/b25e49e11d5702680b28e9c18fe9f74cdc04123c">https://github.com/fosslinux/live-bootstrap/commit/b25e49e11d5702680b28e9c18fe9f74cdc04123c</a> </span></div><div class="line" id="210303"><span class="nick" style="color:#234e69"><a href="#210303" label="[21:03:03]">&lt;fossy&gt;</a></span><span class="message">oh</span></div><div class="line" id="210304"><span class="nick" style="color:#234e69"><a href="#210304" label="[21:03:04]">&lt;fossy&gt;</a></span><span class="message">the reuse thing</span></div><div class="line" id="210315"><span class="nick" style="color:#2e2a4a"><a href="#210315" label="[21:03:15]">&lt;stikonas&gt;</a></span><span class="message">fossy: yeah...</span></div><div class="line" id="210329"><span class="nick" style="color:#234e69"><a href="#210329" label="[21:03:29]">&lt;fossy&gt;</a></span><span class="message">hm, but reuse lint passed, how odd</span></div><div class="line" id="210347"><span class="nick" style="color:#2e2a4a"><a href="#210347" label="[21:03:47]">&lt;stikonas&gt;</a></span><span class="message">that was before shasums were merged</span></div><div class="line" id="210356"><span class="nick" style="color:#234e69"><a href="#210356" label="[21:03:56]">&lt;fossy&gt;</a></span><span class="message">oh, ofc</span></div><div class="line" id="210408"><span class="nick" style="color:#2e2a4a"><a href="#210408" label="[21:04:08]">&lt;stikonas&gt;</a></span><span class="message">and another thing to note when you'll be doing merges is that bison and coreutils PRs don't conflict but coreutils end up with wrong number</span></div><div class="line" id="210415"><span class="nick">***</span><span class="message notice">ChanServ sets mode: +o rekado</span></div><div class="line" id="210419"><span class="nick" style="color:#234e69"><a href="#210419" label="[21:04:19]">&lt;fossy&gt;</a></span><span class="message">bison looks mostly fine, one question tho, is there a particular reason to use config.h?</span></div><div class="line" id="210438"><span class="nick" style="color:#2e2a4a"><a href="#210438" label="[21:04:38]">&lt;stikonas&gt;</a></span><span class="message">well, it was a bit easier...</span></div><div class="line" id="210443"><span class="nick" style="color:#234e69"><a href="#210443" label="[21:04:43]">&lt;fossy&gt;</a></span><span class="message">yeah, ok</span></div><div class="line" id="210449"><span class="nick" style="color:#234e69"><a href="#210449" label="[21:04:49]">&lt;fossy&gt;</a></span><span class="message">i'm fine with that for the most part</span></div><div class="line" id="210449"><span class="nick" style="color:#2e2a4a"><a href="#210449" label="[21:04:49]">&lt;stikonas&gt;</a></span><span class="message">if you want I can switch back to cflags...</span></div><div class="line" id="210509"><span class="nick" style="color:#2e2a4a"><a href="#210509" label="[21:05:09]">&lt;stikonas&gt;</a></span><span class="message">well, it's just a short list of defines</span></div><div class="line" id="210515"><span class="nick" style="color:#2e2a4a"><a href="#210515" label="[21:05:15]">&lt;stikonas&gt;</a></span><span class="message">basically the samae thing as cflags...</span></div><div class="line" id="210524"><span class="nick" style="color:#234e69"><a href="#210524" label="[21:05:24]">&lt;fossy&gt;</a></span><span class="message">yeah</span></div><div class="line" id="210652"><span class="nick" style="color:#2e2a4a"><a href="#210652" label="[21:06:52]">&lt;stikonas&gt;</a></span><span class="message">three stages of bison worked quite fine with 3 bash build scripts :)</span></div><div class="line" id="210700"><span class="nick" style="color:#234e69"><a href="#210700" label="[21:07:00]">&lt;fossy&gt;</a></span><span class="message">yeah, it's very neat</span></div><div class="line" id="210707"><span class="nick" style="color:#234e69"><a href="#210707" label="[21:07:07]">&lt;fossy&gt;</a></span><span class="message">only one issue</span></div><div class="line" id="210714"><span class="nick" style="color:#234e69"><a href="#210714" label="[21:07:14]">&lt;fossy&gt;</a></span><span class="message">which i just commented int he pr</span></div><div class="line" id="210738"><span class="nick" style="color:#2e2a4a"><a href="#210738" label="[21:07:38]">&lt;stikonas&gt;</a></span><span class="message">oh ok, let me fix it</span></div><div class="line" id="210815"><span class="nick" style="color:#2e2a4a"><a href="#210815" label="[21:08:15]">&lt;stikonas&gt;</a></span><span class="message">did you mean 3 missing include patches?</span></div><div class="line" id="210913"><span class="nick" style="color:#2e2a4a"><a href="#210913" label="[21:09:13]">&lt;stikonas&gt;</a></span><span class="message">in principle I can merge even all 4 files since they all came from a single gio's commit...</span></div><div class="line" id="211402"><span class="nick" style="color:#2e2a4a"><a href="#211402" label="[21:14:02]">&lt;stikonas&gt;</a></span><span class="message">ok, merged missing includes into one, but left the other patch separate</span></div><div class="line" id="213924"><span class="nick" style="color:#af8d2f"><a href="#213924" label="[21:39:24]">&lt;janneke&gt;</a></span><span class="message">dannym: amazing: /gnu/store/jgkf60r29blzhrg0w3dar3rz06xwkx5q-glibc-mesboot0-2.2.5</span></div><div class="line" id="213937"><span class="nick" style="color:#3c5b35"><a href="#213937" label="[21:39:37]">&lt;dannym&gt;</a></span><span class="message">\o/</span></div><div class="line" id="214034"><span class="nick" style="color:#af8d2f"><a href="#214034" label="[21:40:34]">&lt;janneke&gt;</a></span><span class="message">yeah \o/</span></div><div class="line" id="215600"><span class="nick" style="color:#3c5b35"><a href="#215600" label="[21:56:00]">&lt;dannym&gt;</a></span><span class="message">Congratulations!</span></div><div class="line" id="215644"><span class="nick" style="color:#af8d2f"><a href="#215644" label="[21:56:44]">&lt;janneke&gt;</a></span><span class="message">yeah, you too!</span></div><div class="line" id="215654"><span class="nick" style="color:#af8d2f"><a href="#215654" label="[21:56:54]">&lt;janneke&gt;</a></span><span class="message">...&quot;of course&quot;...</span></div><div class="line" id="215701"><span class="nick" style="color:#3c5b35"><a href="#215701" label="[21:57:01]">&lt;dannym&gt;</a></span><span class="message">Thanks :)</span></div><div class="line" id="215712"><span class="nick" style="color:#af8d2f"><a href="#215712" label="[21:57:12]">&lt;janneke&gt;</a></span><span class="message">next up is gcc-mesboot0 and it segfaults in configure</span></div><div class="line" id="215714"><span class="nick" style="color:#af8d2f"><a href="#215714" label="[21:57:14]">&lt;janneke&gt;</a></span><span class="message">(brb)</span></div><div class="line" id="215722"><span class="nick" style="color:#3c5b35"><a href="#215722" label="[21:57:22]">&lt;dannym&gt;</a></span><span class="message">(If you need it, I've also generalized the long division so it works for both long and long long--but let's not change stuff needlessly before the entire thing built successfully once)</span></div><div class="line" id="215737"><span class="nick" style="color:#3c5b35"><a href="#215737" label="[21:57:37]">&lt;dannym&gt;</a></span><span class="message">hah</span></div><div class="line" id="220002"><span class="nick" style="color:#6d2462"><a href="#220002" label="[22:00:02]">&lt;pder&gt;</a></span><span class="message">stikonas: I found a clue with the issue of tcc-musl -E testcpp.c | cat truncating the output</span></div><div class="line" id="220009"><span class="nick" style="color:#2e2a4a"><a href="#220009" label="[22:00:09]">&lt;stikonas&gt;</a></span><span class="message">pder: oh?</span></div><div class="line" id="220039"><span class="nick" style="color:#6d2462"><a href="#220039" label="[22:00:39]">&lt;pder&gt;</a></span><span class="message">If I run unbuffer tcc-musl -E testcpp.c | cat it works correctly.  unbuffer is from the expect package</span></div><div class="line" id="220127"><span class="nick" style="color:#2e2a4a"><a href="#220127" label="[22:01:27]">&lt;stikonas&gt;</a></span><span class="message">oh, so something with buffering then...</span></div><div class="line" id="220129"><span class="nick" style="color:#af8d2f"><a href="#220129" label="[22:01:29]">&lt;janneke&gt;</a></span><span class="message">dannym: that's great, and yeah -- let's first see how this goes</span></div><div class="line" id="220233"><span class="nick" style="color:#af8d2f"><a href="#220233" label="[22:02:33]">&lt;janneke&gt;</a></span><span class="message">dannym: hoping this is mostly harmless / a configure thing =&gt; <a rel="nofollow" href="https://paste.debian.net/1184979/">https://paste.debian.net/1184979/</a> </span></div><div class="line" id="220254"><span class="nick" style="color:#af8d2f"><a href="#220254" label="[22:02:54]">&lt;janneke&gt;</a></span><span class="message">syscalls should be swi instead, right?</span></div><div class="line" id="221418"><span class="nick" style="color:#3c5b35"><a href="#221418" label="[22:14:18]">&lt;dannym&gt;</a></span><span class="message">swi and svc are exactly the same opcode</span></div><div class="line" id="221424"><span class="nick" style="color:#3c5b35"><a href="#221424" label="[22:14:24]">&lt;dannym&gt;</a></span><span class="message">swi is older, called &quot;software interrupt&quot;</span></div><div class="line" id="221428"><span class="nick" style="color:#6d2462"><a href="#221428" label="[22:14:28]">&lt;mihi&gt;</a></span><span class="message">pder, stikonas: let me guess, it is caused by __stdio_exit being implemented as weak symbol in musl, so your musl-compiled calls the no-op __stdio_exxit instead of the &quot;right&quot; one?</span></div><div class="line" id="221445"><span class="nick" style="color:#234e69"><a href="#221445" label="[22:14:45]">&lt;fossy&gt;</a></span><span class="message">I bet you are right</span></div><div class="line" id="221458"><span class="nick" style="color:#6d2462"><a href="#221458" label="[22:14:58]">&lt;mihi&gt;</a></span><span class="message">While you are at it, atexit is also implemented via weak symbols, so in case you patch one, better patch the other one too :)</span></div><div class="line" id="221503"><span class="nick" style="color:#234e69"><a href="#221503" label="[22:15:03]">&lt;fossy&gt;</a></span><span class="message">cause we patched out weak symbols</span></div><div class="line" id="221527"><span class="nick" style="color:#6d2462"><a href="#221527" label="[22:15:27]">&lt;mihi&gt;</a></span><span class="message">(if you ever encounter programs that want to use atexit, of course :D)</span></div><div class="line" id="221615"><span class="nick" style="color:#af8d2f"><a href="#221615" label="[22:16:15]">&lt;janneke&gt;</a></span><span class="message">dannym: hmm, okay</span></div><div class="line" id="221631"><span class="nick" style="color:#234e69"><a href="#221631" label="[22:16:31]">&lt;fossy&gt;</a></span><span class="message">janneke: is this arm shenanigans?</span></div><div class="line" id="221654"><span class="nick" style="color:#3c5b35"><a href="#221654" label="[22:16:54]">&lt;dannym&gt;</a></span><span class="message">in the newer (unified) arm assembly they always use svc, &quot;supervisor call&quot;</span></div><div class="line" id="221705"><span class="nick" style="color:#af8d2f"><a href="#221705" label="[22:17:05]">&lt;janneke&gt;</a></span><span class="message">dannym: see novena:~janneke/src/guix/gcc-mesboot.sh to reproduce</span></div><div class="line" id="221726"><span class="nick" style="color:#af8d2f"><a href="#221726" label="[22:17:26]">&lt;janneke&gt;</a></span><span class="message">fossy: yes, we just built glibc-2.2.5 on arm, finally</span></div><div class="line" id="221800"><span class="nick" style="color:#234e69"><a href="#221800" label="[22:18:00]">&lt;fossy&gt;</a></span><span class="message">hooray!!</span></div><div class="line" id="221814"><span class="nick" style="color:#234e69"><a href="#221814" label="[22:18:14]">&lt;fossy&gt;</a></span><span class="message">does gcc2 support arm?</span></div><div class="line" id="221832"><span class="nick" style="color:#af8d2f"><a href="#221832" label="[22:18:32]">&lt;janneke&gt;</a></span><span class="message">yes</span></div><div class="line" id="221841"><span class="nick" style="color:#234e69"><a href="#221841" label="[22:18:41]">&lt;fossy&gt;</a></span><span class="message">neat</span></div><div class="line" id="221846"><span class="nick" style="color:#234e69"><a href="#221846" label="[22:18:46]">&lt;fossy&gt;</a></span><span class="message">but not riscv right</span></div><div class="line" id="221854"><span class="nick" style="color:#234e69"><a href="#221854" label="[22:18:54]">&lt;fossy&gt;</a></span><span class="message">thats what ur talk said iirc</span></div><div class="line" id="221859"><span class="nick" style="color:#af8d2f"><a href="#221859" label="[22:18:59]">&lt;janneke&gt;</a></span><span class="message">glibc-2.2.5 was built with gcc-core-2.95.3</span></div><div class="line" id="221921"><span class="nick" style="color:#234e69"><a href="#221921" label="[22:19:21]">&lt;fossy&gt;</a></span><span class="message">oh duh</span></div><div class="line" id="221921"><span class="nick" style="color:#af8d2f"><a href="#221921" label="[22:19:21]">&lt;janneke&gt;</a></span><span class="message">sure, risc-v was only added in gcc-7.x, i believe</span></div><div class="line" id="221930"><span class="nick" style="color:#234e69"><a href="#221930" label="[22:19:30]">&lt;fossy&gt;</a></span><span class="message">:/</span></div><div class="line" id="222446"><span class="nick" style="color:#3c5b35"><a href="#222446" label="[22:24:46]">&lt;dannym&gt;</a></span><span class="message">janneke: could you also make it write the opcodes of the disassembler?  Looking at <a rel="nofollow" href="https://paste.debian.net/1184979/">https://paste.debian.net/1184979/</a>  it &quot;should be fine&quot;</span></div><div class="line" id="222502"><span class="nick" style="color:#3c5b35"><a href="#222502" label="[22:25:02]">&lt;dannym&gt;</a></span><span class="message">janneke: SWI &lt;number!=0&gt; and SVC &lt;number!=0&gt; are non-EABI syscalls btw</span></div><div class="line" id="222507"><span class="nick" style="color:#3c5b35"><a href="#222507" label="[22:25:07]">&lt;dannym&gt;</a></span><span class="message">I thought we enabled EABI ?</span></div><div class="line" id="222529"><span class="nick" style="color:#3c5b35"><a href="#222529" label="[22:25:29]">&lt;dannym&gt;</a></span><span class="message">Whatever you do, the flag in the EFI header whether it wants EABI or not must match the actual SWI/SVC usages in the program</span></div><div class="line" id="222537"><span class="nick" style="color:#3c5b35"><a href="#222537" label="[22:25:37]">&lt;dannym&gt;</a></span><span class="message">for EABI, it's always SWI 0, SVC 0; never != 0</span></div><div class="line" id="222550"><span class="nick" style="color:#3c5b35"><a href="#222550" label="[22:25:50]">&lt;dannym&gt;</a></span><span class="message">for non-EABI, it's SWI &lt;syscallnumber&gt;, SVC &lt;syscallnumber&gt;</span></div><div class="line" id="222635"><span class="nick" style="color:#af8d2f"><a href="#222635" label="[22:26:35]">&lt;janneke&gt;</a></span><span class="message">&quot;janneke: could you also make it write the opcodes of the disassembler?&quot; how do i do that?</span></div><div class="line" id="222657"><span class="nick" style="color:#3c5b35"><a href="#222657" label="[22:26:57]">&lt;dannym&gt;</a></span><span class="message">in gdb? /r</span></div><div class="line" id="222704"><span class="nick" style="color:#3c5b35"><a href="#222704" label="[22:27:04]">&lt;dannym&gt;</a></span><span class="message">disass /r foobar</span></div><div class="line" id="222819"><span class="nick" style="color:#af8d2f"><a href="#222819" label="[22:28:19]">&lt;janneke&gt;</a></span><span class="message">dannym: =&gt; <a rel="nofollow" href="https://paste.debian.net/1184981">https://paste.debian.net/1184981</a> </span></div><div class="line" id="222833"><span class="nick" style="color:#3c5b35"><a href="#222833" label="[22:28:33]">&lt;dannym&gt;</a></span><span class="message">EFI header-&gt;ELF header</span></div><div class="line" id="222837"><span class="nick" style="color:#af8d2f"><a href="#222837" label="[22:28:37]">&lt;janneke&gt;</a></span><span class="message">i don't remember doing EABI or non-EABI in gcc/glibc</span></div><div class="line" id="222847"><span class="nick" style="color:#6b8072"><a href="#222847" label="[22:28:47]">*</a></span><span class="message">dannym should lay off the AMD firmware development for a while ;)</span></div><div class="line" id="222908"><span class="nick" style="color:#af8d2f"><a href="#222908" label="[22:29:08]">&lt;janneke&gt;</a></span><span class="message">hehe</span></div><div class="line" id="223104"><span class="nick" style="color:#af8d2f"><a href="#223104" label="[22:31:04]">&lt;janneke&gt;</a></span><span class="message">yeah, the ELF header says EABI =&gt; <a rel="nofollow" href="https://paste.debian.net/1184982/">https://paste.debian.net/1184982/</a> </span></div><div class="line" id="223121"><span class="nick" style="color:#af8d2f"><a href="#223121" label="[22:31:21]">&lt;janneke&gt;</a></span><span class="message">so, it doesn't match with the syscall</span></div><div class="line" id="223206"><span class="nick" style="color:#3c5b35"><a href="#223206" label="[22:32:06]">&lt;dannym&gt;</a></span><span class="message">Yep, Linux is gonna be very annoyed</span></div><div class="line" id="223222"><span class="nick" style="color:#af8d2f"><a href="#223222" label="[22:32:22]">&lt;janneke&gt;</a></span><span class="message">apparently</span></div><div class="line" id="223239"><span class="nick" style="color:#3c5b35"><a href="#223239" label="[22:32:39]">&lt;dannym&gt;</a></span><span class="message">I verified the opcodes for ldr	r8, [r10]; svc	0x00000014; mov	r4, r0--they are all correct</span></div><div class="line" id="223416"><span class="nick" style="color:#3c5b35"><a href="#223416" label="[22:34:16]">&lt;dannym&gt;</a></span><span class="message">So the CPU is fine with those :)</span></div><div class="line" id="224345"><span class="nick" style="color:#2e2a4a"><a href="#224345" label="[22:43:45]">&lt;stikonas&gt;</a></span><span class="message">argh, nice catch by migi (although, just left)</span></div><div class="line" id="224415"><span class="nick" style="color:#2e2a4a"><a href="#224415" label="[22:44:15]">&lt;stikonas&gt;</a></span><span class="message">pder: can if we can survive until binutils, we can then recompile musl/tcc...</span></div><div class="line" id="224450"><span class="nick" style="color:#6d2462"><a href="#224450" label="[22:44:50]">&lt;pder&gt;</a></span><span class="message">so we just need ar from binutils?</span></div><div class="line" id="224454"><span class="nick" style="color:#2e2a4a"><a href="#224454" label="[22:44:54]">&lt;stikonas&gt;</a></span><span class="message">pder: yes...</span></div><div class="line" id="224512"><span class="nick" style="color:#2e2a4a"><a href="#224512" label="[22:45:12]">&lt;stikonas&gt;</a></span><span class="message">but binutils is tricky to build, I don't think we can do it before we have autotools</span></div><div class="line" id="224525"><span class="nick" style="color:#2e2a4a"><a href="#224525" label="[22:45:25]">&lt;stikonas&gt;</a></span><span class="message">it has quite a few big libraries (bfd, etc...)</span></div><div class="line" id="224625"><span class="nick" style="color:#6d2462"><a href="#224625" label="[22:46:25]">&lt;pder&gt;</a></span><span class="message">I'm not clear on what the fix is in musl, since we no longer have any weak symbols right?</span></div><div class="line" id="224705"><span class="nick" style="color:#6d2462"><a href="#224705" label="[22:47:05]">&lt;pder&gt;</a></span><span class="message">And if you remove that weak symbols patch you just had trouble linking?</span></div><div class="line" id="224841"><span class="nick" style="color:#2e2a4a"><a href="#224841" label="[22:48:41]">&lt;stikonas&gt;</a></span><span class="message">yes...</span></div><div class="line" id="224903"><span class="nick" style="color:#2e2a4a"><a href="#224903" label="[22:49:03]">&lt;stikonas&gt;</a></span><span class="message">proper fix would be to fix tcc -ar</span></div><div class="line" id="224909"><span class="nick" style="color:#2e2a4a"><a href="#224909" label="[22:49:09]">&lt;stikonas&gt;</a></span><span class="message">but that might not be easy...</span></div><div class="line" id="224926"><span class="nick" style="color:#6d2462"><a href="#224926" label="[22:49:26]">&lt;pder&gt;</a></span><span class="message">Do you think it could just be a linking order issue?</span></div><div class="line" id="224937"><span class="nick" style="color:#6d2462"><a href="#224937" label="[22:49:37]">&lt;pder&gt;</a></span><span class="message">static linking can be particular about order</span></div><div class="line" id="225900"><span class="nick" style="color:#2e2a4a"><a href="#225900" label="[22:59:00]">&lt;stikonas&gt;</a></span><span class="message">hmm, it might be...</span></div><div class="line" id="225912"><span class="nick" style="color:#2e2a4a"><a href="#225912" label="[22:59:12]">&lt;stikonas&gt;</a></span><span class="message">but it's hard to control linking order...</span></div><div class="line" id="225939"><span class="nick" style="color:#2e2a4a"><a href="#225939" label="[22:59:39]">&lt;stikonas&gt;</a></span><span class="message">e.g. musl has its own makefiles...</span></div><div class="line" id="225942"><span class="nick" style="color:#2e2a4a"><a href="#225942" label="[22:59:42]">&lt;stikonas&gt;</a></span><span class="message">we didn't write them</span></div><br /></div></body></html>