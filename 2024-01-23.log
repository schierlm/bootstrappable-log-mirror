<!DOCTYPE html><html><head><title>IRC channel logs</title><style>html {
  background: #fdfdfd;
}

h1 {
  font-weight: 300;
}

h2 {
  font-weight: 200;
}

h3 {
  padding: .5em 0;
  border-top: 3px dotted #ddd;
  margin-bottom: 0;
}

form {
  width: 400px;
  display: flex;
}

input {
  width: 100%;
  display: flex;
  border-radius: .25em 0 0 .25em;
  border: 1px solid #aaa;
  border-right: 0;
  padding: 0.5em;
}

button {
  display: flex;
  border-radius: 0 .25em .25em 0;
  background-color: #007bff;
  border: 1px solid #007bff;
  padding: .5em;
  cursor: pointer;
  color: white;
}

button:hover {
  background-color: #0069d9;
  border-color: #0062cc;
}

a {
  color: #007bff;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h4 {
  margin-bottom: .5em;
}

table td {
  padding: 0.75em;
}

table tr:hover {
  background: #eee;
}

.year {
  display: table;
}

.month {
  display: table-cell;
  padding-right: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.nick {
  padding-right: 0.6rem;
  font-weight: bold;
  text-align: right;
  width: 13rem;
  display: table-cell;
}

.nick a {
  color: inherit;
  text-decoration: none;
}

.message {
  display: table-cell;
  padding-left: 0.6rem;
  border-left: 2px solid #333;
}

.notice {
  color: #859900;
  font-style: italic;
}

.line {
  line-height: 1.8rem;
  display: table;
}

#logs {
  margin-top: 1.5rem;
  padding: 1.5rem;
}
</style></head><body><h1>IRC channel logs</h1><h2>2024-01-23.log</h2><p><a href="/bootstrappable">back to list of logs</a></p><div id="logs"><div class="line" id="000017"><span class="nick" style="color:#389600"><a href="#000017" label="[00:00:17]">&lt;Googulator&gt;</a></span><span class="message">it would be much better to just ship that one file</span></div><div class="line" id="002612"><span class="nick" style="color:#8dd3c7"><a href="#002612" label="[00:26:12]">&lt;fossy&gt;</a></span><span class="message">tbh, i'd be happy just including <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/file/tip/security/nss/lib/ckfw/builtins/certdata.txt">https://hg.mozilla.org/releases/mozilla-beta/file/tip/security/nss/lib/ckfw/builtins/certdata.txt</a>  as the distfile (Well tied to a commit)</span></div><div class="line" id="003236"><span class="nick" style="color:#2e2a4a"><a href="#003236" label="[00:32:36]">&lt;stikonas&gt;</a></span><span class="message">well, right now just GTS Root R1 certificate is sufficient to download rest of ca-certificates</span></div><div class="line" id="003250"><span class="nick" style="color:#2e2a4a"><a href="#003250" label="[00:32:50]">&lt;stikonas&gt;</a></span><span class="message">but that's depending on them keeping to the same cert</span></div><div class="line" id="003619"><span class="nick" style="color:#8dd3c7"><a href="#003619" label="[00:36:19]">&lt;fossy&gt;</a></span><span class="message">mm, ca certificates are one of those things that will inheriently break at some point in the future :\</span></div><div class="line" id="003750"><span class="nick" style="color:#2e2a4a"><a href="#003750" label="[00:37:50]">&lt;stikonas&gt;</a></span><span class="message">indeed...</span></div><div class="line" id="003808"><span class="nick" style="color:#2e2a4a"><a href="#003808" label="[00:38:08]">&lt;stikonas&gt;</a></span><span class="message">but by shipping just one we risk breaking a bit more frequently</span></div><div class="line" id="003823"><span class="nick" style="color:#2e2a4a"><a href="#003823" label="[00:38:23]">&lt;stikonas&gt;</a></span><span class="message">as server admins in general are free to change certificate providers</span></div><div class="line" id="004415"><span class="nick" style="color:#8dd3c7"><a href="#004415" label="[00:44:15]">&lt;fossy&gt;</a></span><span class="message">&quot;An unfortunate blemish is that we number build scripts from 1, but repo tarballs from 0 - it would be nice to standardize on a single indexing convention.&quot;</span></div><div class="line" id="004420"><span class="nick" style="color:#8dd3c7"><a href="#004420" label="[00:44:20]">&lt;fossy&gt;</a></span><span class="message">Googulator: you make a good point, actually</span></div><div class="line" id="004426"><span class="nick" style="color:#8dd3c7"><a href="#004426" label="[00:44:26]">&lt;fossy&gt;</a></span><span class="message">not one i had ever thought of, to be honest!</span></div><div class="line" id="004443"><span class="nick" style="color:#8dd3c7"><a href="#004443" label="[00:44:43]">&lt;fossy&gt;</a></span><span class="message">i had in my brain, pass1.sh is &quot;1st pass&quot;, pass2.sh is &quot;2nd pass&quot;, ...</span></div><div class="line" id="004453"><span class="nick" style="color:#8dd3c7"><a href="#004453" label="[00:44:53]">&lt;fossy&gt;</a></span><span class="message">and revision is a counter, so it should start from 0</span></div><div class="line" id="004457"><span class="nick" style="color:#8dd3c7"><a href="#004457" label="[00:44:57]">&lt;fossy&gt;</a></span><span class="message">but you're right, it's not very logical</span></div><div class="line" id="004539"><span class="nick" style="color:#2e2a4a"><a href="#004539" label="[00:45:39]">&lt;stikonas&gt;</a></span><span class="message">just add 1 to revision?</span></div><div class="line" id="004550"><span class="nick" style="color:#8dd3c7"><a href="#004550" label="[00:45:50]">&lt;fossy&gt;</a></span><span class="message">yeah perhaps revision should start at 1</span></div><div class="line" id="012634"><span class="nick" style="color:#6b8072"><a href="#012634" label="[01:26:34]">&lt;oriansj&gt;</a></span><span class="message">wouldn't the let's encrypt certificate work too? as we could host an updated set of root certs which then we update on a yearly basis, should limit the breakage.</span></div><div class="line" id="012736"><span class="nick" style="color:#6b8072"><a href="#012736" label="[01:27:36]">&lt;oriansj&gt;</a></span><span class="message">as they tend to give lots of warning to root cert changes.</span></div><div class="line" id="014856"><span class="nick" style="color:#2e2a4a"><a href="#014856" label="[01:48:56]">&lt;stikonas&gt;</a></span><span class="message">yeah, we could host ca-certificates there...</span></div><div class="line" id="115746"><span class="nick" style="color:#389600"><a href="#115746" label="[11:57:46]">&lt;Googulator&gt;</a></span><span class="message">fossy, stikonas: can you please review <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/pull/415">https://github.com/fosslinux/live-bootstrap/pull/415</a>  for any pregen files I may have missed?</span></div><div class="line" id="135524"><span class="nick" style="color:#80b1d3"><a href="#135524" label="[13:55:24]">&lt;nimaje&gt;</a></span><span class="message">hm, there is an incomplete public domain libc, maybe some of it can be integrated into meslibc</span></div><div class="line" id="135544"><span class="nick" style="color:#80b1d3"><a href="#135544" label="[13:55:44]">&lt;nimaje&gt;</a></span><span class="message"> <a rel="nofollow" href="https://github.com/dryc/libc11/">https://github.com/dryc/libc11/</a> </span></div><div class="line" id="164557"><span class="nick" style="color:#6d2462"><a href="#164557" label="[16:45:57]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; nimaje: is it not smaller than meslibc?</span></div><div class="line" id="164632"><span class="nick" style="color:#6d2462"><a href="#164632" label="[16:46:32]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Looks like meslibs is far more complete</span></div><div class="line" id="165357"><span class="nick" style="color:#80b1d3"><a href="#165357" label="[16:53:57]">&lt;nimaje&gt;</a></span><span class="message">I didn't look how they compare, I expected that it at least has some stuff that meslibc has not, but it also has a tabel of libc comparisions at the bottom of the readme</span></div><div class="line" id="170305"><span class="nick" style="color:#6d2462"><a href="#170305" label="[17:03:05]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Well there might be some things. But then you can just steal them from any other libc</span></div><div class="line" id="172723"><span class="nick" style="color:#389600"><a href="#172723" label="[17:27:23]">&lt;Googulator&gt;</a></span><span class="message">Mikaku: are virtual consoles (i.e. Ctrl+Alt+F2) supported in Fiwix?</span></div><div class="line" id="172937"><span class="nick" style="color:#234e69"><a href="#172937" label="[17:29:37]">&lt;Mikaku&gt;</a></span><span class="message">Googulator: yes, up to 12 virtual consoles</span></div><div class="line" id="172958"><span class="nick" style="color:#389600"><a href="#172958" label="[17:29:58]">&lt;Googulator&gt;</a></span><span class="message">Is there a way to activate them before we can build kbd?</span></div><div class="line" id="174139"><span class="nick" style="color:#234e69"><a href="#174139" label="[17:41:39]">&lt;Mikaku&gt;</a></span><span class="message">they are already enabled, you just need to run *getty on them</span></div><div class="line" id="174949"><span class="nick" style="color:#389600"><a href="#174949" label="[17:49:49]">&lt;Googulator&gt;</a></span><span class="message">live-bootstrap has no getty...</span></div><div class="line" id="175013"><span class="nick" style="color:#389600"><a href="#175013" label="[17:50:13]">&lt;Googulator&gt;</a></span><span class="message">I was thinking the equivalent of &quot;openvt -- bash -i&quot;</span></div><div class="line" id="175032"><span class="nick" style="color:#389600"><a href="#175032" label="[17:50:32]">&lt;Googulator&gt;</a></span><span class="message">but before we have openvt built</span></div><div class="line" id="175142"><span class="nick" style="color:#234e69"><a href="#175142" label="[17:51:42]">&lt;Mikaku&gt;</a></span><span class="message">kernel won't give you such a service, this belongs to user land</span></div><div class="line" id="175826"><span class="nick" style="color:#389600"><a href="#175826" label="[17:58:26]">&lt;Googulator&gt;</a></span><span class="message">I mean, what is the &quot;magic&quot; (some system call or IOCTL I presume) that getty does to enable Ctrl+Alt+F[n]-ing to that console? I presume simply opening the relevant TTY and trying to talk over it isn't enough.</span></div><div class="line" id="175923"><span class="nick" style="color:#389600"><a href="#175923" label="[17:59:23]">&lt;Googulator&gt;</a></span><span class="message">i.e. one can't just redirect I/O to /dev/tty2 and expect Ctrl+Alt+F2 to work</span></div><div class="line" id="175924"><span class="nick" style="color:#234e69"><a href="#175924" label="[17:59:24]">&lt;Mikaku&gt;</a></span><span class="message">well, yes, you need to open(/dev/tty2&quot;, ...) to be able to read/write on it</span></div><div class="line" id="175947"><span class="nick" style="color:#389600"><a href="#175947" label="[17:59:47]">&lt;Googulator&gt;</a></span><span class="message">But is that enough to enable the key combination?</span></div><div class="line" id="180001"><span class="nick" style="color:#234e69"><a href="#180001" label="[18:00:01]">&lt;Mikaku&gt;</a></span><span class="message">oh yes, you can redirect anything you want there, it will work</span></div><div class="line" id="180003"><span class="nick" style="color:#389600"><a href="#180003" label="[18:00:03]">&lt;Googulator&gt;</a></span><span class="message">AFAIK on Linux it's not</span></div><div class="line" id="180028"><span class="nick" style="color:#389600"><a href="#180028" label="[18:00:28]">&lt;Googulator&gt;</a></span><span class="message">you have to issue a &quot;magic&quot; IOCTL, otherwise Linux will ignore Ctrl+Alt+F2</span></div><div class="line" id="180204"><span class="nick" style="color:#234e69"><a href="#180204" label="[18:02:04]">&lt;Mikaku&gt;</a></span><span class="message">Linux doesn't permit you to switch to an unopened virtual console, but as soon as you redirects something to them then you can switch to it</span></div><div class="line" id="180223"><span class="nick" style="color:#234e69"><a href="#180223" label="[18:02:23]">&lt;Mikaku&gt;</a></span><span class="message">Fiwix permits you switch to any virtual console, don't need to previously redirect something to it</span></div><div class="line" id="180331"><span class="nick" style="color:#234e69"><a href="#180331" label="[18:03:31]">&lt;Mikaku&gt;</a></span><span class="message">I tested on the old Linux version 2.0, don't know if this changed on newer Linux kernels</span></div><div class="line" id="180405"><span class="nick" style="color:#389600"><a href="#180405" label="[18:04:05]">&lt;Googulator&gt;</a></span><span class="message">strange, I seem to remember testing (on a newer kernel), simply doing &quot;echo test &gt; /dev/tty2&quot; doesn't enable Ctrl+Alt+F2</span></div><div class="line" id="180420"><span class="nick" style="color:#234e69"><a href="#180420" label="[18:04:20]">&lt;Mikaku&gt;</a></span><span class="message">well, define 'enable'?</span></div><div class="line" id="180439"><span class="nick" style="color:#389600"><a href="#180439" label="[18:04:39]">&lt;Googulator&gt;</a></span><span class="message">Ctrl+Alt+F2 remains ignored after that simple test</span></div><div class="line" id="180452"><span class="nick" style="color:#234e69"><a href="#180452" label="[18:04:52]">&lt;Mikaku&gt;</a></span><span class="message">you mean that you cannot switch to tty12?</span></div><div class="line" id="180505"><span class="nick" style="color:#234e69"><a href="#180505" label="[18:05:05]">&lt;Mikaku&gt;</a></span><span class="message">err .. tty2</span></div><div class="line" id="180517"><span class="nick" style="color:#389600"><a href="#180517" label="[18:05:17]">&lt;Googulator&gt;</a></span><span class="message">No, or at least not via the key combo</span></div><div class="line" id="180531"><span class="nick" style="color:#234e69"><a href="#180531" label="[18:05:31]">&lt;Mikaku&gt;</a></span><span class="message">then they changed it</span></div><div class="line" id="180543"><span class="nick" style="color:#234e69"><a href="#180543" label="[18:05:43]">&lt;Mikaku&gt;</a></span><span class="message">with older kernels it worked as it</span></div><div class="line" id="180644"><span class="nick" style="color:#389600"><a href="#180644" label="[18:06:44]">&lt;Googulator&gt;</a></span><span class="message">If I then use openvt or getty on it, I can then switch, and see that &quot;test&quot; did in fact get printed - but some poorly documented &quot;magic&quot; is clearly needed</span></div><div class="line" id="180927"><span class="nick" style="color:#389600"><a href="#180927" label="[18:09:27]">&lt;Googulator&gt;</a></span><span class="message">oriansj: do you know why bash-2.05b was picked for the early shell, from all versions?</span></div><div class="line" id="181015"><span class="nick" style="color:#6d2462"><a href="#181015" label="[18:10:15]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Googulator: I kind of know</span></div><div class="line" id="181018"><span class="nick" style="color:#389600"><a href="#181018" label="[18:10:18]">&lt;Googulator&gt;</a></span><span class="message">2.05b is unfortunately the last version not to support &quot;set -E&quot;</span></div><div class="line" id="181030"><span class="nick" style="color:#389600"><a href="#181030" label="[18:10:30]">&lt;Googulator&gt;</a></span><span class="message">which is needed for the interactive trap</span></div><div class="line" id="181102"><span class="nick" style="color:#6d2462"><a href="#181102" label="[18:11:02]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; We picked it because guix used that in bootstrap</span></div><div class="line" id="181116"><span class="nick" style="color:#6d2462"><a href="#181116" label="[18:11:16]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; And meslibc was known to build it</span></div><div class="line" id="181131"><span class="nick" style="color:#6d2462"><a href="#181131" label="[18:11:31]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; You could try to update it</span></div><div class="line" id="181154"><span class="nick" style="color:#6d2462"><a href="#181154" label="[18:11:54]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; But set -E might need new stuff in libc</span></div><div class="line" id="181208"><span class="nick" style="color:#389600"><a href="#181208" label="[18:12:08]">&lt;Googulator&gt;</a></span><span class="message">-i mode is kind of broken right now because of this - it doesn't crash, but has a nasty side effect of checksum failures not trapping until the 2nd bash is built</span></div><div class="line" id="181257"><span class="nick" style="color:#389600"><a href="#181257" label="[18:12:57]">&lt;Googulator&gt;</a></span><span class="message">so &quot;-i&quot; will spuriously succeed if one of the early packages has a bad checksum without --update-checksums</span></div><div class="line" id="181300"><span class="nick" style="color:#6d2462"><a href="#181300" label="[18:13:00]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; We should try to rebuild bash earlier....</span></div><div class="line" id="181316"><span class="nick" style="color:#6d2462"><a href="#181316" label="[18:13:16]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Once musl and I guess autotools are avaable</span></div><div class="line" id="181332"><span class="nick" style="color:#389600"><a href="#181332" label="[18:13:32]">&lt;Googulator&gt;</a></span><span class="message">Strangely there is a pass2 script included with bash-2.05b, but it's unused</span></div><div class="line" id="181342"><span class="nick" style="color:#389600"><a href="#181342" label="[18:13:42]">&lt;Googulator&gt;</a></span><span class="message">and I haven't seen any point in the history where it was used</span></div><div class="line" id="181408"><span class="nick" style="color:#6d2462"><a href="#181408" label="[18:14:08]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; There was I think</span></div><div class="line" id="181412"><span class="nick" style="color:#6d2462"><a href="#181412" label="[18:14:12]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; But short...</span></div><div class="line" id="181524"><span class="nick" style="color:#6d2462"><a href="#181524" label="[18:15:24]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Oh maybe <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/commit/da9a2c6c50f9fafff4ea3b8393443f469f5f0d81">https://github.com/fosslinux/live-bootstrap/commit/da9a2c6c50f9fafff4ea3b8393443f469f5f0d81</a> </span></div><div class="line" id="181525"><span class="nick" style="color:#389600"><a href="#181525" label="[18:15:25]">&lt;Googulator&gt;</a></span><span class="message">looks like redirecting bash to /dev/tty2 does work in Linux</span></div><div class="line" id="182632"><span class="nick" style="color:#6d2462"><a href="#182632" label="[18:26:32]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Googulator: <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/commit/16cd5be62610fbc5e0eae90358cf0c15ca72316c">https://github.com/fosslinux/live-bootstrap/commit/16cd5be62610fbc5e0eae90358cf0c15ca72316c</a> </span></div><div class="line" id="182639"><span class="nick" style="color:#6d2462"><a href="#182639" label="[18:26:39]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; It was used in this commit</span></div><div class="line" id="182650"><span class="nick" style="color:#6d2462"><a href="#182650" label="[18:26:50]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; But prob reverted later</span></div><div class="line" id="193301"><span class="nick" style="color:#6c3d55"><a href="#193301" label="[19:33:01]">&lt;rickmasters&gt;</a></span><span class="message">Doing an earlier bash 5 was reverted because I couldn't get it to build on Fiwix. That was holding up kernel bootstrap integration.</span></div><div class="line" id="193341"><span class="nick" style="color:#6c3d55"><a href="#193341" label="[19:33:41]">&lt;rickmasters&gt;</a></span><span class="message">Some discussion here: <a rel="nofollow" href="https://logs.guix.gnu.org/bootstrappable/2023-03-05.log">https://logs.guix.gnu.org/bootstrappable/2023-03-05.log</a> </span></div><div class="line" id="193735"><span class="nick" style="color:#6c3d55"><a href="#193735" label="[19:37:35]">&lt;rickmasters&gt;</a></span><span class="message">I gave up here: <a rel="nofollow" href="https://logs.guix.gnu.org/bootstrappable/2023-03-08.log">https://logs.guix.gnu.org/bootstrappable/2023-03-08.log</a> </span></div><div class="line" id="203350"><span class="nick" style="color:#389600"><a href="#203350" label="[20:33:50]">&lt;Googulator&gt;</a></span><span class="message">Mikaku: testing multiconsole now in Fiwix 1.5.0-lb1 - looks like there's a weird bug</span></div><div class="line" id="203423"><span class="nick" style="color:#389600"><a href="#203423" label="[20:34:23]">&lt;Googulator&gt;</a></span><span class="message">Bash did start on the 2nd console, but the build output gets printed on whatever console I switch to</span></div><div class="line" id="203457"><span class="nick" style="color:#389600"><a href="#203457" label="[20:34:57]">&lt;Googulator&gt;</a></span><span class="message">instead of staying on tty1</span></div><div class="line" id="205139"><span class="nick" style="color:#234e69"><a href="#205139" label="[20:51:39]">&lt;Mikaku&gt;</a></span><span class="message">Googulator: did you set the console to /dev/tty0?</span></div><div class="line" id="205243"><span class="nick" style="color:#234e69"><a href="#205243" label="[20:52:43]">&lt;Mikaku&gt;</a></span><span class="message">if the output is redirected to /dev/console then it will appear on the current tty</span></div><div class="line" id="211926"><span class="nick" style="color:#6c3d55"><a href="#211926" label="[21:19:26]">&lt;rickmasters&gt;</a></span><span class="message">It turns out that I removed the rebuild of bash 2.05b in the commit for kernel-bootstrap:</span></div><div class="line" id="211927"><span class="nick" style="color:#6c3d55"><a href="#211927" label="[21:19:27]">&lt;rickmasters&gt;</a></span><span class="message"> <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/commit/ecf99ab08b09c0da98af8e136c99867d8392f8bd#diff-349a44bc9ca6b335170dd658fd6b664e26d96a15e24d3ec29289c11b55f04bf3">https://github.com/fosslinux/live-bootstrap/commit/ecf99ab08b09c0da98af8e136c99867d8392f8bd#diff-349a44bc9ca6b335170dd658fd6b664e26d96a15e24d3ec29289c11b55f04bf3</a> </span></div><div class="line" id="212128"><span class="nick" style="color:#2e2a4a"><a href="#212128" label="[21:21:28]">&lt;stikonas&gt;</a></span><span class="message">perhaps you had some issue</span></div><div class="line" id="212129"><span class="nick" style="color:#6c3d55"><a href="#212129" label="[21:21:29]">&lt;rickmasters&gt;</a></span><span class="message">Unfortunately, I cannot remember why I did that. It may have been a mixup with how we reverted bash 5 in that location.</span></div><div class="line" id="212132"><span class="nick" style="color:#2e2a4a"><a href="#212132" label="[21:21:32]">&lt;stikonas&gt;</a></span><span class="message">and didn't have time to investigate</span></div><div class="line" id="212137"><span class="nick" style="color:#2e2a4a"><a href="#212137" label="[21:21:37]">&lt;stikonas&gt;</a></span><span class="message">or maybe some mixup</span></div><div class="line" id="212146"><span class="nick" style="color:#2e2a4a"><a href="#212146" label="[21:21:46]">&lt;stikonas&gt;</a></span><span class="message">in any case, might be worth attempting to readd it</span></div><div class="line" id="212153"><span class="nick" style="color:#2e2a4a"><a href="#212153" label="[21:21:53]">&lt;stikonas&gt;</a></span><span class="message">or try newer bash...</span></div><div class="line" id="212324"><span class="nick" style="color:#6c3d55"><a href="#212324" label="[21:23:24]">&lt;rickmasters&gt;</a></span><span class="message">It may be that I somehow discovered we didn't really need to rebuild it and thought it was simpler without it.</span></div><div class="line" id="212419"><span class="nick" style="color:#6c3d55"><a href="#212419" label="[21:24:19]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: Do you remember why we rebuilt it? It involved transitioning to run2.sh to it wasn't without complication so I'm assuming there was a reason in the first place for it.</span></div><div class="line" id="212420"><span class="nick" style="color:#2e2a4a"><a href="#212420" label="[21:24:20]">&lt;stikonas&gt;</a></span><span class="message">well, yeah, rebuild is optional</span></div><div class="line" id="212429"><span class="nick" style="color:#2e2a4a"><a href="#212429" label="[21:24:29]">&lt;stikonas&gt;</a></span><span class="message">oh it was just to have interactive bash earlier</span></div><div class="line" id="212437"><span class="nick" style="color:#2e2a4a"><a href="#212437" label="[21:24:37]">&lt;stikonas&gt;</a></span><span class="message">it's better for error handlign</span></div><div class="line" id="212444"><span class="nick" style="color:#2e2a4a"><a href="#212444" label="[21:24:44]">&lt;stikonas&gt;</a></span><span class="message">you get a shell to investigate</span></div><div class="line" id="212455"><span class="nick" style="color:#2e2a4a"><a href="#212455" label="[21:24:55]">&lt;stikonas&gt;</a></span><span class="message">rather than just error out with subprocess error</span></div><div class="line" id="212500"><span class="nick" style="color:#6c3d55"><a href="#212500" label="[21:25:00]">&lt;rickmasters&gt;</a></span><span class="message">ok, so there was something in a dependency that enabled that?</span></div><div class="line" id="212536"><span class="nick" style="color:#6d2462"><a href="#212536" label="[21:25:36]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Well, just new libc</span></div><div class="line" id="212548"><span class="nick" style="color:#6d2462"><a href="#212548" label="[21:25:48]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Meslibc does not have required headers</span></div><div class="line" id="212620"><span class="nick" style="color:#6d2462"><a href="#212620" label="[21:26:20]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; And first version is built with custom makefile and minimal features</span></div><div class="line" id="213207"><span class="nick" style="color:#6c3d55"><a href="#213207" label="[21:32:07]">&lt;rickmasters&gt;</a></span><span class="message">I can try to add back the rebuild.</span></div><div class="line" id="213628"><span class="nick" style="color:#d9d9d9"><a href="#213628" label="[21:36:28]">&lt;lrvick&gt;</a></span><span class="message">Is there any particular reason for the whole coreutils/curl stack in live-bootstap and friends? I have been building kernel, binutils, gcc, musl, and even all the way up to rust 1.74 with just busybox as a base.</span></div><div class="line" id="213658"><span class="nick" style="color:#d9d9d9"><a href="#213658" label="[21:36:58]">&lt;lrvick&gt;</a></span><span class="message">given I hashlock everything even busybox wget has been fine</span></div><div class="line" id="214504"><span class="nick" style="color:#6c3d55"><a href="#214504" label="[21:45:04]">&lt;rickmasters&gt;</a></span><span class="message">lrvick: not sure I understand. live-bootstrap can build from &quot;scratch&quot; so it won't presume having busybox to start with.</span></div><div class="line" id="214716"><span class="nick" style="color:#6c3d55"><a href="#214716" label="[21:47:16]">&lt;rickmasters&gt;</a></span><span class="message">The idea is to strictly limit the seed binaries to start with. Currently that's down to a single binary boot sector and everything else must be source code.</span></div><div class="line" id="215021"><span class="nick" style="color:#6c3d55"><a href="#215021" label="[21:50:21]">&lt;rickmasters&gt;</a></span><span class="message">Of course there is a ton of python code to prepare the boot disk image but in theory that could be done &quot;manually&quot;.</span></div><div class="line" id="215350"><span class="nick" style="color:#2e2a4a"><a href="#215350" label="[21:53:50]">&lt;stikonas&gt;</a></span><span class="message">lrvick: busybox is not easy to build</span></div><div class="line" id="215402"><span class="nick" style="color:#2e2a4a"><a href="#215402" label="[21:54:02]">&lt;stikonas&gt;</a></span><span class="message">probably a lot of requirements on libc</span></div><div class="line" id="225039"><span class="nick" style="color:#6c3d55"><a href="#225039" label="[22:50:39]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: So bash-2.05b does not rebuild on Fiwix. There are faults in configure, related to signals.</span></div><div class="line" id="225052"><span class="nick" style="color:#2e2a4a"><a href="#225052" label="[22:50:52]">&lt;stikonas&gt;</a></span><span class="message">oh I see</span></div><div class="line" id="225114"><span class="nick" style="color:#2e2a4a"><a href="#225114" label="[22:51:14]">&lt;stikonas&gt;</a></span><span class="message">so ./configure exists with non-zero code?</span></div><div class="line" id="225119"><span class="nick" style="color:#2e2a4a"><a href="#225119" label="[22:51:19]">&lt;stikonas&gt;</a></span><span class="message">or some other failure mode?</span></div><div class="line" id="225218"><span class="nick" style="color:#6c3d55"><a href="#225218" label="[22:52:18]">&lt;rickmasters&gt;</a></span><span class="message">It's general protection faults. Its funny because I was complaining about the upgrade to bash 5 but bash 2 didn't work either.</span></div><div class="line" id="225302"><span class="nick" style="color:#6c3d55"><a href="#225302" label="[22:53:02]">&lt;rickmasters&gt;</a></span><span class="message">Its making me think that I dropped the rebuild on accident and somehow thought it was working...</span></div><div class="line" id="225344"><span class="nick" style="color:#6c3d55"><a href="#225344" label="[22:53:44]">&lt;rickmasters&gt;</a></span><span class="message">I'm not sure. But I can give it another shot. I've got more time now.</span></div><div class="line" id="225403"><span class="nick" style="color:#2e2a4a"><a href="#225403" label="[22:54:03]">&lt;stikonas&gt;</a></span><span class="message">sure, that would be very helpful</span></div><div class="line" id="225423"><span class="nick" style="color:#2e2a4a"><a href="#225423" label="[22:54:23]">&lt;stikonas&gt;</a></span><span class="message">I would look myself, but quite busy with all other bootstrapping stuff...</span></div><div class="line" id="225559"><span class="nick" style="color:#6c3d55"><a href="#225559" label="[22:55:59]">&lt;rickmasters&gt;</a></span><span class="message">Actually it's faults in configure and then later it faults on bison -y -d ./parse.y</span></div><div class="line" id="225649"><span class="nick" style="color:#2e2a4a"><a href="#225649" label="[22:56:49]">&lt;stikonas&gt;</a></span><span class="message">hmm, sounds like quite a few issues...</span></div><div class="line" id="225818"><span class="nick" style="color:#6c3d55"><a href="#225818" label="[22:58:18]">&lt;rickmasters&gt;</a></span><span class="message">Yeah, it's gonna take a while.</span></div><div class="line" id="230015"><span class="nick" style="color:#389600"><a href="#230015" label="[23:00:15]">&lt;Googulator&gt;</a></span><span class="message">Mikaku: I believe the main build is running with no redirection at all</span></div><div class="line" id="230210"><span class="nick" style="color:#389600"><a href="#230210" label="[23:02:10]">&lt;Googulator&gt;</a></span><span class="message">When Fiwix is booted via kexec-fiwix, it executes /init (explicitly set via custom_kernel.h), which is actually a binary of kaem</span></div><div class="line" id="230254"><span class="nick" style="color:#389600"><a href="#230254" label="[23:02:54]">&lt;Googulator&gt;</a></span><span class="message">It defaults to then running the script kaem.x86</span></div><div class="line" id="230302"><span class="nick" style="color:#389600"><a href="#230302" label="[23:03:02]">&lt;Googulator&gt;</a></span><span class="message">sorry, kaem.run</span></div><div class="line" id="230331"><span class="nick" style="color:#389600"><a href="#230331" label="[23:03:31]">&lt;Googulator&gt;</a></span><span class="message">kaem itself doesn't support redirection</span></div><div class="line" id="230509"><span class="nick" style="color:#2e2a4a"><a href="#230509" label="[23:05:09]">&lt;stikonas&gt;</a></span><span class="message">yeah, it can't support that easily</span></div><div class="line" id="230523"><span class="nick" style="color:#2e2a4a"><a href="#230523" label="[23:05:23]">&lt;stikonas&gt;</a></span><span class="message">we want it to run on simple kernels too (i.e. builder-hex0)</span></div><div class="line" id="230526"><span class="nick" style="color:#389600"><a href="#230526" label="[23:05:26]">&lt;Googulator&gt;</a></span><span class="message">kaem.run calls /steps/1.sh (actually a kaem script, not a bash one), which builds bash, then calls the next stage as &quot;bash /steps/2.sh&quot;</span></div><div class="line" id="230529"><span class="nick" style="color:#389600"><a href="#230529" label="[23:05:29]">&lt;Googulator&gt;</a></span><span class="message">again, no redirection</span></div><div class="line" id="230722"><span class="nick" style="color:#389600"><a href="#230722" label="[23:07:22]">&lt;Googulator&gt;</a></span><span class="message">2.sh then sources /steps/improve/open_console.sh, which hooks up a &quot;fake-interactive&quot; bash shell directly to tty2</span></div><div class="line" id="230755"><span class="nick" style="color:#389600"><a href="#230755" label="[23:07:55]">&lt;Googulator&gt;</a></span><span class="message">the exact command is bash -c 'while true; do printf &quot;[early Bash - use Ctrl+D] $(pwd) # &quot;; $(cat /dev/tty2); done' &amp;&gt; /dev/tty2 &amp;</span></div><div class="line" id="230817"><span class="nick" style="color:#389600"><a href="#230817" label="[23:08:17]">&lt;Googulator&gt;</a></span><span class="message"> /dev/console is never touched</span></div><div class="line" id="230921"><span class="nick" style="color:#389600"><a href="#230921" label="[23:09:21]">&lt;Googulator&gt;</a></span><span class="message">in fact, the file /dev/console doesn't even exist until right before open_console.sh is sourced</span></div><div class="line" id="231044"><span class="nick" style="color:#389600"><a href="#231044" label="[23:10:44]">&lt;Googulator&gt;</a></span><span class="message">so it appears Fiwix is wrongly defaulting to /dev/console instead of /dev/tty1 for init output</span></div><div class="line" id="231310"><span class="nick" style="color:#389600"><a href="#231310" label="[23:13:10]">&lt;Googulator&gt;</a></span><span class="message">hmm, it could actually be kexec-fiwix instead that messes up</span></div><div class="line" id="231352"><span class="nick" style="color:#389600"><a href="#231352" label="[23:13:52]">&lt;Googulator&gt;</a></span><span class="message">in kexec-fiwix, we pass &quot;console=/dev/ttyS0&quot; in qemu mode</span></div><div class="line" id="231412"><span class="nick" style="color:#389600"><a href="#231412" label="[23:14:12]">&lt;Googulator&gt;</a></span><span class="message">but in bare metal mode (where virtual terminals are actually relevant), we pass no &quot;console=&quot; at all</span></div><div class="line" id="231415"><span class="nick" style="color:#389600"><a href="#231415" label="[23:14:15]">&lt;Googulator&gt;</a></span><span class="message">relying on internal default</span></div><div class="line" id="232311"><span class="nick" style="color:#389600"><a href="#232311" label="[23:23:11]">&lt;Googulator&gt;</a></span><span class="message">and the internal default is /dev/tty0</span></div><div class="line" id="232400"><span class="nick" style="color:#389600"><a href="#232400" label="[23:24:00]">&lt;Googulator&gt;</a></span><span class="message">which is apparently a shorthand for the current console, just like /dev/console (?)</span></div><br /></div></body></html>