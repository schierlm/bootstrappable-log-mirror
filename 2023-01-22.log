<!DOCTYPE html><html><head><title>IRC channel logs</title><style>html {
  background: #fdfdfd;
}

h1 {
  font-weight: 300;
}

h2 {
  font-weight: 200;
}

h3 {
  padding: .5em 0;
  border-top: 3px dotted #ddd;
  margin-bottom: 0;
}

form {
  width: 400px;
  display: flex;
}

input {
  width: 100%;
  display: flex;
  border-radius: .25em 0 0 .25em;
  border: 1px solid #aaa;
  border-right: 0;
  padding: 0.5em;
}

button {
  display: flex;
  border-radius: 0 .25em .25em 0;
  background-color: #007bff;
  border: 1px solid #007bff;
  padding: .5em;
  cursor: pointer;
  color: white;
}

button:hover {
  background-color: #0069d9;
  border-color: #0062cc;
}

a {
  color: #007bff;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h4 {
  margin-bottom: .5em;
}

table td {
  padding: 0.75em;
}

table tr:hover {
  background: #eee;
}

.year {
  display: table;
}

.month {
  display: table-cell;
  padding-right: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.nick {
  padding-right: 0.6rem;
  font-weight: bold;
  text-align: right;
  width: 13rem;
  display: table-cell;
}

.nick a {
  color: inherit;
  text-decoration: none;
}

.message {
  display: table-cell;
  padding-left: 0.6rem;
  border-left: 2px solid #333;
}

.notice {
  color: #859900;
  font-style: italic;
}

.line {
  line-height: 1.8rem;
  display: table;
}

#logs {
  margin-top: 1.5rem;
  padding: 1.5rem;
}
</style></head><body><h1>IRC channel logs</h1><h2>2023-01-22.log</h2><p><a href="/bootstrappable">back to list of logs</a></p><div id="logs"><div class="line" id="002052"><span class="nick" style="color:#389600"><a href="#002052" label="[00:20:52]">&lt;oriansj&gt;</a></span><span class="message">mihi: it has to do with an earlier version of blood-elf which incorrectly identified a label inside of a string literal.</span></div><div class="line" id="002140"><span class="nick" style="color:#389600"><a href="#002140" label="[00:21:40]">&lt;oriansj&gt;</a></span><span class="message">with resulted in a linking failure as the &quot; :foo&quot; might not have an actual :foo label for hex2 to link to</span></div><div class="line" id="002349"><span class="nick" style="color:#389600"><a href="#002349" label="[00:23:49]">&lt;oriansj&gt;</a></span><span class="message">^with^which^</span></div><div class="line" id="002405"><span class="nick" style="color:#8dd3c7"><a href="#002405" label="[00:24:05]">&lt;stikonas&gt;</a></span><span class="message">so I guess we no longer need it</span></div><div class="line" id="002516"><span class="nick" style="color:#2e2a4a"><a href="#002516" label="[00:25:16]">&lt;mihi&gt;</a></span><span class="message">oriansj, thanks. That makes sense. I tend to always forget that blood-elf exists...</span></div><div class="line" id="003443"><span class="nick" style="color:#389600"><a href="#003443" label="[00:34:43]">&lt;oriansj&gt;</a></span><span class="message">stikonas: well weird strings are still needed for cases such as &quot;\&quot;foo\&quot;&quot;</span></div><div class="line" id="003610"><span class="nick" style="color:#6b8072"><a href="#003610" label="[00:36:10]">&lt;stikonas[m]&gt;</a></span><span class="message">I see</span></div><div class="line" id="003650"><span class="nick" style="color:#6b8072"><a href="#003650" label="[00:36:50]">&lt;stikonas[m]&gt;</a></span><span class="message">And I've converted hex2_amd64 to new defines</span></div><div class="line" id="003701"><span class="nick" style="color:#389600"><a href="#003701" label="[00:37:01]">&lt;oriansj&gt;</a></span><span class="message">nice</span></div><div class="line" id="004424"><span class="nick" style="color:#389600"><a href="#004424" label="[00:44:24]">&lt;oriansj&gt;</a></span><span class="message">also I don't have sufficient confidence that issue is completely eliminated from blood-elf yet for all arbitrary inputs and leaving it doesn't really cause problems either.</span></div><div class="line" id="004630"><span class="nick" style="color:#8dd3c7"><a href="#004630" label="[00:46:30]">&lt;stikonas&gt;</a></span><span class="message">well, let's leave it...</span></div><div class="line" id="004637"><span class="nick" style="color:#8dd3c7"><a href="#004637" label="[00:46:37]">&lt;stikonas&gt;</a></span><span class="message">there are more important issues...</span></div><div class="line" id="012902"><span class="nick" style="color:#8dd3c7"><a href="#012902" label="[01:29:02]">&lt;stikonas&gt;</a></span><span class="message">hmm, so hex0_x86.S works correctly regarding return code but not the hex0.hex0 version</span></div><div class="line" id="012936"><span class="nick" style="color:#8dd3c7"><a href="#012936" label="[01:29:36]">&lt;stikonas&gt;</a></span><span class="message">doras: I guess I just need to sync whatever is in .S file to .hex0</span></div><div class="line" id="015335"><span class="nick" style="color:#8dd3c7"><a href="#015335" label="[01:53:35]">&lt;stikonas&gt;</a></span><span class="message">hmm, &quot;add register, label&quot; seems to mean different thing in NASM and GAS (intel syntax)</span></div><div class="line" id="015550"><span class="nick" style="color:#8dd3c7"><a href="#015550" label="[01:55:50]">&lt;stikonas&gt;</a></span><span class="message">not sure how to translate nasm syntax to something gas understands</span></div><div class="line" id="015937"><span class="nick" style="color:#80b1d3"><a href="#015937" label="[01:59:37]">&lt;doras&gt;</a></span><span class="message">I wish I could help :)</span></div><div class="line" id="020112"><span class="nick" style="color:#80b1d3"><a href="#020112" label="[02:01:12]">&lt;doras&gt;</a></span><span class="message">By the way, here's the MR that bootstraps freedesktop-sdk from our new binary seed which itself bootstraps from live-bootstrap's sysc: <a rel="nofollow" href="https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/merge_requests/11557">https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/merge_requests/11557</a> </span></div><div class="line" id="020135"><span class="nick" style="color:#80b1d3"><a href="#020135" label="[02:01:35]">&lt;doras&gt;</a></span><span class="message"> * By the way, here's the MR that modifies freedesktop-sdk to bootstraps from our new binary seed which itself bootstraps from live-bootstrap's sysc: <a rel="nofollow" href="https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/merge_requests/11557">https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/merge_requests/11557</a> </span></div><div class="line" id="020207"><span class="nick" style="color:#8dd3c7"><a href="#020207" label="[02:02:07]">&lt;stikonas&gt;</a></span><span class="message">maybe I should try to advertise it a bit more tomorrow...</span></div><div class="line" id="020217"><span class="nick" style="color:#8dd3c7"><a href="#020217" label="[02:02:17]">&lt;stikonas&gt;</a></span><span class="message">given that this affects flatpaks</span></div><div class="line" id="020228"><span class="nick" style="color:#8dd3c7"><a href="#020228" label="[02:02:28]">&lt;stikonas&gt;</a></span><span class="message">so might be appropriate for places like planetkde.org</span></div><div class="line" id="020326"><span class="nick" style="color:#8dd3c7"><a href="#020326" label="[02:03:26]">&lt;stikonas&gt;</a></span><span class="message">ok, you still have rust there...</span></div><div class="line" id="020401"><span class="nick" style="color:#80b1d3"><a href="#020401" label="[02:04:01]">&lt;doras&gt;</a></span><span class="message">Yes, Rust is not a solved matter unfortunately.</span></div><div class="line" id="020446"><span class="nick" style="color:#80b1d3"><a href="#020446" label="[02:04:46]">&lt;doras&gt;</a></span><span class="message">Maybe in a few more years when rust-gcc is more capable.</span></div><div class="line" id="020459"><span class="nick" style="color:#8dd3c7"><a href="#020459" label="[02:04:59]">&lt;stikonas&gt;</a></span><span class="message">well, there is mrustc...</span></div><div class="line" id="020505"><span class="nick" style="color:#8dd3c7"><a href="#020505" label="[02:05:05]">&lt;stikonas&gt;</a></span><span class="message">but that is more complicated</span></div><div class="line" id="020525"><span class="nick" style="color:#8dd3c7"><a href="#020525" label="[02:05:25]">&lt;stikonas&gt;</a></span><span class="message">and I'm also struggling with it a bit on Gentoo in my overlay</span></div><div class="line" id="020546"><span class="nick" style="color:#8dd3c7"><a href="#020546" label="[02:05:46]">&lt;stikonas&gt;</a></span><span class="message">though some of that might be my misundertanding of Portage</span></div><div class="line" id="020554"><span class="nick" style="color:#8dd3c7"><a href="#020554" label="[02:05:54]">&lt;stikonas&gt;</a></span><span class="message">I could build rustc 1.54 outside portage</span></div><div class="line" id="020610"><span class="nick" style="color:#8dd3c7"><a href="#020610" label="[02:06:10]">&lt;stikonas&gt;</a></span><span class="message">but something fails with error when I was running same commands in portage</span></div><div class="line" id="021316"><span class="nick" style="color:#80b1d3"><a href="#021316" label="[02:13:16]">&lt;doras&gt;</a></span><span class="message">stikonas: we want to be able to build Rust for all the architectures we can support at the moment (so x86-64, aarch64, riscv64, powerpc64le, i686, armv7). Can a bootstrap path starting with mrustc result in a native Rust toolchain for each of these architectures?</span></div><div class="line" id="021411"><span class="nick" style="color:#8dd3c7"><a href="#021411" label="[02:14:11]">&lt;stikonas&gt;</a></span><span class="message">you can cross-compile rust</span></div><div class="line" id="021420"><span class="nick" style="color:#8dd3c7"><a href="#021420" label="[02:14:20]">&lt;stikonas&gt;</a></span><span class="message">so yes, but it's not too simple</span></div><div class="line" id="021430"><span class="nick" style="color:#8dd3c7"><a href="#021430" label="[02:14:30]">&lt;stikonas&gt;</a></span><span class="message">at least it wasn't when I did it</span></div><div class="line" id="021458"><span class="nick" style="color:#8dd3c7"><a href="#021458" label="[02:14:58]">&lt;stikonas&gt;</a></span><span class="message">at some point cross-compiling needed building rust with nightly features enabled</span></div><div class="line" id="021504"><span class="nick" style="color:#8dd3c7"><a href="#021504" label="[02:15:04]">&lt;stikonas&gt;</a></span><span class="message">s/nightly/unstable/</span></div><div class="line" id="021525"><span class="nick" style="color:#8dd3c7"><a href="#021525" label="[02:15:25]">&lt;stikonas&gt;</a></span><span class="message">mrustc itself mostly tragets 64-bit arches</span></div><div class="line" id="021531"><span class="nick" style="color:#8dd3c7"><a href="#021531" label="[02:15:31]">&lt;stikonas&gt;</a></span><span class="message">it's very hard to build it on 32-bit systems</span></div><div class="line" id="021541"><span class="nick" style="color:#8dd3c7"><a href="#021541" label="[02:15:41]">&lt;stikonas&gt;</a></span><span class="message">(due to 3G memory limit)</span></div><div class="line" id="021631"><span class="nick" style="color:#8dd3c7"><a href="#021631" label="[02:16:31]">&lt;stikonas&gt;</a></span><span class="message">doras: and I can see the bug in kaem-optional</span></div><div class="line" id="021638"><span class="nick" style="color:#8dd3c7"><a href="#021638" label="[02:16:38]">&lt;stikonas&gt;</a></span><span class="message">it might be something introduced by me earlier...</span></div><div class="line" id="021710"><span class="nick" style="color:#8dd3c7"><a href="#021710" label="[02:17:10]">&lt;stikonas&gt;</a></span><span class="message">when trying to reduce its size :(</span></div><div class="line" id="021854"><span class="nick" style="color:#80b1d3"><a href="#021854" label="[02:18:54]">&lt;doras&gt;</a></span><span class="message">:(</span></div><div class="line" id="021917"><span class="nick" style="color:#80b1d3"><a href="#021917" label="[02:19:17]">&lt;doras&gt;</a></span><span class="message">Findings the bug is still good news, though :)</span></div><div class="line" id="022035"><span class="nick" style="color:#8dd3c7"><a href="#022035" label="[02:20:35]">&lt;stikonas&gt;</a></span><span class="message">yeah, the binary size will increase a bit :(</span></div><div class="line" id="022045"><span class="nick" style="color:#8dd3c7"><a href="#022045" label="[02:20:45]">&lt;stikonas&gt;</a></span><span class="message">but we shouldn't reduce it at the cost of bugs</span></div><div class="line" id="022121"><span class="nick" style="color:#8dd3c7"><a href="#022121" label="[02:21:21]">&lt;stikonas&gt;</a></span><span class="message">anyway, I'll fix it but still will take some time, maybe tomorrow</span></div><div class="line" id="022136"><span class="nick" style="color:#8dd3c7"><a href="#022136" label="[02:21:36]">&lt;stikonas&gt;</a></span><span class="message">it needs serious changes to .hex0...</span></div><div class="line" id="022145"><span class="nick" style="color:#8dd3c7"><a href="#022145" label="[02:21:45]">&lt;stikonas&gt;</a></span><span class="message">sicne jumps and offsets are now different</span></div><div class="line" id="022155"><span class="nick" style="color:#8dd3c7"><a href="#022155" label="[02:21:55]">&lt;stikonas&gt;</a></span><span class="message">and I might also change to GAS syntax at the same time...</span></div><div class="line" id="022250"><span class="nick" style="color:#80b1d3"><a href="#022250" label="[02:22:50]">&lt;doras&gt;</a></span><span class="message">Thanks for looking into it</span></div><div class="line" id="040958"><span class="nick" style="color:#6d2462"><a href="#040958" label="[04:09:58]">&lt;nektro&gt;</a></span><span class="message"> <a rel="nofollow" href="https://bpa.st/raw/IGNMO">https://bpa.st/raw/IGNMO</a>  does this error look familar, adapted from amd46/kaem.run + mescc-tools-extra.kaem</span></div><div class="line" id="045749"><span class="nick" style="color:#234e69"><a href="#045749" label="[04:57:49]">&lt;fossy&gt;</a></span><span class="message">no.. i've never seen that before</span></div><div class="line" id="045751"><span class="nick" style="color:#234e69"><a href="#045751" label="[04:57:51]">&lt;fossy&gt;</a></span><span class="message">what have you changed?</span></div><div class="line" id="051213"><span class="nick" style="color:#6d2462"><a href="#051213" label="[05:12:13]">&lt;nektro&gt;</a></span><span class="message">im not sure</span></div><div class="line" id="051232"><span class="nick" style="color:#6d2462"><a href="#051232" label="[05:12:32]">&lt;nektro&gt;</a></span><span class="message">the contents of the referenced M2-Planet-000000 file is <a rel="nofollow" href="https://clbin.com/hG829">https://clbin.com/hG829</a> </span></div><div class="line" id="051439"><span class="nick" style="color:#6d2462"><a href="#051439" label="[05:14:39]">&lt;nektro&gt;</a></span><span class="message">m2-mesoplanet file is <a rel="nofollow" href="https://clbin.com/Ib7FT">https://clbin.com/Ib7FT</a> </span></div><div class="line" id="051444"><span class="nick" style="color:#6c3d55"><a href="#051444" label="[05:14:44]">&lt;sam_&gt;</a></span><span class="message">stikonas[m]: yes, cross-compiling rust is often a pain</span></div><div class="line" id="051450"><span class="nick" style="color:#6c3d55"><a href="#051450" label="[05:14:50]">&lt;sam_&gt;</a></span><span class="message">stikonas[m]: also, please keep in mind you can ask me if you need to</span></div><div class="line" id="051455"><span class="nick" style="color:#6c3d55"><a href="#051455" label="[05:14:55]">&lt;sam_&gt;</a></span><span class="message">i may not always have the answers, ofc</span></div><div class="line" id="051457"><span class="nick" style="color:#6c3d55"><a href="#051457" label="[05:14:57]">&lt;sam_&gt;</a></span><span class="message">but happy to try</span></div><div class="line" id="052608"><span class="nick" style="color:#234e69"><a href="#052608" label="[05:26:08]">&lt;fossy&gt;</a></span><span class="message">gosh, gcc's abuse of autotools is an absolute mess</span></div><div class="line" id="052738"><span class="nick" style="color:#234e69"><a href="#052738" label="[05:27:38]">&lt;fossy&gt;</a></span><span class="message">autoreconf doesn't even pick up the existance of subdirectories</span></div><div class="line" id="052803"><span class="nick" style="color:#234e69"><a href="#052803" label="[05:28:03]">&lt;fossy&gt;</a></span><span class="message">and half of the scripts are broken with the supposed versions that are meant to be used</span></div><div class="line" id="052826"><span class="nick" style="color:#234e69"><a href="#052826" label="[05:28:26]">&lt;fossy&gt;</a></span><span class="message">so much for simplicity :\</span></div><div class="line" id="055109"><span class="nick" style="color:#389600"><a href="#055109" label="[05:51:09]">&lt;oriansj&gt;</a></span><span class="message">nektro: that error looks extremely familiar</span></div><div class="line" id="055342"><span class="nick" style="color:#389600"><a href="#055342" label="[05:53:42]">&lt;oriansj&gt;</a></span><span class="message">it simply means the file amd64_defs.M1 is lacking a DEFINE for mov_rax, (which if I remember correctly should be: DEFINE mov_rax, 48C7C0 )</span></div><div class="line" id="055447"><span class="nick" style="color:#389600"><a href="#055447" label="[05:54:47]">&lt;oriansj&gt;</a></span><span class="message">so you might be on the wrong M2libc commit</span></div><div class="line" id="055726"><span class="nick" style="color:#6d2462"><a href="#055726" label="[05:57:26]">&lt;nektro&gt;</a></span><span class="message">nice catch! i was on the latest commit of mescc-tools-extra but the M2libc submodule hasnt been pushed forward in 10 months according to github</span></div><div class="line" id="055752"><span class="nick" style="color:#6d2462"><a href="#055752" label="[05:57:52]">&lt;nektro&gt;</a></span><span class="message">checking my local amd64_defs.M1 that define is indeed missing</span></div><div class="line" id="060320"><span class="nick" style="color:#6c3d55"><a href="#060320" label="[06:03:20]">&lt;sam_&gt;</a></span><span class="message">fossy: yeah it's very frustrating</span></div><div class="line" id="060326"><span class="nick" style="color:#6c3d55"><a href="#060326" label="[06:03:26]">&lt;sam_&gt;</a></span><span class="message">none of it is idiomatic autoconf at all</span></div><div class="line" id="060337"><span class="nick" style="color:#6c3d55"><a href="#060337" label="[06:03:37]">&lt;sam_&gt;</a></span><span class="message">fossy: plus if you send any patches for it, nobody is really interested</span></div><div class="line" id="060343"><span class="nick" style="color:#6c3d55"><a href="#060343" label="[06:03:43]">&lt;sam_&gt;</a></span><span class="message">all the build system maintainers listed are long-gone too</span></div><div class="line" id="060413"><span class="nick" style="color:#6c3d55"><a href="#060413" label="[06:04:13]">&lt;sam_&gt;</a></span><span class="message">maybe bar one but we didn't get a reply from them</span></div><div class="line" id="060807"><span class="nick" style="color:#234e69"><a href="#060807" label="[06:08:07]">&lt;fossy&gt;</a></span><span class="message">can anyone think of any strange cases where there might be autotools generated files left around after doing:</span></div><div class="line" id="060814"><span class="nick" style="color:#234e69"><a href="#060814" label="[06:08:14]">&lt;fossy&gt;</a></span><span class="message">1. autoreconf on all dirs with configure</span></div><div class="line" id="060830"><span class="nick" style="color:#234e69"><a href="#060830" label="[06:08:30]">&lt;fossy&gt;</a></span><span class="message">2. automake on all dirs with soley Makefile.in</span></div><div class="line" id="061035"><span class="nick" style="color:#234e69"><a href="#061035" label="[06:10:35]">&lt;fossy&gt;</a></span><span class="message">sam_: this is the only substantative patch since they changed autoconf versions -_- <a rel="nofollow" href="https://gcc.gnu.org/git/?p=gcc.git;a=commit;h=25861cf3a88a07c8dca3fb32d098c0ad756bbe38">https://gcc.gnu.org/git/?p=gcc.git;a=commit;h=25861cf3a88a07c8dca3fb32d098c0ad756bbe38</a> </span></div><div class="line" id="061044"><span class="nick" style="color:#234e69"><a href="#061044" label="[06:10:44]">&lt;fossy&gt;</a></span><span class="message">(and i needed it, haha)</span></div><div class="line" id="115542"><span class="nick" style="color:#6b8072"><a href="#115542" label="[11:55:42]">&lt;stikonas[m]&gt;</a></span><span class="message">fossy: you might also need to run aclocal?</span></div><div class="line" id="121432"><span class="nick" style="color:#6b8072"><a href="#121432" label="[12:14:32]">&lt;stikonas[m]&gt;</a></span><span class="message">although maybe aclocal is correctly launched by autoreconf</span></div><div class="line" id="121452"><span class="nick" style="color:#6b8072"><a href="#121452" label="[12:14:52]">&lt;stikonas[m]&gt;</a></span><span class="message">so perhaps 1. and 2. is fine (plus rebuilding top-level gcc stuff with autogen)</span></div><div class="line" id="121546"><span class="nick" style="color:#6b8072"><a href="#121546" label="[12:15:46]">&lt;stikonas[m]&gt;</a></span><span class="message">fossy: another question is what backends are we building? So far only C and C++ are enabled</span></div><div class="line" id="121612"><span class="nick" style="color:#6b8072"><a href="#121612" label="[12:16:12]">&lt;stikonas[m]&gt;</a></span><span class="message">just keep it at that? Or do we need more?</span></div><div class="line" id="122340"><span class="nick" style="color:#80b1d3"><a href="#122340" label="[12:23:40]">&lt;doras&gt;</a></span><span class="message">For what's it worth, freedesktop-sdk only needs C/C++.</span></div><div class="line" id="122348"><span class="nick" style="color:#80b1d3"><a href="#122348" label="[12:23:48]">&lt;doras&gt;</a></span><span class="message">what it's*</span></div><div class="line" id="134746"><span class="nick" style="color:#8dd3c7"><a href="#134746" label="[13:47:46]">&lt;stikonas&gt;</a></span><span class="message">hmm, perhaps it's not possible to do what I want with intel syntax...</span></div><div class="line" id="134813"><span class="nick" style="color:#8dd3c7"><a href="#134813" label="[13:48:13]">&lt;stikonas&gt;</a></span><span class="message">so I was able to get required opcode with this in AT&amp;T syntax: mov $default_file, %ebx</span></div><div class="line" id="134919"><span class="nick" style="color:#8dd3c7"><a href="#134919" label="[13:49:19]">&lt;stikonas&gt;</a></span><span class="message">but if I use &quot;mov ebx, default_file&quot; in Intel syntax, it's the same as &quot;mov default_file, %ebx&quot; in AT&amp;T and uses &quot;8b 1c 25&quot; instead of &quot;bb&quot; opcode</span></div><div class="line" id="135448"><span class="nick" style="color:#389600"><a href="#135448" label="[13:54:48]">&lt;oriansj&gt;</a></span><span class="message">mov [default_file], ebx</span></div><div class="line" id="135746"><span class="nick" style="color:#8dd3c7"><a href="#135746" label="[13:57:46]">&lt;stikonas&gt;</a></span><span class="message">&quot;mov ebx, [default_file]&quot; also generates wrong opcode</span></div><div class="line" id="135814"><span class="nick" style="color:#8dd3c7"><a href="#135814" label="[13:58:14]">&lt;stikonas&gt;</a></span><span class="message">lea ebx, [default_file] generates even different opcode but it does have the right behaviour</span></div><div class="line" id="135842"><span class="nick" style="color:#8dd3c7"><a href="#135842" label="[13:58:42]">&lt;stikonas&gt;</a></span><span class="message">I tried disassembling it with objdump -M intel but it was not too helpful</span></div><div class="line" id="135903"><span class="nick" style="color:#8dd3c7"><a href="#135903" label="[13:59:03]">&lt;stikonas&gt;</a></span><span class="message">as it does not show label names, it just shows numbers</span></div><div class="line" id="135912"><span class="nick" style="color:#8dd3c7"><a href="#135912" label="[13:59:12]">&lt;stikonas&gt;</a></span><span class="message">good one was mov    ebx,0x804a000 and bad one was mov    ebx,DWORD PTR ds:0x804a000</span></div><div class="line" id="140250"><span class="nick" style="color:#389600"><a href="#140250" label="[14:02:50]">&lt;oriansj&gt;</a></span><span class="message">ds is using the data segment register; most code should be in the cs (code segment)</span></div><div class="line" id="140822"><span class="nick" style="color:#2e2a4a"><a href="#140822" label="[14:08:22]">&lt;mihi&gt;</a></span><span class="message">stikonas, I think you want &quot;mov ebx, OFFSET default_file&quot; (at least that was the syntax used with MASM)</span></div><div class="line" id="140846"><span class="nick" style="color:#6b8072"><a href="#140846" label="[14:08:46]">&lt;stikonas[m]&gt;</a></span><span class="message">Let me try that</span></div><div class="line" id="140911"><span class="nick" style="color:#389600"><a href="#140911" label="[14:09:11]">&lt;oriansj&gt;</a></span><span class="message">well there are only 3 encodings possible bb 00a00408, 8b 1d 00a00408 and 89 1d 00a00408</span></div><div class="line" id="140922"><span class="nick" style="color:#8dd3c7"><a href="#140922" label="[14:09:22]">&lt;stikonas&gt;</a></span><span class="message">mihi: thanks! it does work</span></div><div class="line" id="140934"><span class="nick" style="color:#2e2a4a"><a href="#140934" label="[14:09:34]">&lt;mihi&gt;</a></span><span class="message">you are welcome</span></div><div class="line" id="141624"><span class="nick" style="color:#8dd3c7"><a href="#141624" label="[14:16:24]">&lt;stikonas&gt;</a></span><span class="message">hmm, perhaps this will not affect .M1 file anyway</span></div><div class="line" id="141703"><span class="nick" style="color:#8dd3c7"><a href="#141703" label="[14:17:03]">&lt;stikonas&gt;</a></span><span class="message">in .S file I now have &quot;mov ebx, OFFSET default_file&quot; but for M1 syntax I think it will still be mov_ebx, &amp;default_file</span></div><div class="line" id="141804"><span class="nick" style="color:#8dd3c7"><a href="#141804" label="[14:18:04]">&lt;stikonas&gt;</a></span><span class="message">maybe I should have use AT&amp;T syntax for new defines, it's a bit more verbose and maps better to M1...</span></div><div class="line" id="174822"><span class="nick" style="color:#8dd3c7"><a href="#174822" label="[17:48:22]">&lt;stikonas&gt;</a></span><span class="message">doras: I have pushed fixed x86/kaem-minimal.hex0</span></div><div class="line" id="174845"><span class="nick" style="color:#8dd3c7"><a href="#174845" label="[17:48:45]">&lt;stikonas&gt;</a></span><span class="message">we still need to copy it to bootstrap seeds, and update stage-posix and live-bootstrap submodules before it works for you</span></div><div class="line" id="174852"><span class="nick" style="color:#8dd3c7"><a href="#174852" label="[17:48:52]">&lt;stikonas&gt;</a></span><span class="message">but those are easy</span></div><div class="line" id="174905"><span class="nick" style="color:#8dd3c7"><a href="#174905" label="[17:49:05]">&lt;stikonas&gt;</a></span><span class="message">also x86/kaem-minimal is now using new defines</span></div><div class="line" id="174931"><span class="nick" style="color:#8dd3c7"><a href="#174931" label="[17:49:31]">&lt;stikonas&gt;</a></span><span class="message">rickmasters: by the way, did you have any issues with curl checksum?</span></div><div class="line" id="175009"><span class="nick" style="color:#d9d9d9"><a href="#175009" label="[17:50:09]">&lt;rickmasters&gt;</a></span><span class="message">Sorry, not sure what you mean.</span></div><div class="line" id="175124"><span class="nick" style="color:#8dd3c7"><a href="#175124" label="[17:51:24]">&lt;stikonas&gt;</a></span><span class="message">on some older linux somehow curl in live-bootstrap was automatically disabling IPv6 support</span></div><div class="line" id="175217"><span class="nick" style="color:#8dd3c7"><a href="#175217" label="[17:52:17]">&lt;stikonas&gt;</a></span><span class="message">it's now fixed in live-bootstrap <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/commit/5f805e65f32ab6d10f47bdc4aa38f706cc7b87dc">https://github.com/fosslinux/live-bootstrap/commit/5f805e65f32ab6d10f47bdc4aa38f706cc7b87dc</a> </span></div><div class="line" id="175226"><span class="nick" style="color:#8dd3c7"><a href="#175226" label="[17:52:26]">&lt;stikonas&gt;</a></span><span class="message">but I wonder what was happening in fiwix</span></div><div class="line" id="175354"><span class="nick" style="color:#bc80bd"><a href="#175354" label="[17:53:54]">&lt;Mikaku&gt;</a></span><span class="message">stikonas: Fiwix don't has network support (yet)</span></div><div class="line" id="175356"><span class="nick" style="color:#d9d9d9"><a href="#175356" label="[17:53:56]">&lt;rickmasters&gt;</a></span><span class="message">Fiwix doesn't run curl, that's after linux boots.</span></div><div class="line" id="175539"><span class="nick" style="color:#8dd3c7"><a href="#175539" label="[17:55:39]">&lt;stikonas&gt;</a></span><span class="message">yes, we don't run it, just build it</span></div><div class="line" id="175557"><span class="nick" style="color:#8dd3c7"><a href="#175557" label="[17:55:57]">&lt;stikonas&gt;</a></span><span class="message">it was the building step that was not reproducible in live-bootstrap</span></div><div class="line" id="175639"><span class="nick" style="color:#8dd3c7"><a href="#175639" label="[17:56:39]">&lt;stikonas&gt;</a></span><span class="message">with older linux kernels it was disabling IPv6. Anyway, fixed by specifying --enable-ipv6</span></div><div class="line" id="175750"><span class="nick" style="color:#d9d9d9"><a href="#175750" label="[17:57:50]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: no, I didn't see that problem</span></div><div class="line" id="175909"><span class="nick" style="color:#d9d9d9"><a href="#175909" label="[17:59:09]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: if there was some (unnoticed) problem building it I suppose it could always be built after linux boots.</span></div><div class="line" id="180144"><span class="nick" style="color:#d9d9d9"><a href="#180144" label="[18:01:44]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: by the way, I disabled checksum checking in my development due to musl differences I've mentioned before.</span></div><div class="line" id="180205"><span class="nick" style="color:#8dd3c7"><a href="#180205" label="[18:02:05]">&lt;stikonas&gt;</a></span><span class="message">oh I see, then you indeed wouldn't have noticed it</span></div><div class="line" id="180408"><span class="nick" style="color:#d9d9d9"><a href="#180408" label="[18:04:08]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: Eventually I'm going to regenerate the checksums with my mods and test versus linux. I think there may be work remaining...</span></div><div class="line" id="190939"><span class="nick" style="color:#8dd3c7"><a href="#190939" label="[19:09:39]">&lt;stikonas&gt;</a></span><span class="message">oriansj: <a rel="nofollow" href="https://github.com/oriansj/bootstrap-seeds/pull/35">https://github.com/oriansj/bootstrap-seeds/pull/35</a> </span></div><div class="line" id="190958"><span class="nick" style="color:#8dd3c7"><a href="#190958" label="[19:09:58]">&lt;stikonas&gt;</a></span><span class="message">fixed exit code of kaem-optional that doras requested and also switched to new defines</span></div><div class="line" id="202212"><span class="nick" style="color:#80b1d3"><a href="#202212" label="[20:22:12]">&lt;doras&gt;</a></span><span class="message">stikonas @stikonas:libera.chat: great! Thanks!</span></div><br /></div></body></html>