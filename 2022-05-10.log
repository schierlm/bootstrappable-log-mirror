<!DOCTYPE html><html><head><title>IRC channel logs</title><style>html {
  background: #fdfdfd;
}

h1 {
  font-weight: 300;
}

h2 {
  font-weight: 200;
}

h3 {
  padding: .5em 0;
  border-top: 3px dotted #ddd;
  margin-bottom: 0;
}

form {
  width: 400px;
  display: flex;
}

input {
  width: 100%;
  display: flex;
  border-radius: .25em 0 0 .25em;
  border: 1px solid #aaa;
  border-right: 0;
  padding: 0.5em;
}

button {
  display: flex;
  border-radius: 0 .25em .25em 0;
  background-color: #007bff;
  border: 1px solid #007bff;
  padding: .5em;
  cursor: pointer;
  color: white;
}

button:hover {
  background-color: #0069d9;
  border-color: #0062cc;
}

a {
  color: #007bff;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h4 {
  margin-bottom: .5em;
}

table td {
  padding: 0.75em;
}

table tr:hover {
  background: #eee;
}

.year {
  display: table;
}

.month {
  display: table-cell;
  padding-right: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.nick {
  padding-right: 0.6rem;
  font-weight: bold;
  text-align: right;
  width: 13rem;
  display: table-cell;
}

.nick a {
  color: inherit;
  text-decoration: none;
}

.message {
  display: table-cell;
  padding-left: 0.6rem;
  border-left: 2px solid #333;
}

.notice {
  color: #859900;
  font-style: italic;
}

.line {
  line-height: 1.8rem;
  display: table;
}

#logs {
  margin-top: 1.5rem;
  padding: 1.5rem;
}
</style></head><body><h1>IRC channel logs</h1><h2>2022-05-10.log</h2><p><a href="/bootstrappable">back to list of logs</a></p><div id="logs"><div class="line" id="061242"><span class="nick" style="color:#8dd3c7"><a href="#061242" label="[06:12:42]">&lt;achaninja&gt;</a></span><span class="message">I made a bit of progress on my own alternate bootstrap</span></div><div class="line" id="061253"><span class="nick" style="color:#8dd3c7"><a href="#061253" label="[06:12:53]">&lt;achaninja&gt;</a></span><span class="message">I was able to build a working qbe and cproc c compiler</span></div><div class="line" id="061257"><span class="nick" style="color:#8dd3c7"><a href="#061257" label="[06:12:57]">&lt;achaninja&gt;</a></span><span class="message">or mostly working</span></div><div class="line" id="061307"><span class="nick" style="color:#8dd3c7"><a href="#061307" label="[06:13:07]">&lt;achaninja&gt;</a></span><span class="message">using tcc</span></div><div class="line" id="061409"><span class="nick" style="color:#8dd3c7"><a href="#061409" label="[06:14:09]">&lt;achaninja&gt;</a></span><span class="message">cproc is able to build a patched musl and patched gcc 4.7 and</span></div><div class="line" id="061424"><span class="nick" style="color:#8dd3c7"><a href="#061424" label="[06:14:24]">&lt;achaninja&gt;</a></span><span class="message">so in the end it might be a shorter bootstrap path</span></div><div class="line" id="061557"><span class="nick" style="color:#8dd3c7"><a href="#061557" label="[06:15:57]">&lt;achaninja&gt;</a></span><span class="message">though its only for arm64, riscv64 and x86_64 atm</span></div><div class="line" id="075511"><span class="nick" style="color:#8dd3c7"><a href="#075511" label="[07:55:11]">&lt;achaninja&gt;</a></span><span class="message">oriansj: why does the git tag Release_1.5 of stage0-posix have a version 1.3 of stage0 in it?</span></div><div class="line" id="075527"><span class="nick" style="color:#8dd3c7"><a href="#075527" label="[07:55:27]">&lt;achaninja&gt;</a></span><span class="message">I build it and do kaem --version and get 1.3</span></div><div class="line" id="091212"><span class="nick" style="color:#2e2a4a"><a href="#091212" label="[09:12:12]">&lt;fossy&gt;</a></span><span class="message">kernel is looking difficult ngl</span></div><div class="line" id="091302"><span class="nick" style="color:#2e2a4a"><a href="#091302" label="[09:13:02]">&lt;fossy&gt;</a></span><span class="message">markjenkinssksp: tinycc has quite a few problems for kernels iirc</span></div><div class="line" id="091434"><span class="nick" style="color:#2e2a4a"><a href="#091434" label="[09:14:34]">&lt;fossy&gt;</a></span><span class="message">achaninja: stage0-posix versions do not match mescc-tools versions which is where kaem is from</span></div><div class="line" id="091530"><span class="nick" style="color:#8dd3c7"><a href="#091530" label="[09:15:30]">&lt;achaninja&gt;</a></span><span class="message">that is really confusing, especially because the latest release of mescc wants a newer version of M2 than stage0 posix provides</span></div><div class="line" id="091552"><span class="nick" style="color:#2e2a4a"><a href="#091552" label="[09:15:52]">&lt;fossy&gt;</a></span><span class="message">hmm... are you sure about that?</span></div><div class="line" id="091556"><span class="nick" style="color:#8dd3c7"><a href="#091556" label="[09:15:56]">&lt;achaninja&gt;</a></span><span class="message">yes</span></div><div class="line" id="091557"><span class="nick" style="color:#2e2a4a"><a href="#091557" label="[09:15:57]">&lt;fossy&gt;</a></span><span class="message">we'</span></div><div class="line" id="091605"><span class="nick" style="color:#2e2a4a"><a href="#091605" label="[09:16:05]">&lt;fossy&gt;</a></span><span class="message">we're using latest stage0-posix and mes...</span></div><div class="line" id="091608"><span class="nick" style="color:#2e2a4a"><a href="#091608" label="[09:16:08]">&lt;fossy&gt;</a></span><span class="message">in live-bootstrap</span></div><div class="line" id="091617"><span class="nick" style="color:#8dd3c7"><a href="#091617" label="[09:16:17]">&lt;achaninja&gt;</a></span><span class="message">no you aren't</span></div><div class="line" id="091621"><span class="nick" style="color:#2e2a4a"><a href="#091621" label="[09:16:21]">&lt;fossy&gt;</a></span><span class="message">oh, we might be using head stage0-posix</span></div><div class="line" id="091638"><span class="nick" style="color:#8dd3c7"><a href="#091638" label="[09:16:38]">&lt;achaninja&gt;</a></span><span class="message">afaict you were using 0.23 mes</span></div><div class="line" id="091641"><span class="nick" style="color:#8dd3c7"><a href="#091641" label="[09:16:41]">&lt;achaninja&gt;</a></span><span class="message">not 0.24</span></div><div class="line" id="091646"><span class="nick" style="color:#8dd3c7"><a href="#091646" label="[09:16:46]">&lt;achaninja&gt;</a></span><span class="message">let me check</span></div><div class="line" id="091647"><span class="nick" style="color:#2e2a4a"><a href="#091647" label="[09:16:47]">&lt;fossy&gt;</a></span><span class="message">no, we updated a few days ago, stikonas[m] did it</span></div><div class="line" id="091658"><span class="nick" style="color:#8dd3c7"><a href="#091658" label="[09:16:58]">&lt;achaninja&gt;</a></span><span class="message">do you use the mescc configure script?</span></div><div class="line" id="091710"><span class="nick" style="color:#2e2a4a"><a href="#091710" label="[09:17:10]">&lt;fossy&gt;</a></span><span class="message">no, that doesn't run under kaem</span></div><div class="line" id="091716"><span class="nick" style="color:#8dd3c7"><a href="#091716" label="[09:17:16]">&lt;achaninja&gt;</a></span><span class="message">well that is why then</span></div><div class="line" id="091720"><span class="nick" style="color:#8dd3c7"><a href="#091720" label="[09:17:20]">&lt;achaninja&gt;</a></span><span class="message">the configure script fails</span></div><div class="line" id="091728"><span class="nick" style="color:#2e2a4a"><a href="#091728" label="[09:17:28]">&lt;fossy&gt;</a></span><span class="message">oh, well that's a bug</span></div><div class="line" id="091733"><span class="nick" style="color:#2e2a4a"><a href="#091733" label="[09:17:33]">&lt;fossy&gt;</a></span><span class="message">what are you running the configure script with?</span></div><div class="line" id="091809"><span class="nick" style="color:#8dd3c7"><a href="#091809" label="[09:18:09]">&lt;achaninja&gt;</a></span><span class="message">if you get the latest stage0-posix add it to PATH and run ./configure it will failt before you can do anything</span></div><div class="line" id="091820"><span class="nick" style="color:#8dd3c7"><a href="#091820" label="[09:18:20]">&lt;achaninja&gt;</a></span><span class="message">because it asks for a different version of M2 and hex</span></div><div class="line" id="091828"><span class="nick" style="color:#8dd3c7"><a href="#091828" label="[09:18:28]">&lt;achaninja&gt;</a></span><span class="message">fail*</span></div><div class="line" id="091850"><span class="nick" style="color:#2e2a4a"><a href="#091850" label="[09:18:50]">&lt;fossy&gt;</a></span><span class="message">i mean</span></div><div class="line" id="091856"><span class="nick" style="color:#2e2a4a"><a href="#091856" label="[09:18:56]">&lt;fossy&gt;</a></span><span class="message">how does one even use the configure script in a bootstrap</span></div><div class="line" id="091904"><span class="nick" style="color:#8dd3c7"><a href="#091904" label="[09:19:04]">&lt;achaninja&gt;</a></span><span class="message">im not using it in the bootstrap</span></div><div class="line" id="091907"><span class="nick" style="color:#2e2a4a"><a href="#091907" label="[09:19:07]">&lt;fossy&gt;</a></span><span class="message">oh ok</span></div><div class="line" id="091917"><span class="nick" style="color:#8dd3c7"><a href="#091917" label="[09:19:17]">&lt;achaninja&gt;</a></span><span class="message">also my bootstrap assumes the shell is trusted</span></div><div class="line" id="091925"><span class="nick" style="color:#8dd3c7"><a href="#091925" label="[09:19:25]">&lt;achaninja&gt;</a></span><span class="message">since I am aiming for something different</span></div><div class="line" id="091940"><span class="nick" style="color:#8dd3c7"><a href="#091940" label="[09:19:40]">&lt;achaninja&gt;</a></span><span class="message">live-bootstrap assumes kernel is trusted</span></div><div class="line" id="091952"><span class="nick" style="color:#8dd3c7"><a href="#091952" label="[09:19:52]">&lt;achaninja&gt;</a></span><span class="message">my one assumes kernel + a subset of userspace is trusted</span></div><div class="line" id="092028"><span class="nick" style="color:#8dd3c7"><a href="#092028" label="[09:20:28]">&lt;achaninja&gt;</a></span><span class="message">so technically I *could* use the configure script, though I am not</span></div><div class="line" id="092037"><span class="nick" style="color:#8dd3c7"><a href="#092037" label="[09:20:37]">&lt;achaninja&gt;</a></span><span class="message">especially if gash works with it</span></div><div class="line" id="092102"><span class="nick" style="color:#8dd3c7"><a href="#092102" label="[09:21:02]">&lt;achaninja&gt;</a></span><span class="message">however, it seems to be broken anyway</span></div><div class="line" id="092111"><span class="nick" style="color:#8dd3c7"><a href="#092111" label="[09:21:11]">&lt;achaninja&gt;</a></span><span class="message">at least with stage0-posix</span></div><div class="line" id="092225"><span class="nick" style="color:#2e2a4a"><a href="#092225" label="[09:22:25]">&lt;fossy&gt;</a></span><span class="message">ah ok, so more like guix, where guile/mes are trusted</span></div><div class="line" id="092259"><span class="nick" style="color:#8dd3c7"><a href="#092259" label="[09:22:59]">&lt;achaninja&gt;</a></span><span class="message">yeah my main purpose is to install software on any linux distro - assuming nothing about the host.</span></div><div class="line" id="092305"><span class="nick" style="color:#2e2a4a"><a href="#092305" label="[09:23:05]">&lt;fossy&gt;</a></span><span class="message">i see, that makes sense</span></div><div class="line" id="092306"><span class="nick" style="color:#8dd3c7"><a href="#092306" label="[09:23:06]">&lt;achaninja&gt;</a></span><span class="message">without downloading binaries</span></div><div class="line" id="092336"><span class="nick" style="color:#8dd3c7"><a href="#092336" label="[09:23:36]">&lt;achaninja&gt;</a></span><span class="message">but I can and should have a way to cross check with livebootstrap</span></div><div class="line" id="092354"><span class="nick" style="color:#2e2a4a"><a href="#092354" label="[09:23:54]">&lt;fossy&gt;</a></span><span class="message">after the part where the paths diverge the checksums wont be the same and that sok</span></div><div class="line" id="092431"><span class="nick" style="color:#8dd3c7"><a href="#092431" label="[09:24:31]">&lt;achaninja&gt;</a></span><span class="message">I can run my scripts from within livebootstrap and cross check the result</span></div><div class="line" id="092444"><span class="nick" style="color:#2e2a4a"><a href="#092444" label="[09:24:44]">&lt;fossy&gt;</a></span><span class="message">oh, of course</span></div><div class="line" id="092445"><span class="nick" style="color:#8dd3c7"><a href="#092445" label="[09:24:45]">&lt;achaninja&gt;</a></span><span class="message">its a longer chain, but its a way to double check it</span></div><div class="line" id="092525"><span class="nick" style="color:#8dd3c7"><a href="#092525" label="[09:25:25]">&lt;achaninja&gt;</a></span><span class="message">I'm currently just manually installing the mescc.in and mescc.scm.in</span></div><div class="line" id="092534"><span class="nick" style="color:#8dd3c7"><a href="#092534" label="[09:25:34]">&lt;achaninja&gt;</a></span><span class="message">hmm</span></div><div class="line" id="092555"><span class="nick" style="color:#8dd3c7"><a href="#092555" label="[09:25:55]">&lt;achaninja&gt;</a></span><span class="message">but its good news that livebootstrap uses 0.24 with stage0-posix since it shows it still works</span></div><div class="line" id="092606"><span class="nick" style="color:#8dd3c7"><a href="#092606" label="[09:26:06]">&lt;achaninja&gt;</a></span><span class="message">even if the configure script rejects it</span></div><div class="line" id="092753"><span class="nick" style="color:#8dd3c7"><a href="#092753" label="[09:27:53]">&lt;achaninja&gt;</a></span><span class="message">fossy: thanks for the reassurance :)</span></div><div class="line" id="094105"><span class="nick" style="color:#8dd3c7"><a href="#094105" label="[09:41:05]">&lt;achaninja&gt;</a></span><span class="message">ok success it seems</span></div><div class="line" id="094126"><span class="nick" style="color:#8dd3c7"><a href="#094126" label="[09:41:26]">&lt;achaninja&gt;</a></span><span class="message">I manually installed mescc without the configure scripts etc</span></div><div class="line" id="094133"><span class="nick" style="color:#8dd3c7"><a href="#094133" label="[09:41:33]">&lt;achaninja&gt;</a></span><span class="message">and it seems to be running</span></div><div class="line" id="095819"><span class="nick" style="color:#6b8072"><a href="#095819" label="[09:58:19]">&lt;doras&gt;</a></span><span class="message">As far as I can tell, something is broken with the qemu script.</span></div><div class="line" id="095831"><span class="nick" style="color:#6b8072"><a href="#095831" label="[09:58:31]">&lt;doras&gt;</a></span><span class="message">It doesn't actually create a partition on the loop device.</span></div><div class="line" id="095949"><span class="nick">***</span><span class="message notice">civodul` is now known as civodul</span></div><div class="line" id="122244"><span class="nick" style="color:#2e2a4a"><a href="#122244" label="[12:22:44]">&lt;fossy&gt;</a></span><span class="message">doras: hmm, it should, does your diff touch lib/*.py?</span></div><div class="line" id="123613"><span class="nick" style="color:#80b1d3"><a href="#123613" label="[12:36:13]">&lt;ekaitz&gt;</a></span><span class="message">hi all, does anyone know what's the process of calling as from gcc? I have my backported gcc to riscv &quot;working&quot; but when calling as it's setting the options wrong</span></div><div class="line" id="123631"><span class="nick" style="color:#80b1d3"><a href="#123631" label="[12:36:31]">&lt;ekaitz&gt;</a></span><span class="message">instead of -k -march=rv64gc it's doing -k-march=rv64gc</span></div><div class="line" id="123648"><span class="nick" style="color:#80b1d3"><a href="#123648" label="[12:36:48]">&lt;ekaitz&gt;</a></span><span class="message">can anyone help me find where does that come from?</span></div><div class="line" id="125732"><span class="nick" style="color:#6d2462"><a href="#125732" label="[12:57:32]">&lt;janneke&gt;</a></span><span class="message">ekaitz: doesn't that show when you run gcc -v?</span></div><div class="line" id="125905"><span class="nick" style="color:#6d2462"><a href="#125905" label="[12:59:05]">&lt;janneke&gt;</a></span><span class="message">you may want to look at &quot;gcc -dumpspecs&quot; too</span></div><div class="line" id="130011"><span class="nick" style="color:#6d2462"><a href="#130011" label="[13:00:11]">&lt;janneke&gt;</a></span><span class="message">ekaitz: also see: <a rel="nofollow" href="https://gcc.gnu.org/wiki/DebuggingGCC">https://gcc.gnu.org/wiki/DebuggingGCC</a> </span></div><div class="line" id="130054"><span class="nick" style="color:#80b1d3"><a href="#130054" label="[13:00:54]">&lt;ekaitz&gt;</a></span><span class="message">ok thanks!</span></div><div class="line" id="130116"><span class="nick" style="color:#80b1d3"><a href="#130116" label="[13:01:16]">&lt;ekaitz&gt;</a></span><span class="message">i run it like gcc -v and it has shown me the as call it does</span></div><div class="line" id="130140"><span class="nick" style="color:#80b1d3"><a href="#130140" label="[13:01:40]">&lt;ekaitz&gt;</a></span><span class="message">the wrong one :)</span></div><div class="line" id="130147"><span class="nick" style="color:#80b1d3"><a href="#130147" label="[13:01:47]">&lt;ekaitz&gt;</a></span><span class="message">but what I need to know is where is it set to be like that and why</span></div><div class="line" id="144703"><span class="nick" style="color:#80b1d3"><a href="#144703" label="[14:47:03]">&lt;ekaitz&gt;</a></span><span class="message">OH i catched it!</span></div><div class="line" id="144711"><span class="nick" style="color:#80b1d3"><a href="#144711" label="[14:47:11]">&lt;ekaitz&gt;</a></span><span class="message">thanks to -dumpspecs</span></div><div class="line" id="144736"><span class="nick" style="color:#6d2462"><a href="#144736" label="[14:47:36]">&lt;janneke&gt;</a></span><span class="message">\o=</span></div><div class="line" id="144741"><span class="nick" style="color:#80b1d3"><a href="#144741" label="[14:47:41]">&lt;ekaitz&gt;</a></span><span class="message">in the define ASM_SPEC I was missing a space before of the newline</span></div><div class="line" id="144747"><span class="nick" style="color:#80b1d3"><a href="#144747" label="[14:47:47]">&lt;ekaitz&gt;</a></span><span class="message">something like fpic...-k\</span></div><div class="line" id="144751"><span class="nick" style="color:#80b1d3"><a href="#144751" label="[14:47:51]">&lt;ekaitz&gt;</a></span><span class="message">and it was -k \</span></div><div class="line" id="144753"><span class="nick" style="color:#6d2462"><a href="#144753" label="[14:47:53]">&lt;janneke&gt;</a></span><span class="message">nice</span></div><div class="line" id="144816"><span class="nick" style="color:#80b1d3"><a href="#144816" label="[14:48:16]">&lt;ekaitz&gt;</a></span><span class="message">omg thanks to the heaven that I found it</span></div><div class="line" id="144822"><span class="nick" style="color:#80b1d3"><a href="#144822" label="[14:48:22]">&lt;ekaitz&gt;</a></span><span class="message">i could spend 3 years looking for this</span></div><div class="line" id="144849"><span class="nick" style="color:#234e69"><a href="#144849" label="[14:48:49]">&lt;Hagfish&gt;</a></span><span class="message">heh, yeah, i think that developer experience is underrated as a goal for most projects</span></div><div class="line" id="144903"><span class="nick" style="color:#234e69"><a href="#144903" label="[14:49:03]">&lt;Hagfish&gt;</a></span><span class="message">having the right debug tools can pay for themselves in time saved</span></div><div class="line" id="144938"><span class="nick" style="color:#80b1d3"><a href="#144938" label="[14:49:38]">&lt;ekaitz&gt;</a></span><span class="message">this one is a really hard one, gcc has many weird things like this</span></div><div class="line" id="145058"><span class="nick" style="color:#234e69"><a href="#145058" label="[14:50:58]">&lt;Hagfish&gt;</a></span><span class="message">i guess it's a problem like AI, where you want the system to expose its internal logic (and flaws) in a human-meaningful way</span></div><div class="line" id="145116"><span class="nick" style="color:#80b1d3"><a href="#145116" label="[14:51:16]">&lt;ekaitz&gt;</a></span><span class="message">yesterday i spent the whole day looking to the build process because it was iterating over a list and ended with an empty value</span></div><div class="line" id="145133"><span class="nick" style="color:#234e69"><a href="#145133" label="[14:51:33]">&lt;Hagfish&gt;</a></span><span class="message">that does sound mysterious</span></div><div class="line" id="145136"><span class="nick" style="color:#80b1d3"><a href="#145136" label="[14:51:36]">&lt;ekaitz&gt;</a></span><span class="message">and it was because it was appending to an empty variable instead of rewriting</span></div><div class="line" id="145141"><span class="nick" style="color:#234e69"><a href="#145141" label="[14:51:41]">&lt;Hagfish&gt;</a></span><span class="message">oof</span></div><div class="line" id="145147"><span class="nick" style="color:#80b1d3"><a href="#145147" label="[14:51:47]">&lt;ekaitz&gt;</a></span><span class="message">makefile magic</span></div><div class="line" id="145210"><span class="nick" style="color:#234e69"><a href="#145210" label="[14:52:10]">&lt;Hagfish&gt;</a></span><span class="message">yeah, all magic needs a verbose equivalent</span></div><div class="line" id="145214"><span class="nick" style="color:#80b1d3"><a href="#145214" label="[14:52:14]">&lt;ekaitz&gt;</a></span><span class="message">this kind of things are a pain in the butt</span></div><div class="line" id="160356"><span class="nick">***</span><span class="message notice">lukedashjr is now known as luke-jr</span></div><div class="line" id="211120"><span class="nick" style="color:#6b8072"><a href="#211120" label="[21:11:20]">&lt;doras&gt;</a></span><span class="message">fossy: it doesn't.</span></div><div class="line" id="211148"><span class="nick" style="color:#6b8072"><a href="#211148" label="[21:11:48]">&lt;doras&gt;</a></span><span class="message">The loop device doesn't have a &quot;p1&quot;.</span></div><div class="line" id="212643"><span class="nick" style="color:#6b8072"><a href="#212643" label="[21:26:43]">&lt;doras&gt;</a></span><span class="message">I found the issue. The losetup command was missing a required argument (-P).</span></div><div class="line" id="212942"><span class="nick">***</span><span class="message notice">lukedashjr is now known as luke-jr</span></div><div class="line" id="213724"><span class="nick" style="color:#6c3d55"><a href="#213724" label="[21:37:24]">&lt;stikonas&gt;</a></span><span class="message">doras: can you make a PR with the fix?</span></div><div class="line" id="213737"><span class="nick" style="color:#6b8072"><a href="#213737" label="[21:37:37]">&lt;doras&gt;</a></span><span class="message">Yes, submitting in a minute.</span></div><div class="line" id="213906"><span class="nick" style="color:#6c3d55"><a href="#213906" label="[21:39:06]">&lt;stikonas&gt;</a></span><span class="message">achaninja: you probably would still have to go via quite a bit of steps even with cproc</span></div><div class="line" id="213914"><span class="nick" style="color:#6c3d55"><a href="#213914" label="[21:39:14]">&lt;stikonas&gt;</a></span><span class="message">lots of steps are independent of compiler</span></div><div class="line" id="213936"><span class="nick" style="color:#6c3d55"><a href="#213936" label="[21:39:36]">&lt;stikonas&gt;</a></span><span class="message">at least if you do no-prebuilt file bootstrap</span></div><div class="line" id="214026"><span class="nick" style="color:#6b8072"><a href="#214026" label="[21:40:26]">&lt;doras&gt;</a></span><span class="message"> <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/pull/158">https://github.com/fosslinux/live-bootstrap/pull/158</a> </span></div><div class="line" id="214027"><span class="nick" style="color:#6c3d55"><a href="#214027" label="[21:40:27]">&lt;stikonas&gt;</a></span><span class="message">we need to build autotools, perl, bison, flex</span></div><div class="line" id="214821"><span class="nick" style="color:#6c3d55"><a href="#214821" label="[21:48:21]">&lt;stikonas&gt;</a></span><span class="message">just that ends up to be about 35 steps in parts.rst</span></div><div class="line" id="214937"><span class="nick" style="color:#d9d9d9"><a href="#214937" label="[21:49:37]">&lt;rkeene&gt;</a></span><span class="message">Ick, Perl</span></div><div class="line" id="215036"><span class="nick" style="color:#d9d9d9"><a href="#215036" label="[21:50:36]">&lt;rkeene&gt;</a></span><span class="message">That one is hard to build because cross-compiling it is terrible</span></div><div class="line" id="215434"><span class="nick" style="color:#bc80bd"><a href="#215434" label="[21:54:34]">&lt;stikonas[m]&gt;</a></span><span class="message">rkeene: it was not too bad...</span></div><div class="line" id="215507"><span class="nick" style="color:#bc80bd"><a href="#215507" label="[21:55:07]">&lt;stikonas[m]&gt;</a></span><span class="message">Certainly not very pleasant but better than initially expected</span></div><div class="line" id="215519"><span class="nick" style="color:#3c5b35"><a href="#215519" label="[21:55:19]">&lt;muurkha&gt;</a></span><span class="message">Congratulations.  You're not using Eunice.</span></div><div class="line" id="215733"><span class="nick" style="color:#bc80bd"><a href="#215733" label="[21:57:33]">&lt;stikonas[m]&gt;</a></span><span class="message"> <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/tree/master/sysa/perl-5.000">https://github.com/fosslinux/live-bootstrap/tree/master/sysa/perl-5.000</a> </span></div><div class="line" id="215840"><span class="nick" style="color:#bc80bd"><a href="#215840" label="[21:58:40]">&lt;stikonas[m]&gt;</a></span><span class="message">And a few iterations of newer and newer versions of Perl...</span></div><div class="line" id="220040"><span class="nick" style="color:#d9d9d9"><a href="#220040" label="[22:00:40]">&lt;rkeene&gt;</a></span><span class="message">stikonas[m], It requires SSH or serial access to the target system -- there's a patch to add support for a GNU autoconf build that's sane, but it's a PITA</span></div><div class="line" id="220905"><span class="nick" style="color:#bc80bd"><a href="#220905" label="[22:09:05]">&lt;stikonas[m]&gt;</a></span><span class="message">rkeene: we don't use Perl's build system or autoconf to build perl</span></div><div class="line" id="220934"><span class="nick" style="color:#bc80bd"><a href="#220934" label="[22:09:34]">&lt;stikonas[m]&gt;</a></span><span class="message">Even if it's added to the latest version, that's not good for bootsrapping</span></div><div class="line" id="221013"><span class="nick" style="color:#bc80bd"><a href="#221013" label="[22:10:13]">&lt;stikonas[m]&gt;</a></span><span class="message">As perl needs perl to rebuild some files in tarball</span></div><div class="line" id="221544"><span class="nick" style="color:#d9d9d9"><a href="#221544" label="[22:15:44]">&lt;rkeene&gt;</a></span><span class="message">Ah -- I just didn't use Perl at all in my system because it was so obnoxious</span></div><div class="line" id="222436"><span class="nick" style="color:#6c3d55"><a href="#222436" label="[22:24:36]">&lt;stikonas&gt;</a></span><span class="message">rkeene: well, autotools uses perl</span></div><div class="line" id="222501"><span class="nick" style="color:#6c3d55"><a href="#222501" label="[22:25:01]">&lt;stikonas&gt;</a></span><span class="message">so actually even if perl switches to autotools, that's a circular dependency (might be weak circular dependency but still)</span></div><div class="line" id="222704"><span class="nick" style="color:#6c3d55"><a href="#222704" label="[22:27:04]">&lt;stikonas&gt;</a></span><span class="message">automake is writen in perl and newer autoconfs are also written in perl (older ones use shell)</span></div><div class="line" id="223748"><span class="nick" style="color:#6b8072"><a href="#223748" label="[22:37:48]">&lt;doras&gt;</a></span><span class="message">&quot;xbps-create: ERROR: architecture not set!&quot;</span></div><div class="line" id="223825"><span class="nick" style="color:#6c3d55"><a href="#223825" label="[22:38:25]">&lt;stikonas&gt;</a></span><span class="message">when installing automake 1.16.4?</span></div><div class="line" id="223831"><span class="nick" style="color:#6c3d55"><a href="#223831" label="[22:38:31]">&lt;stikonas&gt;</a></span><span class="message">1.16.3?</span></div><div class="line" id="223857"><span class="nick" style="color:#6b8072"><a href="#223857" label="[22:38:57]">&lt;doras&gt;</a></span><span class="message">The line above it is &quot;automake-1.16.3: creating package.&quot;</span></div><div class="line" id="223910"><span class="nick" style="color:#6c3d55"><a href="#223910" label="[22:39:10]">&lt;stikonas&gt;</a></span><span class="message">hmm, we call xbps-create -A &quot;${ARCH}&quot; -n &quot;${pkg}_${revision}&quot; -s &quot;${pkg}&quot; --compression xz &quot;${DESTDIR}&quot;</span></div><div class="line" id="223931"><span class="nick" style="color:#6b8072"><a href="#223931" label="[22:39:31]">&lt;doras&gt;</a></span><span class="message">What sets ARCH?</span></div><div class="line" id="224000"><span class="nick" style="color:#6b8072"><a href="#224000" label="[22:40:00]">&lt;doras&gt;</a></span><span class="message">It's not in live-bootstrap.</span></div><div class="line" id="224041"><span class="nick" style="color:#6c3d55"><a href="#224041" label="[22:40:41]">&lt;stikonas&gt;</a></span><span class="message">good question...</span></div><div class="line" id="224100"><span class="nick" style="color:#6c3d55"><a href="#224100" label="[22:41:00]">&lt;stikonas&gt;</a></span><span class="message">we do set it in early bootstrap but it probably wouldn't propagate to sysc</span></div><div class="line" id="224244"><span class="nick" style="color:#6b8072"><a href="#224244" label="[22:42:44]">&lt;doras&gt;</a></span><span class="message">Looks like it doesn't.</span></div><div class="line" id="224303"><span class="nick" style="color:#6b8072"><a href="#224303" label="[22:43:03]">&lt;doras&gt;</a></span><span class="message">Wait, maybe it's my fault.</span></div><div class="line" id="224305"><span class="nick" style="color:#6c3d55"><a href="#224305" label="[22:43:05]">&lt;stikonas&gt;</a></span><span class="message">yeah, but why does it even work for me</span></div><div class="line" id="224341"><span class="nick" style="color:#6c3d55"><a href="#224341" label="[22:43:41]">&lt;stikonas&gt;</a></span><span class="message">well, for early bootstrap it is set here <a rel="nofollow" href="https://github.com/oriansj/stage0-posix-x86/blob/f70bf49424a97e2ebe7457e59c8be1a8c770299e/kaem.run#L23">https://github.com/oriansj/stage0-posix-x86/blob/f70bf49424a97e2ebe7457e59c8be1a8c770299e/kaem.run#L23</a> </span></div><div class="line" id="224411"><span class="nick" style="color:#6b8072"><a href="#224411" label="[22:44:11]">&lt;doras&gt;</a></span><span class="message">ARCH is read from bootstrap.cfg, and I forgot that I made a change to simplify something there.</span></div><div class="line" id="224434"><span class="nick" style="color:#6c3d55"><a href="#224434" label="[22:44:34]">&lt;stikonas&gt;</a></span><span class="message">oh, ok, that's how it propagates</span></div><div class="line" id="224509"><span class="nick" style="color:#6b8072"><a href="#224509" label="[22:45:09]">&lt;doras&gt;</a></span><span class="message">Basically I don't want to EXPORT it.</span></div><div class="line" id="224517"><span class="nick" style="color:#6c3d55"><a href="#224517" label="[22:45:17]">&lt;stikonas&gt;</a></span><span class="message">yeah, it's set in sysa/run.sh</span></div><div class="line" id="224520"><span class="nick" style="color:#6b8072"><a href="#224520" label="[22:45:20]">&lt;doras&gt;</a></span><span class="message">Not sure why I used capitals there.</span></div><div class="line" id="224538"><span class="nick" style="color:#6b8072"><a href="#224538" label="[22:45:38]">&lt;doras&gt;</a></span><span class="message">Because then it pollutes the build environment of every single package.</span></div><div class="line" id="224610"><span class="nick" style="color:#6b8072"><a href="#224610" label="[22:46:10]">&lt;doras&gt;</a></span><span class="message">There seems to be XBPS_TARGET_ARCH in the code which specifically exports it for xbps, but this variable is unused.</span></div><div class="line" id="224623"><span class="nick" style="color:#6b8072"><a href="#224623" label="[22:46:23]">&lt;doras&gt;</a></span><span class="message">So I'll just use it.</span></div><div class="line" id="224716"><span class="nick" style="color:#6c3d55"><a href="#224716" label="[22:47:16]">&lt;stikonas&gt;</a></span><span class="message">well, you could rename ARCH to something else</span></div><div class="line" id="224736"><span class="nick" style="color:#6c3d55"><a href="#224736" label="[22:47:36]">&lt;stikonas&gt;</a></span><span class="message">but a lot of early packages are poluted with env variables anyway</span></div><div class="line" id="224817"><span class="nick" style="color:#6c3d55"><a href="#224817" label="[22:48:17]">&lt;stikonas&gt;</a></span><span class="message">all early kaem variables propagate early in the bootstrap</span></div><div class="line" id="224826"><span class="nick" style="color:#6b8072"><a href="#224826" label="[22:48:26]">&lt;doras&gt;</a></span><span class="message">Well, it's mostly a nice addition. I also want to use boostrap.cfg in sysa and sysc as-is without needing to add &quot;export&quot; to every line.</span></div><div class="line" id="224911"><span class="nick" style="color:#6c3d55"><a href="#224911" label="[22:49:11]">&lt;stikonas&gt;</a></span><span class="message">do we add export to every line?</span></div><div class="line" id="224920"><span class="nick" style="color:#6b8072"><a href="#224920" label="[22:49:20]">&lt;doras&gt;</a></span><span class="message">Yeah</span></div><div class="line" id="224945"><span class="nick" style="color:#6b8072"><a href="#224945" label="[22:49:45]">&lt;doras&gt;</a></span><span class="message"> <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/blob/master/sysa/run.sh#L101">https://github.com/fosslinux/live-bootstrap/blob/master/sysa/run.sh#L101</a> </span></div><div class="line" id="225022"><span class="nick" style="color:#6c3d55"><a href="#225022" label="[22:50:22]">&lt;stikonas&gt;</a></span><span class="message">oh ok</span></div><div class="line" id="225113"><span class="nick" style="color:#6b8072"><a href="#225113" label="[22:51:13]">&lt;doras&gt;</a></span><span class="message">I think it's better to keep these variables local to scripts where they are actually used, rather than export it to the entire bootstrap. It also means we can skip this additional processing.</span></div><div class="line" id="225119"><span class="nick" style="color:#6b8072"><a href="#225119" label="[22:51:19]">&lt;doras&gt;</a></span><span class="message">They are actually rarely used.</span></div><div class="line" id="225206"><span class="nick" style="color:#6c3d55"><a href="#225206" label="[22:52:06]">&lt;stikonas&gt;</a></span><span class="message">yeah, I agree about keeping things local</span></div><div class="line" id="225218"><span class="nick" style="color:#6c3d55"><a href="#225218" label="[22:52:18]">&lt;stikonas&gt;</a></span><span class="message">we should also switch more variables in helper.sh to local ones</span></div><div class="line" id="225329"><span class="nick" style="color:#6b8072"><a href="#225329" label="[22:53:29]">&lt;doras&gt;</a></span><span class="message">Actually, it seems that helpers.sh does have &quot;. bootstrap.cfg&quot;, so it should have its ARCH variable set...</span></div><div class="line" id="225341"><span class="nick" style="color:#6b8072"><a href="#225341" label="[22:53:41]">&lt;doras&gt;</a></span><span class="message">sysa/helpers.sh, I mean</span></div><div class="line" id="225352"><span class="nick" style="color:#6c3d55"><a href="#225352" label="[22:53:52]">&lt;stikonas&gt;</a></span><span class="message">yes, that's why I was surprised that we export them</span></div><div class="line" id="225419"><span class="nick" style="color:#6c3d55"><a href="#225419" label="[22:54:19]">&lt;stikonas&gt;</a></span><span class="message">maybe you can just remove export and it will work</span></div><div class="line" id="225724"><span class="nick" style="color:#6b8072"><a href="#225724" label="[22:57:24]">&lt;doras&gt;</a></span><span class="message">Oh, that's odd. It seems that my bootstrap.cfg is missing ARCH.</span></div><div class="line" id="225742"><span class="nick" style="color:#6c3d55"><a href="#225742" label="[22:57:42]">&lt;stikonas&gt;</a></span><span class="message">doras: ARCH variable is added on that L101 that you gave me</span></div><div class="line" id="225750"><span class="nick" style="color:#6c3d55"><a href="#225750" label="[22:57:50]">&lt;stikonas&gt;</a></span><span class="message">it's not present in initial bootstrap.cfg</span></div><div class="line" id="225801"><span class="nick" style="color:#6b8072"><a href="#225801" label="[22:58:01]">&lt;doras&gt;</a></span><span class="message">Yeah, that explains it.</span></div><div class="line" id="225804"><span class="nick" style="color:#6c3d55"><a href="#225804" label="[22:58:04]">&lt;stikonas&gt;</a></span><span class="message">that is intentional</span></div><div class="line" id="225808"><span class="nick" style="color:#6b8072"><a href="#225808" label="[22:58:08]">&lt;doras&gt;</a></span><span class="message">I removed that part intentionally.</span></div><div class="line" id="225815"><span class="nick" style="color:#6c3d55"><a href="#225815" label="[22:58:15]">&lt;stikonas&gt;</a></span><span class="message">because ARCH is already set in stage0-posix</span></div><div class="line" id="225825"><span class="nick" style="color:#6b8072"><a href="#225825" label="[22:58:25]">&lt;doras&gt;</a></span><span class="message">Yeah</span></div><div class="line" id="225831"><span class="nick" style="color:#6c3d55"><a href="#225831" label="[22:58:31]">&lt;stikonas&gt;</a></span><span class="message">and setting it in two places is confusing</span></div><div class="line" id="225857"><span class="nick" style="color:#6b8072"><a href="#225857" label="[22:58:57]">&lt;doras&gt;</a></span><span class="message">So I'll only add it to the bootstrap.cfg, I guess.</span></div><div class="line" id="225905"><span class="nick" style="color:#6c3d55"><a href="#225905" label="[22:59:05]">&lt;stikonas&gt;</a></span><span class="message">ok, that's explains why xbps failed</span></div><div class="line" id="225909"><span class="nick" style="color:#6c3d55"><a href="#225909" label="[22:59:09]">&lt;stikonas&gt;</a></span><span class="message">your ARCH was empty</span></div><div class="line" id="225956"><span class="nick" style="color:#6c3d55"><a href="#225956" label="[22:59:56]">&lt;stikonas&gt;</a></span><span class="message">on a separate note, xbps packages seem quite nice as one can unpack them with just tar/xz</span></div><div class="line" id="230146"><span class="nick" style="color:#6b8072"><a href="#230146" label="[23:01:46]">&lt;doras&gt;</a></span><span class="message">Yeah, this is the explanation :)</span></div><div class="line" id="230231"><span class="nick" style="color:#6b8072"><a href="#230231" label="[23:02:31]">&lt;doras&gt;</a></span><span class="message">Also, another strange thing I just noticed, it seems DISK is added twice to bootstrap.cfg</span></div><div class="line" id="230249"><span class="nick" style="color:#6b8072"><a href="#230249" label="[23:02:49]">&lt;doras&gt;</a></span><span class="message">Once by rootfs.py, and again by sysb/run.sh</span></div><div class="line" id="230346"><span class="nick" style="color:#6b8072"><a href="#230346" label="[23:03:46]">&lt;doras&gt;</a></span><span class="message">Does the QEMU build go though sysb? If so, it explains why I only noticed it now.</span></div><div class="line" id="230356"><span class="nick" style="color:#6c3d55"><a href="#230356" label="[23:03:56]">&lt;stikonas&gt;</a></span><span class="message">doras: I think that was intentional</span></div><div class="line" id="230407"><span class="nick" style="color:#6c3d55"><a href="#230407" label="[23:04:07]">&lt;stikonas&gt;</a></span><span class="message">qemu build does go through sysb</span></div><div class="line" id="230427"><span class="nick" style="color:#6c3d55"><a href="#230427" label="[23:04:27]">&lt;stikonas&gt;</a></span><span class="message">but DISK might be unset, especially if you bootstrap on real HW</span></div><div class="line" id="230438"><span class="nick" style="color:#6c3d55"><a href="#230438" label="[23:04:38]">&lt;stikonas&gt;</a></span><span class="message">and then sysb will interactively ask you what disk you want to use</span></div><div class="line" id="230503"><span class="nick" style="color:#6b8072"><a href="#230503" label="[23:05:03]">&lt;doras&gt;</a></span><span class="message">Can't we only set if it's not already set though?</span></div><div class="line" id="230511"><span class="nick" style="color:#6c3d55"><a href="#230511" label="[23:05:11]">&lt;stikonas&gt;</a></span><span class="message">and if I remember correctly, fossy just thought it's simpler to set it unconditionally</span></div><div class="line" id="230516"><span class="nick" style="color:#6b8072"><a href="#230516" label="[23:05:16]">&lt;doras&gt;</a></span><span class="message">only set it*</span></div><div class="line" id="230524"><span class="nick" style="color:#6c3d55"><a href="#230524" label="[23:05:24]">&lt;stikonas&gt;</a></span><span class="message">you can ask fossy again</span></div><div class="line" id="230539"><span class="nick" style="color:#6c3d55"><a href="#230539" label="[23:05:39]">&lt;stikonas&gt;</a></span><span class="message">but I think I might have asked about that before</span></div><div class="line" id="230630"><span class="nick" style="color:#6b8072"><a href="#230630" label="[23:06:30]">&lt;doras&gt;</a></span><span class="message">fossy: I think there can be two cases here: either DISK was set in bootstrap.cfg and then we don't prompt about in sysb, or it isn't set and we do prompt about it. Only in the latter case it makes sense to add it to bootstrap.cfg, otherwise we have it twice there.</span></div><div class="line" id="230632"><span class="nick" style="color:#6c3d55"><a href="#230632" label="[23:06:32]">&lt;stikonas&gt;</a></span><span class="message">doras: sysb is used when kernel is built</span></div><div class="line" id="230734"><span class="nick" style="color:#6b8072"><a href="#230734" label="[23:07:34]">&lt;doras&gt;</a></span><span class="message">fossy: it's not harmful or anything, but it's a bit strange. I can remove it if you agree that it's not necessary (I'm already making changes around bootstrap.cfg).</span></div><div class="line" id="230845"><span class="nick" style="color:#6b8072"><a href="#230845" label="[23:08:45]">&lt;doras&gt;</a></span><span class="message">I will be removing its &quot;export&quot;, so I'll be touching that line anyway :)</span></div><br /></div></body></html>