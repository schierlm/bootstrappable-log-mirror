<!DOCTYPE html><html><head><title>IRC channel logs</title><style>html {
  background: #fdfdfd;
}

h1 {
  font-weight: 300;
}

h2 {
  font-weight: 200;
}

h3 {
  padding: .5em 0;
  border-top: 3px dotted #ddd;
  margin-bottom: 0;
}

form {
  width: 400px;
  display: flex;
}

input {
  width: 100%;
  display: flex;
  border-radius: .25em 0 0 .25em;
  border: 1px solid #aaa;
  border-right: 0;
  padding: 0.5em;
}

button {
  display: flex;
  border-radius: 0 .25em .25em 0;
  background-color: #007bff;
  border: 1px solid #007bff;
  padding: .5em;
  cursor: pointer;
  color: white;
}

button:hover {
  background-color: #0069d9;
  border-color: #0062cc;
}

a {
  color: #007bff;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h4 {
  margin-bottom: .5em;
}

table td {
  padding: 0.75em;
}

table tr:hover {
  background: #eee;
}

.year {
  display: table;
}

.month {
  display: table-cell;
  padding-right: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.nick {
  padding-right: 0.6rem;
  font-weight: bold;
  text-align: right;
  width: 13rem;
  display: table-cell;
}

.nick a {
  color: inherit;
  text-decoration: none;
}

.message {
  display: table-cell;
  padding-left: 0.6rem;
  border-left: 2px solid #333;
}

.notice {
  color: #859900;
  font-style: italic;
}

.line {
  line-height: 1.8rem;
  display: table;
}

#logs {
  margin-top: 1.5rem;
  padding: 1.5rem;
}
</style></head><body><h1>IRC channel logs</h1><h2>2024-02-05.log</h2><p><a href="/bootstrappable">back to list of logs</a></p><div id="logs"><div class="line" id="000028"><span class="nick" style="color:#389600"><a href="#000028" label="[00:00:28]">&lt;oriansj&gt;</a></span><span class="message">yeah, sadly I missed the talk but it looks like it would have been another good one.</span></div><div class="line" id="000401"><span class="nick" style="color:#8dd3c7"><a href="#000401" label="[00:04:01]">&lt;stikonas&gt;</a></span><span class="message">oriansj: there will be recording later</span></div><div class="line" id="000723"><span class="nick" style="color:#8dd3c7"><a href="#000723" label="[00:07:23]">&lt;stikonas&gt;</a></span><span class="message">hmm, just found some interesting data point about posix-runner failure when running mes-m2 (probably not mes-m2 specifically but mes-m2 uses fair amount of memory)</span></div><div class="line" id="000822"><span class="nick" style="color:#8dd3c7"><a href="#000822" label="[00:08:22]">&lt;stikonas&gt;</a></span><span class="message">after multiple invocations, eventually kaem was failing to cleanup up some memory after mes-m2 process existed</span></div><div class="line" id="000838"><span class="nick" style="color:#8dd3c7"><a href="#000838" label="[00:08:38]">&lt;stikonas&gt;</a></span><span class="message">e.g. it could be 30 successful runs of mes-m2 before failure</span></div><div class="line" id="000855"><span class="nick" style="color:#8dd3c7"><a href="#000855" label="[00:08:55]">&lt;stikonas&gt;</a></span><span class="message">turns out that number depends on amount of RAM...</span></div><div class="line" id="000904"><span class="nick" style="color:#8dd3c7"><a href="#000904" label="[00:09:04]">&lt;stikonas&gt;</a></span><span class="message">so I must be leaking some memory somehow...</span></div><div class="line" id="001625"><span class="nick" style="color:#2e2a4a"><a href="#001625" label="[00:16:25]">&lt;Googulator&gt;</a></span><span class="message">Alright - with builder-hex0 fixed, I did reach Linux build in Fiwix</span></div><div class="line" id="001641"><span class="nick" style="color:#2e2a4a"><a href="#001641" label="[00:16:41]">&lt;Googulator&gt;</a></span><span class="message">And /boot/fiwix exists</span></div><div class="line" id="001730"><span class="nick" style="color:#8dd3c7"><a href="#001730" label="[00:17:30]">&lt;stikonas&gt;</a></span><span class="message">Googulator: nice!</span></div><div class="line" id="001854"><span class="nick" style="color:#2e2a4a"><a href="#001854" label="[00:18:54]">&lt;Googulator&gt;</a></span><span class="message">fiwix_file_list.txt exists in this run, but wasn't used - as shown by the fact that /boot/fiwix is not on the list</span></div><div class="line" id="001959"><span class="nick" style="color:#2e2a4a"><a href="#001959" label="[00:19:59]">&lt;Googulator&gt;</a></span><span class="message">and yet, it does exist in the real FS</span></div><div class="line" id="002114"><span class="nick" style="color:#2e2a4a"><a href="#002114" label="[00:21:14]">&lt;Googulator&gt;</a></span><span class="message">but something is clearly still wrong - packages aren't getting installed properly</span></div><div class="line" id="002329"><span class="nick" style="color:#6b8072"><a href="#002329" label="[00:23:29]">&lt;rickmasters&gt;</a></span><span class="message">With live-bootstrap cloned 45 minutes ago, kernel bootstrap mode fails for me on libtool-2.2.4.</span></div><div class="line" id="002344"><span class="nick" style="color:#6b8072"><a href="#002344" label="[00:23:44]">&lt;rickmasters&gt;</a></span><span class="message">libtool-2.2.4: compiling source.</span></div><div class="line" id="002349"><span class="nick" style="color:#6b8072"><a href="#002349" label="[00:23:49]">&lt;rickmasters&gt;</a></span><span class="message">make: *** No targets specified and no makefile found.  Stop.</span></div><div class="line" id="002432"><span class="nick" style="color:#6b8072"><a href="#002432" label="[00:24:32]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: We're you able to get recent code working or were you working on older version?</span></div><div class="line" id="002501"><span class="nick" style="color:#8dd3c7"><a href="#002501" label="[00:25:01]">&lt;stikonas&gt;</a></span><span class="message">rickmasters: hmm, at the very least bwrap mode works</span></div><div class="line" id="002539"><span class="nick" style="color:#6b8072"><a href="#002539" label="[00:25:39]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: It's just kernel bootstrap</span></div><div class="line" id="002546"><span class="nick" style="color:#8dd3c7"><a href="#002546" label="[00:25:46]">&lt;stikonas&gt;</a></span><span class="message">yeah, I understand...</span></div><div class="line" id="002600"><span class="nick" style="color:#8dd3c7"><a href="#002600" label="[00:26:00]">&lt;stikonas&gt;</a></span><span class="message">ideally we need to bisect it</span></div><div class="line" id="002613"><span class="nick" style="color:#8dd3c7"><a href="#002613" label="[00:26:13]">&lt;stikonas&gt;</a></span><span class="message">but fossy didn't update fiwix-file-list</span></div><div class="line" id="002639"><span class="nick" style="color:#8dd3c7"><a href="#002639" label="[00:26:39]">&lt;stikonas&gt;</a></span><span class="message">so it will still refer to m4-1.4.7 instead of 1.4.10...</span></div><div class="line" id="002642"><span class="nick" style="color:#6b8072"><a href="#002642" label="[00:26:42]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: that part was fixed, I saw</span></div><div class="line" id="002700"><span class="nick" style="color:#8dd3c7"><a href="#002700" label="[00:27:00]">&lt;stikonas&gt;</a></span><span class="message">yeah, I fixed it, but just saying that bisect will need cherry-picking that</span></div><div class="line" id="002704"><span class="nick" style="color:#8dd3c7"><a href="#002704" label="[00:27:04]">&lt;stikonas&gt;</a></span><span class="message">for each bisect test...</span></div><div class="line" id="002844"><span class="nick" style="color:#6b8072"><a href="#002844" label="[00:28:44]">&lt;rickmasters&gt;</a></span><span class="message">I can bisect. I was just wondering whether Googulator got it working or if that separate work on removing file list maintenance that started from a working repo</span></div><div class="line" id="002903"><span class="nick" style="color:#8dd3c7"><a href="#002903" label="[00:29:03]">&lt;stikonas&gt;</a></span><span class="message">oh, that's good point</span></div><div class="line" id="002925"><span class="nick" style="color:#2e2a4a"><a href="#002925" label="[00:29:25]">&lt;Googulator&gt;</a></span><span class="message">It wasn't started from a known working base, so you could well be running into the same issue without the fiwix initrd changes</span></div><div class="line" id="002926"><span class="nick" style="color:#8dd3c7"><a href="#002926" label="[00:29:26]">&lt;stikonas&gt;</a></span><span class="message">if Googulator did reach Linux</span></div><div class="line" id="002930"><span class="nick" style="color:#2e2a4a"><a href="#002930" label="[00:29:30]">&lt;Googulator&gt;</a></span><span class="message">I did not</span></div><div class="line" id="002938"><span class="nick" style="color:#2e2a4a"><a href="#002938" label="[00:29:38]">&lt;Googulator&gt;</a></span><span class="message">well, I did reach Linux build</span></div><div class="line" id="002943"><span class="nick" style="color:#2e2a4a"><a href="#002943" label="[00:29:43]">&lt;Googulator&gt;</a></span><span class="message">but I'm running with --interactive</span></div><div class="line" id="003006"><span class="nick" style="color:#2e2a4a"><a href="#003006" label="[00:30:06]">&lt;Googulator&gt;</a></span><span class="message">which has a bug related to checksum validation</span></div><div class="line" id="003018"><span class="nick" style="color:#2e2a4a"><a href="#003018" label="[00:30:18]">&lt;Googulator&gt;</a></span><span class="message">because set -E doesn't work in bash-2.05b</span></div><div class="line" id="003033"><span class="nick" style="color:#2e2a4a"><a href="#003033" label="[00:30:33]">&lt;Googulator&gt;</a></span><span class="message">we use set -E instead of set -e with --interactive</span></div><div class="line" id="003314"><span class="nick" style="color:#2e2a4a"><a href="#003314" label="[00:33:14]">&lt;Googulator&gt;</a></span><span class="message">alright, can confirm - libtool is missing</span></div><div class="line" id="003348"><span class="nick" style="color:#6b8072"><a href="#003348" label="[00:33:48]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: Sorry, not sure what you mean. You skipped it interactively?</span></div><div class="line" id="003427"><span class="nick" style="color:#2e2a4a"><a href="#003427" label="[00:34:27]">&lt;Googulator&gt;</a></span><span class="message">It threw an error, but because --interactive has broken error handling in the early bash, it continued on without hitting the trap</span></div><div class="line" id="003555"><span class="nick" style="color:#6b8072"><a href="#003555" label="[00:35:55]">&lt;rickmasters&gt;</a></span><span class="message">Ok. Interesting. I thought stikonas said bash-2.05b pass1 didn't support interactive at all so maybe that will be trouble.</span></div><div class="line" id="003611"><span class="nick" style="color:#8dd3c7"><a href="#003611" label="[00:36:11]">&lt;stikonas&gt;</a></span><span class="message">rickmasters: Googulator worked around it</span></div><div class="line" id="003622"><span class="nick" style="color:#8dd3c7"><a href="#003622" label="[00:36:22]">&lt;stikonas&gt;</a></span><span class="message">with some clever traps</span></div><div class="line" id="003659"><span class="nick" style="color:#8dd3c7"><a href="#003659" label="[00:36:59]">&lt;stikonas&gt;</a></span><span class="message">but yes, you need newer bash for full features error handling</span></div><div class="line" id="003722"><span class="nick" style="color:#2e2a4a"><a href="#003722" label="[00:37:22]">&lt;Googulator&gt;</a></span><span class="message">I emulate interactivity by doing bash -c '$(cat)' in a loop, basically</span></div><div class="line" id="003736"><span class="nick" style="color:#2e2a4a"><a href="#003736" label="[00:37:36]">&lt;Googulator&gt;</a></span><span class="message">a bash REPL if you wish</span></div><div class="line" id="003802"><span class="nick" style="color:#2e2a4a"><a href="#003802" label="[00:38:02]">&lt;Googulator&gt;</a></span><span class="message">the problem is that &quot;set -E&quot; silently fails in this version of bash</span></div><div class="line" id="003832"><span class="nick" style="color:#6b8072"><a href="#003832" label="[00:38:32]">&lt;rickmasters&gt;</a></span><span class="message">ok, thanks for the update. that's very interesting.</span></div><div class="line" id="003833"><span class="nick" style="color:#2e2a4a"><a href="#003833" label="[00:38:33]">&lt;Googulator&gt;</a></span><span class="message">so the error trap that replaces the &quot;just exit and let the kernel panic&quot; behavior in interactive mode fails to propagate to shell functions</span></div><div class="line" id="003943"><span class="nick" style="color:#6b8072"><a href="#003943" label="[00:39:43]">&lt;rickmasters&gt;</a></span><span class="message">As a side note, I was working on something similar. I was able to get the bash-2.05b pass2.sh to work on fiwix right after libtool-2.2.4.</span></div><div class="line" id="004000"><span class="nick" style="color:#6b8072"><a href="#004000" label="[00:40:00]">&lt;rickmasters&gt;</a></span><span class="message">I also got it to handle a trap and go into interactive mode.</span></div><div class="line" id="004012"><span class="nick" style="color:#2e2a4a"><a href="#004012" label="[00:40:12]">&lt;Googulator&gt;</a></span><span class="message">That helps with getting interactivity without hacks, but unfortunately not with trap propagation</span></div><div class="line" id="004021"><span class="nick" style="color:#2e2a4a"><a href="#004021" label="[00:40:21]">&lt;Googulator&gt;</a></span><span class="message">we need at least bash 3.0 for that, possibly 3.2</span></div><div class="line" id="004038"><span class="nick" style="color:#6b8072"><a href="#004038" label="[00:40:38]">&lt;rickmasters&gt;</a></span><span class="message">But, if we can get pass1.sh to do that then that would be better.</span></div><div class="line" id="004054"><span class="nick" style="color:#2e2a4a"><a href="#004054" label="[00:40:54]">&lt;Googulator&gt;</a></span><span class="message">also, there are other issues with the pass1 bash</span></div><div class="line" id="004102"><span class="nick" style="color:#2e2a4a"><a href="#004102" label="[00:41:02]">&lt;Googulator&gt;</a></span><span class="message">broken globbing on certain kernels</span></div><div class="line" id="004114"><span class="nick" style="color:#2e2a4a"><a href="#004114" label="[00:41:14]">&lt;Googulator&gt;</a></span><span class="message">including the WSL one</span></div><div class="line" id="004212"><span class="nick" style="color:#8dd3c7"><a href="#004212" label="[00:42:12]">&lt;stikonas&gt;</a></span><span class="message">Googulator: do you know if that's meslibc issue?</span></div><div class="line" id="004224"><span class="nick" style="color:#8dd3c7"><a href="#004224" label="[00:42:24]">&lt;stikonas&gt;</a></span><span class="message">might be interesting to try to rebuild same bash with musl</span></div><div class="line" id="004225"><span class="nick" style="color:#2e2a4a"><a href="#004225" label="[00:42:25]">&lt;Googulator&gt;</a></span><span class="message">hmm, it could be</span></div><div class="line" id="004230"><span class="nick" style="color:#8dd3c7"><a href="#004230" label="[00:42:30]">&lt;stikonas&gt;</a></span><span class="message">and see whether that fixes it</span></div><div class="line" id="004231"><span class="nick" style="color:#6b8072"><a href="#004231" label="[00:42:31]">&lt;rickmasters&gt;</a></span><span class="message">So, I triggered interactive mode by installing a trap in an `improve:` script and then put an error in the next package's configure script.</span></div><div class="line" id="004254"><span class="nick" style="color:#6b8072"><a href="#004254" label="[00:42:54]">&lt;rickmasters&gt;</a></span><span class="message">Is that trap propagation?</span></div><div class="line" id="004300"><span class="nick" style="color:#2e2a4a"><a href="#004300" label="[00:43:00]">&lt;Googulator&gt;</a></span><span class="message">no</span></div><div class="line" id="004341"><span class="nick" style="color:#2e2a4a"><a href="#004341" label="[00:43:41]">&lt;Googulator&gt;</a></span><span class="message">normally, if you do &quot;set -e&quot;, then any error in that shell process, including inside a shell function, will cause the shell to quit</span></div><div class="line" id="004426"><span class="nick" style="color:#2e2a4a"><a href="#004426" label="[00:44:26]">&lt;Googulator&gt;</a></span><span class="message">you can trap that quitting with a &quot;trap &lt;cmd&gt; EXIT&quot;, but then there's no way to cancel the exit from within the trap environment - by the time the trap is hit, the shell has committed to quitting</span></div><div class="line" id="004504"><span class="nick" style="color:#2e2a4a"><a href="#004504" label="[00:45:04]">&lt;Googulator&gt;</a></span><span class="message">so I use &quot;trap &lt;cmd&gt; ERR&quot; instead, which is *meant* to trigger in any scenario where &quot;set -e&quot; would quit</span></div><div class="line" id="004613"><span class="nick" style="color:#2e2a4a"><a href="#004613" label="[00:46:13]">&lt;Googulator&gt;</a></span><span class="message">unfortunately ksh had a bug where &quot;trap &lt;cmd&gt; ERR&quot; would fail to trigger if the failure occurred in a shell function, and Bash chose to emulate that by default, since some legacy shell scripts rely on the broken behavior</span></div><div class="line" id="004700"><span class="nick" style="color:#6b8072"><a href="#004700" label="[00:47:00]">&lt;rickmasters&gt;</a></span><span class="message">Sorry I'm dense, but if you've spawned a new shell on a trap with `bash -i` are you in a new trap environment and if so why go back to the parent which is committed to quitting?</span></div><div class="line" id="004700"><span class="nick" style="color:#2e2a4a"><a href="#004700" label="[00:47:00]">&lt;Googulator&gt;</a></span><span class="message">so you need to either use &quot;set -E&quot;, or run bash with &quot;-E&quot; to allow ERR traps to behave the way you would expect based on &quot;set -e&quot;</span></div><div class="line" id="004753"><span class="nick" style="color:#2e2a4a"><a href="#004753" label="[00:47:53]">&lt;Googulator&gt;</a></span><span class="message">because one of the use cases for the trap is fixing whatever failed, manually rerunning the relevant build, and then typing &quot;exit&quot; to let the bootstrap continue as if nothing happened</span></div><div class="line" id="004804"><span class="nick" style="color:#6b8072"><a href="#004804" label="[00:48:04]">&lt;rickmasters&gt;</a></span><span class="message">ok</span></div><div class="line" id="004852"><span class="nick" style="color:#6b8072"><a href="#004852" label="[00:48:52]">&lt;rickmasters&gt;</a></span><span class="message">thanks, that makes sense.</span></div><div class="line" id="004855"><span class="nick" style="color:#2e2a4a"><a href="#004855" label="[00:48:55]">&lt;Googulator&gt;</a></span><span class="message">IIRC bash-2.05 was the version that introduced the ksh emulation behavior, not realizing it needs an opt-out</span></div><div class="line" id="004906"><span class="nick" style="color:#2e2a4a"><a href="#004906" label="[00:49:06]">&lt;Googulator&gt;</a></span><span class="message">the opt-out was added in 3.0</span></div><div class="line" id="004913"><span class="nick" style="color:#2e2a4a"><a href="#004913" label="[00:49:13]">&lt;Googulator&gt;</a></span><span class="message">but was apparently buggy until 3.2</span></div><div class="line" id="005029"><span class="nick" style="color:#6b8072"><a href="#005029" label="[00:50:29]">&lt;rickmasters&gt;</a></span><span class="message">Well, ultimately I was hoping to get bash 5.2 working right after libtool-2.2.4 but it might be a lot harder on Fiwix.</span></div><div class="line" id="005056"><span class="nick" style="color:#6b8072"><a href="#005056" label="[00:50:56]">&lt;rickmasters&gt;</a></span><span class="message">I started with bash-2.05b to get my feet wet and was able to figure that out but it was hard.</span></div><div class="line" id="005112"><span class="nick" style="color:#2e2a4a"><a href="#005112" label="[00:51:12]">&lt;Googulator&gt;</a></span><span class="message">I'm hoping to replace 2.05b with 3.2 entirely</span></div><div class="line" id="005127"><span class="nick" style="color:#2e2a4a"><a href="#005127" label="[00:51:27]">&lt;Googulator&gt;</a></span><span class="message">or 3.0 with &quot;set -E&quot; fixes backported</span></div><div class="line" id="005152"><span class="nick" style="color:#2e2a4a"><a href="#005152" label="[00:51:52]">&lt;Googulator&gt;</a></span><span class="message">&amp; then we will have to do a rebuild of that version immediately after autoconf-2.52 is built</span></div><div class="line" id="005208"><span class="nick" style="color:#2e2a4a"><a href="#005208" label="[00:52:08]">&lt;Googulator&gt;</a></span><span class="message">because the globbing bug hits in the next step, which is automake-1.6.3</span></div><div class="line" id="005232"><span class="nick" style="color:#2e2a4a"><a href="#005232" label="[00:52:32]">&lt;Googulator&gt;</a></span><span class="message">luckily autoconf-2.52 is all that's needed to regenerate the configure script in bash 3.x</span></div><div class="line" id="005240"><span class="nick" style="color:#6b8072"><a href="#005240" label="[00:52:40]">&lt;rickmasters&gt;</a></span><span class="message">OK, well not sure how far you got with bash 3 but bison was segfaulting for me and I had to partially implement mremap in Fiwix to get around it.</span></div><div class="line" id="005308"><span class="nick" style="color:#389600"><a href="#005308" label="[00:53:08]">&lt;oriansj&gt;</a></span><span class="message">ok, I have unxz.c into a form that M2-Planet can compile</span></div><div class="line" id="005323"><span class="nick" style="color:#2e2a4a"><a href="#005323" label="[00:53:23]">&lt;Googulator&gt;</a></span><span class="message">Was there any other error in the libtool build before the no makefile one?</span></div><div class="line" id="005327"><span class="nick" style="color:#8dd3c7"><a href="#005327" label="[00:53:27]">&lt;stikonas&gt;</a></span><span class="message">oriansj: congratulations!</span></div><div class="line" id="005338"><span class="nick" style="color:#2e2a4a"><a href="#005338" label="[00:53:38]">&lt;Googulator&gt;</a></span><span class="message">oriansj: congrats indeed, great news!</span></div><div class="line" id="005351"><span class="nick" style="color:#389600"><a href="#005351" label="[00:53:51]">&lt;oriansj&gt;</a></span><span class="message">not yet, as it still is segfaulting when being run</span></div><div class="line" id="005407"><span class="nick" style="color:#389600"><a href="#005407" label="[00:54:07]">&lt;oriansj&gt;</a></span><span class="message">so the pointer math needs tweaking</span></div><div class="line" id="005414"><span class="nick" style="color:#389600"><a href="#005414" label="[00:54:14]">&lt;oriansj&gt;</a></span><span class="message">not sure on the fix yet.</span></div><div class="line" id="005423"><span class="nick" style="color:#8dd3c7"><a href="#005423" label="[00:54:23]">&lt;stikonas&gt;</a></span><span class="message">yeah, that's the tricky thing with M2...</span></div><div class="line" id="005424"><span class="nick" style="color:#6b8072"><a href="#005424" label="[00:54:24]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: /bootstrap: line 91: xargs: command not found</span></div><div class="line" id="005428"><span class="nick" style="color:#389600"><a href="#005428" label="[00:54:28]">&lt;oriansj&gt;</a></span><span class="message">but I'll add it to the repo as a prototype</span></div><div class="line" id="005437"><span class="nick" style="color:#2e2a4a"><a href="#005437" label="[00:54:37]">&lt;Googulator&gt;</a></span><span class="message">hmm, xargs?</span></div><div class="line" id="005439"><span class="nick" style="color:#6b8072"><a href="#005439" label="[00:54:39]">&lt;rickmasters&gt;</a></span><span class="message">./bootstrap: line 89: find: command not found</span></div><div class="line" id="005443"><span class="nick" style="color:#8dd3c7"><a href="#005443" label="[00:54:43]">&lt;stikonas&gt;</a></span><span class="message">xargs is part of findutils</span></div><div class="line" id="005502"><span class="nick" style="color:#389600"><a href="#005502" label="[00:55:02]">&lt;oriansj&gt;</a></span><span class="message">and give everyone who wants a chance to fix it; while I fuzz it to find where the segfaults are</span></div><div class="line" id="005546"><span class="nick" style="color:#2e2a4a"><a href="#005546" label="[00:55:46]">&lt;Googulator&gt;</a></span><span class="message">wtf, findutils isn't meant to be built until well after libtool</span></div><div class="line" id="005548"><span class="nick" style="color:#6b8072"><a href="#005548" label="[00:55:48]">&lt;rickmasters&gt;</a></span><span class="message">actually I see those errors on linux too so false alarm</span></div><div class="line" id="005550"><span class="nick" style="color:#2e2a4a"><a href="#005550" label="[00:55:50]">&lt;Googulator&gt;</a></span><span class="message">per manifest</span></div><div class="line" id="005735"><span class="nick" style="color:#389600"><a href="#005735" label="[00:57:35]">&lt;oriansj&gt;</a></span><span class="message">and it is pushed into mescc-tools-extra</span></div><div class="line" id="005752"><span class="nick" style="color:#6b8072"><a href="#005752" label="[00:57:52]">&lt;rickmasters&gt;</a></span><span class="message">oriansj: nice work</span></div><div class="line" id="005908"><span class="nick" style="color:#389600"><a href="#005908" label="[00:59:08]">&lt;oriansj&gt;</a></span><span class="message">well Googulator pointed me in the right direction; I just did some refactoring ^_^</span></div><div class="line" id="005954"><span class="nick" style="color:#6b8072"><a href="#005954" label="[00:59:54]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: so, no obvious errors in libtool prior to the &quot;no makefile&quot; error</span></div><div class="line" id="010010"><span class="nick" style="color:#2e2a4a"><a href="#010010" label="[01:00:10]">&lt;Googulator&gt;</a></span><span class="message">can you post the configure output?</span></div><div class="line" id="010150"><span class="nick" style="color:#8dd3c7"><a href="#010150" label="[01:01:50]">&lt;stikonas&gt;</a></span><span class="message">it could be that bootstrap indeed tries to run those find and xargs commands but failure was non-fatal</span></div><div class="line" id="010429"><span class="nick" style="color:#6b8072"><a href="#010429" label="[01:04:29]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: the configure output is short, it seems to have failed:</span></div><div class="line" id="010432"><span class="nick" style="color:#6b8072"><a href="#010432" label="[01:04:32]">&lt;rickmasters&gt;</a></span><span class="message">libtool-2.2.4: configuring source.</span></div><div class="line" id="010439"><span class="nick" style="color:#6b8072"><a href="#010439" label="[01:04:39]">&lt;rickmasters&gt;</a></span><span class="message">libtool configure 2.2.4</span></div><div class="line" id="010445"><span class="nick" style="color:#6b8072"><a href="#010445" label="[01:04:45]">&lt;rickmasters&gt;</a></span><span class="message">generated by GNU Autoconf 2.61</span></div><div class="line" id="010502"><span class="nick" style="color:#6b8072"><a href="#010502" label="[01:05:02]">&lt;rickmasters&gt;</a></span><span class="message">Then a copyright message and that's it</span></div><div class="line" id="010625"><span class="nick" style="color:#6b8072"><a href="#010625" label="[01:06:25]">&lt;rickmasters&gt;</a></span><span class="message">Interesting, that on linux you get:</span></div><div class="line" id="010632"><span class="nick" style="color:#2e2a4a"><a href="#010632" label="[01:06:32]">&lt;Googulator&gt;</a></span><span class="message">Before that, did you get the &quot;Bootstrap detected&quot; lines?</span></div><div class="line" id="010642"><span class="nick" style="color:#6b8072"><a href="#010642" label="[01:06:42]">&lt;rickmasters&gt;</a></span><span class="message">libtool-2.2.4: configuring source.</span></div><div class="line" id="010649"><span class="nick" style="color:#6b8072"><a href="#010649" label="[01:06:49]">&lt;rickmasters&gt;</a></span><span class="message">configure: loading cache /dev/null</span></div><div class="line" id="010656"><span class="nick" style="color:#6b8072"><a href="#010656" label="[01:06:56]">&lt;rickmasters&gt;</a></span><span class="message">./configure: line 1: ./configure:: error 02</span></div><div class="line" id="010727"><span class="nick" style="color:#6b8072"><a href="#010727" label="[01:07:27]">&lt;rickmasters&gt;</a></span><span class="message">then a lot of output</span></div><div class="line" id="010812"><span class="nick" style="color:#8dd3c7"><a href="#010812" label="[01:08:12]">&lt;stikonas&gt;</a></span><span class="message">hmm, perhaps there is some issue with M2libc memory  management... I could try to tweak posix-runner to use one preallocated memory block to save all suspended processes (like builder-hex0 does)</span></div><div class="line" id="010845"><span class="nick" style="color:#6b8072"><a href="#010845" label="[01:08:45]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: yes, there is a Bootstrap detected from the prepare function</span></div><div class="line" id="010912"><span class="nick" style="color:#2e2a4a"><a href="#010912" label="[01:09:12]">&lt;Googulator&gt;</a></span><span class="message">there should be several</span></div><div class="line" id="011040"><span class="nick" style="color:#6b8072"><a href="#011040" label="[01:10:40]">&lt;rickmasters&gt;</a></span><span class="message">yes, several</span></div><div class="line" id="011121"><span class="nick" style="color:#2e2a4a"><a href="#011121" label="[01:11:21]">&lt;Googulator&gt;</a></span><span class="message">see <a rel="nofollow" href="https://pipelinesghubeus6.actions.githubusercontent.com/6p8Yv1e2Rv5QWiToIPN8PzwvSX24PCpXUyu7WfoxvNwVP41YOu/_apis/pipelines/1/runs/912/signedlogcontent/2?urlExpires=2024-02-05T00%3A12%3A02.8086153Z&amp;urlSigningMethod=HMACV1&amp;urlSignature=eFkLQTqrQFrcmcyVdyq7MBniOmoFCoq9ECAYQzXWYzI%3D">https://pipelinesghubeus6.actions.githubusercontent.com/6p8Yv1e2Rv5QWiToIPN8PzwvSX24PCpXUyu7WfoxvNwVP41YOu/_apis/pipelines/1/runs/912/signedlogcontent/2?urlExpires=2024-02-05T00%3A12%3A02.8086153Z&amp;urlSigningMethod=HMACV1&amp;urlSignature=eFkLQTqrQFrcmcyVdyq7MBniOmoFCoq9ECAYQzXWYzI%3D</a>  for what it should look like in a successful build</span></div><div class="line" id="011219"><span class="nick" style="color:#2e2a4a"><a href="#011219" label="[01:12:19]">&lt;Googulator&gt;</a></span><span class="message"> <a rel="nofollow" href="https://paste.debian.net/1306313/">https://paste.debian.net/1306313/</a>  cut to just the libtool part</span></div><div class="line" id="012122"><span class="nick" style="color:#6b8072"><a href="#012122" label="[01:21:22]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: I didn't see any obvious differences until configure. I'm running some bisect builds.</span></div><div class="line" id="012452"><span class="nick" style="color:#2e2a4a"><a href="#012452" label="[01:24:52]">&lt;Googulator&gt;</a></span><span class="message">rickmasters: srcfs must always start with &quot;src 0 /&quot;, right?</span></div><div class="line" id="012501"><span class="nick" style="color:#8dd3c7"><a href="#012501" label="[01:25:01]">&lt;stikonas&gt;</a></span><span class="message">argh, I had a stupid copy/paste typo in posix-runner... <a rel="nofollow" href="https://git.stikonas.eu/andrius/stage0-uefi/commit/ccf7808a130bae4f619da3847542d0da2efc5f18">https://git.stikonas.eu/andrius/stage0-uefi/commit/ccf7808a130bae4f619da3847542d0da2efc5f18</a> </span></div><div class="line" id="012509"><span class="nick" style="color:#8dd3c7"><a href="#012509" label="[01:25:09]">&lt;stikonas&gt;</a></span><span class="message">which masked memory allocation error</span></div><div class="line" id="012522"><span class="nick" style="color:#2e2a4a"><a href="#012522" label="[01:25:22]">&lt;Googulator&gt;</a></span><span class="message">if so, we can use that as a signature to find where the srcfs starts, instead of hardcoding specific sectors</span></div><div class="line" id="012538"><span class="nick" style="color:#8dd3c7"><a href="#012538" label="[01:25:38]">&lt;stikonas&gt;</a></span><span class="message">it's not a proper fix yet, but at least we now have a useful error message rather than some mysterious failures</span></div><div class="line" id="012908"><span class="nick" style="color:#6b8072"><a href="#012908" label="[01:29:08]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: it does for live-bootstrap but technically that's not a requirement right now</span></div><div class="line" id="013416"><span class="nick" style="color:#6b8072"><a href="#013416" label="[01:34:16]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: handle_syscall_open verifies that the parent directory exists, except it hard codes an assumption that / exists</span></div><div class="line" id="013444"><span class="nick" style="color:#6b8072"><a href="#013444" label="[01:34:44]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: so you don't have to create /</span></div><div class="line" id="013556"><span class="nick" style="color:#6b8072"><a href="#013556" label="[01:35:56]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: But you have to create a dir that starts with / so I guess the answer is yes</span></div><div class="line" id="013938"><span class="nick" style="color:#389600"><a href="#013938" label="[01:39:38]">&lt;oriansj&gt;</a></span><span class="message">stikonas: we probably need to add an empty stdint.h to M2libc; otherwise M2-Mesoplanet will fail to build (even though those types are already baked into M2-Planet)</span></div><div class="line" id="014018"><span class="nick" style="color:#8dd3c7"><a href="#014018" label="[01:40:18]">&lt;stikonas&gt;</a></span><span class="message">oriansj: hmm, I guess it's fine</span></div><div class="line" id="014033"><span class="nick" style="color:#8dd3c7"><a href="#014033" label="[01:40:33]">&lt;stikonas&gt;</a></span><span class="message">though what started causing this?</span></div><div class="line" id="014203"><span class="nick" style="color:#8dd3c7"><a href="#014203" label="[01:42:03]">&lt;stikonas&gt;</a></span><span class="message">stdint.h was there since 2021...</span></div><div class="line" id="014529"><span class="nick" style="color:#6b8072"><a href="#014529" label="[01:45:29]">&lt;rickmasters&gt;</a></span><span class="message">OK, so I extracted the Fiwix file system from the failed libtools build and /dev/null is a regular file with stuff in it.</span></div><div class="line" id="014603"><span class="nick" style="color:#6b8072"><a href="#014603" label="[01:46:03]">&lt;rickmasters&gt;</a></span><span class="message">Perhaps we need /dev/null to be created properly on Fiwix</span></div><div class="line" id="014730"><span class="nick" style="color:#8dd3c7"><a href="#014730" label="[01:47:30]">&lt;stikonas&gt;</a></span><span class="message">rickmasters: that might also be some other bug</span></div><div class="line" id="014734"><span class="nick" style="color:#389600"><a href="#014734" label="[01:47:34]">&lt;oriansj&gt;</a></span><span class="message">stikonas: on the main branch?</span></div><div class="line" id="014808"><span class="nick" style="color:#8dd3c7"><a href="#014808" label="[01:48:08]">&lt;stikonas&gt;</a></span><span class="message">rickmasters: I've seen how musl's configure script messes up with /dev/null and replaces it with a file (perhaps bug of bash-2.05/meslibc)</span></div><div class="line" id="014815"><span class="nick" style="color:#8dd3c7"><a href="#014815" label="[01:48:15]">&lt;stikonas&gt;</a></span><span class="message">oriansj: I think so</span></div><div class="line" id="014823"><span class="nick" style="color:#8dd3c7"><a href="#014823" label="[01:48:23]">&lt;stikonas&gt;</a></span><span class="message">at least git blame tells me that</span></div><div class="line" id="014848"><span class="nick" style="color:#8dd3c7"><a href="#014848" label="[01:48:48]">&lt;stikonas&gt;</a></span><span class="message">oriansj: by the way, do you remember how our memory management works?</span></div><div class="line" id="014852"><span class="nick" style="color:#8dd3c7"><a href="#014852" label="[01:48:52]">&lt;stikonas&gt;</a></span><span class="message">(in M2libc)</span></div><div class="line" id="014910"><span class="nick" style="color:#8dd3c7"><a href="#014910" label="[01:49:10]">&lt;stikonas&gt;</a></span><span class="message">I wonder why repeatedly allocating/freeing memory seem to leak it</span></div><div class="line" id="015013"><span class="nick" style="color:#8dd3c7"><a href="#015013" label="[01:50:13]">&lt;stikonas&gt;</a></span><span class="message">basically posix-runner allocates fairly large chunks of memory and saves running stage of a process (e.g. mes) while child process is running, later it restores it and free()'s the memory.</span></div><div class="line" id="015019"><span class="nick" style="color:#8dd3c7"><a href="#015019" label="[01:50:19]">&lt;stikonas&gt;</a></span><span class="message">yet there is some kind of leak</span></div><div class="line" id="015040"><span class="nick" style="color:#8dd3c7"><a href="#015040" label="[01:50:40]">&lt;stikonas&gt;</a></span><span class="message">but perhaps it would be more practical for me to preallocate 1 GiB of memory for &quot;saved processes&quot;</span></div><div class="line" id="020001"><span class="nick" style="color:#6b8072"><a href="#020001" label="[02:00:01]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: I thought free was a no-op in early stages</span></div><div class="line" id="020138"><span class="nick" style="color:#6b8072"><a href="#020138" label="[02:01:38]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: after looking, it appears that's outdated- it puts it on a free list</span></div><div class="line" id="020210"><span class="nick" style="color:#80b1d3"><a href="#020210" label="[02:02:10]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Indeed, but something is not working</span></div><div class="line" id="020232"><span class="nick" style="color:#80b1d3"><a href="#020232" label="[02:02:32]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Either bug in m2libc or podix-runner</span></div><div class="line" id="021133"><span class="nick" style="color:#6b8072"><a href="#021133" label="[02:11:33]">&lt;rickmasters&gt;</a></span><span class="message">stikonas: I imagine you rewrote malloc for UEFI due to lack of brk?</span></div><div class="line" id="021143"><span class="nick" style="color:#8dd3c7"><a href="#021143" label="[02:11:43]">&lt;stikonas&gt;</a></span><span class="message">indeed</span></div><div class="line" id="021158"><span class="nick" style="color:#8dd3c7"><a href="#021158" label="[02:11:58]">&lt;stikonas&gt;</a></span><span class="message">well, me and oriansj</span></div><div class="line" id="021234"><span class="nick" style="color:#8dd3c7"><a href="#021234" label="[02:12:34]">&lt;stikonas&gt;</a></span><span class="message">perhaps we could have simply used what is done in builder-hex0</span></div><div class="line" id="021241"><span class="nick" style="color:#8dd3c7"><a href="#021241" label="[02:12:41]">&lt;stikonas&gt;</a></span><span class="message">and what is now posix-runner does..</span></div><div class="line" id="021256"><span class="nick" style="color:#8dd3c7"><a href="#021256" label="[02:12:56]">&lt;stikonas&gt;</a></span><span class="message">i.e. allocate one very big block and use it for brk()</span></div><div class="line" id="021529"><span class="nick" style="color:#6b8072"><a href="#021529" label="[02:15:29]">&lt;rickmasters&gt;</a></span><span class="message">is free_pool returning success ?</span></div><div class="line" id="021614"><span class="nick" style="color:#8dd3c7"><a href="#021614" label="[02:16:14]">&lt;stikonas&gt;</a></span><span class="message">hmm, I would hope so... But this needs checking</span></div><div class="line" id="021623"><span class="nick" style="color:#8dd3c7"><a href="#021623" label="[02:16:23]">&lt;stikonas&gt;</a></span><span class="message">I probably won't have time today to check</span></div><div class="line" id="021626"><span class="nick" style="color:#8dd3c7"><a href="#021626" label="[02:16:26]">&lt;stikonas&gt;</a></span><span class="message">it's getting late</span></div><div class="line" id="021631"><span class="nick" style="color:#6b8072"><a href="#021631" label="[02:16:31]">&lt;rickmasters&gt;</a></span><span class="message">hmm, the wrapper is void return so ...</span></div><div class="line" id="021755"><span class="nick" style="color:#8dd3c7"><a href="#021755" label="[02:17:55]">&lt;stikonas&gt;</a></span><span class="message">hmm, yes, can't check...</span></div><div class="line" id="021806"><span class="nick" style="color:#8dd3c7"><a href="#021806" label="[02:18:06]">&lt;stikonas&gt;</a></span><span class="message">but actuallly same is for free in POSIX</span></div><div class="line" id="021809"><span class="nick" style="color:#8dd3c7"><a href="#021809" label="[02:18:09]">&lt;stikonas&gt;</a></span><span class="message">it's not supposed to fail</span></div><div class="line" id="021820"><span class="nick" style="color:#8dd3c7"><a href="#021820" label="[02:18:20]">&lt;stikonas&gt;</a></span><span class="message">there is no error checking</span></div><div class="line" id="021829"><span class="nick" style="color:#8dd3c7"><a href="#021829" label="[02:18:29]">&lt;stikonas&gt;</a></span><span class="message">libc should just free it when told</span></div><div class="line" id="022039"><span class="nick" style="color:#8dd3c7"><a href="#022039" label="[02:20:39]">&lt;stikonas&gt;</a></span><span class="message">anyway, for now I'm happy that today I fixed a silent failure and made it print an error and will come back tomorrow evening...</span></div><div class="line" id="022044"><span class="nick" style="color:#6b8072"><a href="#022044" label="[02:20:44]">&lt;rickmasters&gt;</a></span><span class="message">ah. well I hope you figure it out. have a good night</span></div><div class="line" id="022156"><span class="nick" style="color:#8dd3c7"><a href="#022156" label="[02:21:56]">&lt;stikonas&gt;</a></span><span class="message">rickmasters: if not, I can simply manage memory inside posix-runner</span></div><div class="line" id="022203"><span class="nick" style="color:#8dd3c7"><a href="#022203" label="[02:22:03]">&lt;stikonas&gt;</a></span><span class="message">just allocate big block for saved program memory...</span></div><div class="line" id="022517"><span class="nick" style="color:#389600"><a href="#022517" label="[02:25:17]">&lt;oriansj&gt;</a></span><span class="message">stikonas: interesting git log -p is showing me that stdint.h was added on 684eade53e3eb9d2fdb6f7997b63dea0e961ef01</span></div><div class="line" id="022944"><span class="nick" style="color:#80b1d3"><a href="#022944" label="[02:29:44]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; <a rel="nofollow" href="https://github.com/oriansj/M2-Mesoplanet/commit/1ac5bb6eee99f59ee2cf3877e4bfc1466baf79b0#diff-b5864dbfdf74de06d9f19fe36f673c7d7063a85ddd62947692e8248ac380e244R22">https://github.com/oriansj/M2-Mesoplanet/commit/1ac5bb6eee99f59ee2cf3877e4bfc1466baf79b0#diff-b5864dbfdf74de06d9f19fe36f673c7d7063a85ddd62947692e8248ac380e244R22</a> </span></div><div class="line" id="023547"><span class="nick" style="color:#389600"><a href="#023547" label="[02:35:47]">&lt;oriansj&gt;</a></span><span class="message">well yes M2-Mesoplanet uses stdint.h; I was saying M2libc did not include a stdint.h file</span></div><div class="line" id="023647"><span class="nick" style="color:#389600"><a href="#023647" label="[02:36:47]">&lt;oriansj&gt;</a></span><span class="message">M2-Planet doesn't use #include lines</span></div><div class="line" id="023655"><span class="nick" style="color:#389600"><a href="#023655" label="[02:36:55]">&lt;oriansj&gt;</a></span><span class="message">only M2-Mesoplanet does</span></div><div class="line" id="023735"><span class="nick" style="color:#389600"><a href="#023735" label="[02:37:35]">&lt;oriansj&gt;</a></span><span class="message">and M2-Mesoplanet fails when there is a #include &lt;stdint.h&gt; because the file stdint.h does not exist in M2libc</span></div><div class="line" id="023819"><span class="nick" style="color:#6b8072"><a href="#023819" label="[02:38:19]">&lt;rickmasters&gt;</a></span><span class="message">So, upgrade of m4 appears to have resulted in /dev/null trouble on Fiwix. I'll continue digging into it.</span></div><div class="line" id="024554"><span class="nick" style="color:#389600"><a href="#024554" label="[02:45:54]">&lt;oriansj&gt;</a></span><span class="message">and it looks like we put struct utsname in the wrong file</span></div><div class="line" id="024557"><span class="nick" style="color:#389600"><a href="#024557" label="[02:45:57]">&lt;oriansj&gt;</a></span><span class="message">easy to fix</span></div><div class="line" id="031110"><span class="nick" style="color:#6b8072"><a href="#031110" label="[03:11:10]">&lt;rickmasters&gt;</a></span><span class="message">update: So it looks like when Fiwix is running /dev/null is OK so I don't know how the m4 update caused the libtool failure yet.</span></div><div class="line" id="034518"><span class="nick" style="color:#2e2a4a"><a href="#034518" label="[03:45:18]">&lt;Googulator&gt;</a></span><span class="message">just checked here as well, /dev/null is a character device (1, 3)</span></div><div class="line" id="034807"><span class="nick" style="color:#6b8072"><a href="#034807" label="[03:48:07]">&lt;rickmasters&gt;</a></span><span class="message">The disk may not have been flushed when I extracted it from memory. I'm running again with a patch that flushes.</span></div><div class="line" id="034911"><span class="nick" style="color:#6b8072"><a href="#034911" label="[03:49:11]">&lt;rickmasters&gt;</a></span><span class="message">Also, the build directory was missing so there wasn't much to go on. Hopefully my current build will provide more info.</span></div><div class="line" id="042334"><span class="nick" style="color:#6b8072"><a href="#042334" label="[04:23:34]">&lt;rickmasters&gt;</a></span><span class="message">I have a good file system this time. The configure script seems small.</span></div><div class="line" id="042521"><span class="nick" style="color:#6b8072"><a href="#042521" label="[04:25:21]">&lt;rickmasters&gt;</a></span><span class="message">I don't have a lot of autotools knowledge so figuring out what went wrong will probably take me a long time.</span></div><div class="line" id="050011"><span class="nick" style="color:#2e2a4a"><a href="#050011" label="[05:00:11]">&lt;Googulator&gt;</a></span><span class="message">current live-bootstrap patch for fiwix filelist removal: <a rel="nofollow" href="https://gist.github.com/Googulator/300fa8845cb12731d3d02f905802f7c8">https://gist.github.com/Googulator/300fa8845cb12731d3d02f905802f7c8</a> </span></div><div class="line" id="050021"><span class="nick" style="color:#2e2a4a"><a href="#050021" label="[05:00:21]">&lt;Googulator&gt;</a></span><span class="message">the builder-hex0 change is <a rel="nofollow" href="https://github.com/ironmeld/builder-hex0/pull/11">https://github.com/ironmeld/builder-hex0/pull/11</a> </span></div><div class="line" id="050132"><span class="nick" style="color:#2e2a4a"><a href="#050132" label="[05:01:32]">&lt;Googulator&gt;</a></span><span class="message">there's also an improvement for the early console; redirections, quoting and other more advanced shell features now work (although Ctrl+D is still required, and obviously there's no tab completion or history)</span></div><div class="line" id="051909"><span class="nick" style="color:#6b8072"><a href="#051909" label="[05:19:09]">&lt;rickmasters&gt;</a></span><span class="message">Googulator: looks ok. There is an argument that can be made that reading next_file_num would be better to know what entries are valid. Of course,</span></div><div class="line" id="051918"><span class="nick" style="color:#6b8072"><a href="#051918" label="[05:19:18]">&lt;rickmasters&gt;</a></span><span class="message">its not in a stable location right now.</span></div><div class="line" id="052006"><span class="nick" style="color:#6b8072"><a href="#052006" label="[05:20:06]">&lt;rickmasters&gt;</a></span><span class="message">But it could be moved to a stable location, like near the file data. It's not needed now but I thought I'd mention that.</span></div><div class="line" id="052048"><span class="nick" style="color:#6b8072"><a href="#052048" label="[05:20:48]">&lt;rickmasters&gt;</a></span><span class="message">There are other variables that are scattered in the code that arguably should be moved to stable external memory. Maybe some day.</span></div><div class="line" id="052628"><span class="nick" style="color:#2e2a4a"><a href="#052628" label="[05:26:28]">&lt;Googulator&gt;</a></span><span class="message">next_file_num alone wouldn't be enough, because of the duplicates</span></div><div class="line" id="052640"><span class="nick" style="color:#2e2a4a"><a href="#052640" label="[05:26:40]">&lt;Googulator&gt;</a></span><span class="message">and eventually also because of unlink, once we implement it</span></div><div class="line" id="052701"><span class="nick" style="color:#2e2a4a"><a href="#052701" label="[05:27:01]">&lt;Googulator&gt;</a></span><span class="message">the set of valid file entries isn't necessarily contiguous in memory</span></div><div class="line" id="060421"><span class="nick" style="color:#6b8072"><a href="#060421" label="[06:04:21]">&lt;rickmasters&gt;</a></span><span class="message">Yes unlink would require zeroing the entries.</span></div><div class="line" id="060707"><span class="nick" style="color:#6b8072"><a href="#060707" label="[06:07:07]">&lt;rickmasters&gt;</a></span><span class="message">Debugging the autotools is a real pain. I have no idea what the problem is with the new m4 version.</span></div><div class="line" id="060817"><span class="nick" style="color:#2e2a4a"><a href="#060817" label="[06:08:17]">&lt;Googulator&gt;</a></span><span class="message">The configure script is clearly being generated wrong</span></div><div class="line" id="060830"><span class="nick" style="color:#6b8072"><a href="#060830" label="[06:08:30]">&lt;rickmasters&gt;</a></span><span class="message">Yeah, I'm done for tonight. I hope figuring it out can be done in a reasonable effort. Kernel bootstrap is nonfunctional in the mean time.</span></div><div class="line" id="060836"><span class="nick" style="color:#2e2a4a"><a href="#060836" label="[06:08:36]">&lt;Googulator&gt;</a></span><span class="message">Original one in the tarball is 895933 bytes</span></div><div class="line" id="060923"><span class="nick" style="color:#2e2a4a"><a href="#060923" label="[06:09:23]">&lt;Googulator&gt;</a></span><span class="message">The one generated by our autotools is just 11178 bytes</span></div><div class="line" id="060933"><span class="nick" style="color:#2e2a4a"><a href="#060933" label="[06:09:33]">&lt;Googulator&gt;</a></span><span class="message">aclocal.m4 is likewise way too small</span></div><div class="line" id="061009"><span class="nick" style="color:#2e2a4a"><a href="#061009" label="[06:10:09]">&lt;Googulator&gt;</a></span><span class="message">34924 bytes, vs 270526 in the tarball</span></div><div class="line" id="061010"><span class="nick" style="color:#6b8072"><a href="#061010" label="[06:10:10]">&lt;rickmasters&gt;</a></span><span class="message">Yeah, configure is 450 lines on Fiwix, 28436 lines on chroot build.</span></div><div class="line" id="061043"><span class="nick" style="color:#6b8072"><a href="#061043" label="[06:10:43]">&lt;rickmasters&gt;</a></span><span class="message">What's strange is the output is totally different, right near the start</span></div><div class="line" id="061143"><span class="nick" style="color:#2e2a4a"><a href="#061143" label="[06:11:43]">&lt;Googulator&gt;</a></span><span class="message">calling autoconf-2.61 on a freshly extracted tarball is enough to break configure</span></div><div class="line" id="061303"><span class="nick" style="color:#6b8072"><a href="#061303" label="[06:13:03]">&lt;rickmasters&gt;</a></span><span class="message">I'm assuming its some m4 macro deep down somewhere dying in some weird way because it fails some kernel specific check</span></div><div class="line" id="061325"><span class="nick" style="color:#6b8072"><a href="#061325" label="[06:13:25]">&lt;rickmasters&gt;</a></span><span class="message">But I'm just groping around randomly right now</span></div><div class="line" id="084732"><span class="nick" style="color:#6d2462"><a href="#084732" label="[08:47:32]">&lt;fossy&gt;</a></span><span class="message">stikonas: aargh, forgot about fiwix-file-list</span></div><div class="line" id="085004"><span class="nick" style="color:#6d2462"><a href="#085004" label="[08:50:04]">&lt;fossy&gt;</a></span><span class="message">wtf happened to my gawk PR with the merges. i def removed the &lt;&lt;&lt; lines</span></div><div class="line" id="085007"><span class="nick" style="color:#6d2462"><a href="#085007" label="[08:50:07]">&lt;fossy&gt;</a></span><span class="message">oh well</span></div><div class="line" id="085027"><span class="nick" style="color:#6d2462"><a href="#085027" label="[08:50:27]">&lt;fossy&gt;</a></span><span class="message">Googulator: 415 LGTM, merging</span></div><div class="line" id="121657"><span class="nick" style="color:#80b1d3"><a href="#121657" label="[12:16:57]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; fossy: should we revert m4 upgrade in the meantime?</span></div><div class="line" id="121805"><span class="nick" style="color:#6d2462"><a href="#121805" label="[12:18:05]">&lt;fossy&gt;</a></span><span class="message">stikonas i think so, i'll just add new m4 to end of bootstrap instead i think</span></div><div class="line" id="121813"><span class="nick" style="color:#6d2462"><a href="#121813" label="[12:18:13]">&lt;fossy&gt;</a></span><span class="message">it's not worth the hassle of debugging kernel bootstrap</span></div><div class="line" id="124044"><span class="nick" style="color:#80b1d3"><a href="#124044" label="[12:40:44]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Yeah, at least not until we have a good reason...</span></div><div class="line" id="124106"><span class="nick" style="color:#80b1d3"><a href="#124106" label="[12:41:06]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; E.g. we want to build newer GCC and Linux in Fiwix</span></div><div class="line" id="175543"><span class="nick" style="color:#2e2a4a"><a href="#175543" label="[17:55:43]">&lt;Googulator&gt;</a></span><span class="message">oriansj: is it just me, or is stdint.h (need by unxz) missing from m2libc?</span></div><div class="line" id="175708"><span class="nick" style="color:#2e2a4a"><a href="#175708" label="[17:57:08]">&lt;Googulator&gt;</a></span><span class="message">oh, it's a sub-submodule</span></div><div class="line" id="190402"><span class="nick" style="color:#8dd3c7"><a href="#190402" label="[19:04:02]">&lt;stikonas&gt;</a></span><span class="message">fossy, Googulator: so diffutils build is not reproducible <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/issues/431">https://github.com/fosslinux/live-bootstrap/issues/431</a> </span></div><div class="line" id="215814"><span class="nick" style="color:#80b1d3"><a href="#215814" label="[21:58:14]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; I almost managed to build live-bootstrap without using -any- tools except from stage0 and OCI built-ins like ADD to download files.</span></div><div class="line" id="215816"><span class="nick" style="color:#80b1d3"><a href="#215816" label="[21:58:16]">&lt;matrix_bridge&gt;</a></span><span class="message">The last issue is when I extract live-bootstrap.tgz with debian tar, it works fine, but when I extract with stage0 ungz/tar it requires non-strict and creates a bunch of symlink warnings and then the build fails.</span></div><div class="line" id="215819"><span class="nick" style="color:#80b1d3"><a href="#215819" label="[21:58:19]">&lt;matrix_bridge&gt;</a></span><span class="message">Any known workarounds?</span></div><div class="line" id="215932"><span class="nick" style="color:#80b1d3"><a href="#215932" label="[21:59:32]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; my best guess for a hack is manually copy files in all the places the symlinks would normally go</span></div><div class="line" id="220756"><span class="nick" style="color:#80b1d3"><a href="#220756" label="[22:07:56]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Lance R. Vick: yes, that's right</span></div><div class="line" id="220811"><span class="nick" style="color:#80b1d3"><a href="#220811" label="[22:08:11]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; untar does not have any support for symlinks</span></div><div class="line" id="220927"><span class="nick" style="color:#80b1d3"><a href="#220927" label="[22:09:27]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; and symlinks would require extra syscalls...</span></div><div class="line" id="221007"><span class="nick" style="color:#80b1d3"><a href="#221007" label="[22:10:07]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; so copying them is probably the best you can do...</span></div><div class="line" id="221133"><span class="nick" style="color:#80b1d3"><a href="#221133" label="[22:11:33]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; Fair enough.</span></div><div class="line" id="221238"><span class="nick" style="color:#80b1d3"><a href="#221238" label="[22:12:38]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; a big ugly block of copies is still preferable to maintaining updates to debian pins for just a tar command</span></div><div class="line" id="221254"><span class="nick" style="color:#80b1d3"><a href="#221254" label="[22:12:54]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; and the trust gap that creates</span></div><div class="line" id="221510"><span class="nick" style="color:#80b1d3"><a href="#221510" label="[22:15:10]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; hmm, I wonder how many symlinks we have in live-bootstrap...</span></div><div class="line" id="221531"><span class="nick" style="color:#80b1d3"><a href="#221531" label="[22:15:31]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; the thing is that bootstrap kernels have no notion of symlink</span></div><div class="line" id="221532"><span class="nick" style="color:#80b1d3"><a href="#221532" label="[22:15:32]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; 11 atm by my count</span></div><div class="line" id="221539"><span class="nick" style="color:#80b1d3"><a href="#221539" label="[22:15:39]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; all patchfiles</span></div><div class="line" id="221540"><span class="nick" style="color:#80b1d3"><a href="#221540" label="[22:15:40]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; e.g. builder-hex0 doesn't support them at all</span></div><div class="line" id="221601"><span class="nick" style="color:#80b1d3"><a href="#221601" label="[22:16:01]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; and for UEFI bootstrap, FAT also doesn't know about symlinks</span></div><div class="line" id="221622"><span class="nick" style="color:#80b1d3"><a href="#221622" label="[22:16:22]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; yeah, mostly musl and coreutils patches</span></div><div class="line" id="221745"><span class="nick" style="color:#80b1d3"><a href="#221745" label="[22:17:45]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; &quot;find . -type l&quot; finds 10</span></div><div class="line" id="221830"><span class="nick" style="color:#80b1d3"><a href="#221830" label="[22:18:30]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; some of them for patches, some of them build scripts and some of them for build directories (with multiple patches inside)</span></div><div class="line" id="222537"><span class="nick" style="color:#80b1d3"><a href="#222537" label="[22:25:37]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; Hmm. Copied them all but still explodes: <a rel="nofollow" href="https://dpaste.org/9UV26">https://dpaste.org/9UV26</a> </span></div><div class="line" id="222715"><span class="nick" style="color:#80b1d3"><a href="#222715" label="[22:27:15]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Lance R. Vick&gt; much easier to read raw ^</span></div><div class="line" id="225543"><span class="nick" style="color:#80b1d3"><a href="#225543" label="[22:55:43]">&lt;matrix_bridge&gt;</a></span><span class="message">&lt;Andrius Štikonas&gt; Hmm, maybe just diff two directories?</span></div><br /></div></body></html>