<!DOCTYPE html><html><head><title>IRC channel logs</title><style>html {
  background: #fdfdfd;
}

h1 {
  font-weight: 300;
}

h2 {
  font-weight: 200;
}

h3 {
  padding: .5em 0;
  border-top: 3px dotted #ddd;
  margin-bottom: 0;
}

form {
  width: 400px;
  display: flex;
}

input {
  width: 100%;
  display: flex;
  border-radius: .25em 0 0 .25em;
  border: 1px solid #aaa;
  border-right: 0;
  padding: 0.5em;
}

button {
  display: flex;
  border-radius: 0 .25em .25em 0;
  background-color: #007bff;
  border: 1px solid #007bff;
  padding: .5em;
  cursor: pointer;
  color: white;
}

button:hover {
  background-color: #0069d9;
  border-color: #0062cc;
}

a {
  color: #007bff;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h4 {
  margin-bottom: .5em;
}

table td {
  padding: 0.75em;
}

table tr:hover {
  background: #eee;
}

.year {
  display: table;
}

.month {
  display: table-cell;
  padding-right: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.nick {
  padding-right: 0.6rem;
  font-weight: bold;
  text-align: right;
  width: 13rem;
  display: table-cell;
}

.nick a {
  color: inherit;
  text-decoration: none;
}

.message {
  display: table-cell;
  padding-left: 0.6rem;
  border-left: 2px solid #333;
}

.notice {
  color: #859900;
  font-style: italic;
}

.line {
  line-height: 1.8rem;
  display: table;
}

#logs {
  margin-top: 1.5rem;
  padding: 1.5rem;
}
</style></head><body><h1>IRC channel logs</h1><h2>2021-03-08.log</h2><p><a href="/bootstrappable">back to list of logs</a></p><div id="logs"><div class="line" id="064530"><span class="nick" style="color:#8dd3c7"><a href="#064530" label="[06:45:30]">&lt;janneke&gt;</a></span><span class="message">dannym: that would be <a rel="nofollow" href="https://chat.radicallyopensecurity.com">https://chat.radicallyopensecurity.com</a>,  i have been mostly off-grid the past month...sorry about that</span></div><div class="line" id="074232"><span class="nick">***</span><span class="message notice">ChanServ sets mode: +o rekado_</span></div><div class="line" id="074234"><span class="nick">***</span><span class="message notice">rekado_ is now known as rekado</span></div><div class="line" id="101103"><span class="nick" style="color:#2e2a4a"><a href="#101103" label="[10:11:03]">&lt;fossy&gt;</a></span><span class="message">3 more undefined decls</span></div><div class="line" id="101315"><span class="nick" style="color:#2e2a4a"><a href="#101315" label="[10:13:15]">&lt;fossy&gt;</a></span><span class="message">for kexec-tools</span></div><div class="line" id="101319"><span class="nick" style="color:#2e2a4a"><a href="#101319" label="[10:13:19]">&lt;fossy&gt;</a></span><span class="message">stikonas[m]: merged</span></div><div class="line" id="101430"><span class="nick" style="color:#6b8072"><a href="#101430" label="[10:14:30]">&lt;stikonas[m]&gt;</a></span><span class="message">Thanks! I'll do libtool next</span></div><div class="line" id="101602"><span class="nick" style="color:#2e2a4a"><a href="#101602" label="[10:16:02]">&lt;fossy&gt;</a></span><span class="message">:D</span></div><div class="line" id="101608"><span class="nick" style="color:#2e2a4a"><a href="#101608" label="[10:16:08]">&lt;fossy&gt;</a></span><span class="message">i opened an issue so we wouldn't forget</span></div><div class="line" id="121441"><span class="nick" style="color:#80b1d3"><a href="#121441" label="[12:14:41]">&lt;dannym&gt;</a></span><span class="message">janneke: No problem.  Meanwhile, I've been busy prodding AMD to see the light of bootstrapping :)</span></div><div class="line" id="121508"><span class="nick" style="color:#80b1d3"><a href="#121508" label="[12:15:08]">&lt;dannym&gt;</a></span><span class="message">Now we got this <a rel="nofollow" href="https://github.com/oreboot/oreboot/tree/master/src/mainboard/amd/romecrb">https://github.com/oreboot/oreboot/tree/master/src/mainboard/amd/romecrb</a>  ;)</span></div><div class="line" id="121807"><span class="nick" style="color:#80b1d3"><a href="#121807" label="[12:18:07]">&lt;dannym&gt;</a></span><span class="message">It boots into Linux</span></div><div class="line" id="122813"><span class="nick" style="color:#8dd3c7"><a href="#122813" label="[12:28:13]">&lt;janneke&gt;</a></span><span class="message">dannym: oh, that's a recent x86 arch without ME or proprietary BIOS?</span></div><div class="line" id="122913"><span class="nick" style="color:#80b1d3"><a href="#122913" label="[12:29:13]">&lt;dannym&gt;</a></span><span class="message">ME-like thing (PSP) is still there</span></div><div class="line" id="122917"><span class="nick" style="color:#80b1d3"><a href="#122917" label="[12:29:17]">&lt;dannym&gt;</a></span><span class="message">But it's very small</span></div><div class="line" id="122928"><span class="nick" style="color:#80b1d3"><a href="#122928" label="[12:29:28]">&lt;dannym&gt;</a></span><span class="message">I can't drag them all the way at once ;)</span></div><div class="line" id="122935"><span class="nick" style="color:#80b1d3"><a href="#122935" label="[12:29:35]">&lt;dannym&gt;</a></span><span class="message">But no proprietary BIOS at all</span></div><div class="line" id="122938"><span class="nick" style="color:#80b1d3"><a href="#122938" label="[12:29:38]">&lt;dannym&gt;</a></span><span class="message">Also no blobs on the x86</span></div><div class="line" id="123051"><span class="nick" style="color:#80b1d3"><a href="#123051" label="[12:30:51]">&lt;dannym&gt;</a></span><span class="message">There are university people in Germany that have been reverse engineering the PSP; <a rel="nofollow" href="https://github.com/PSPReverse">https://github.com/PSPReverse</a> </span></div><div class="line" id="123109"><span class="nick" style="color:#80b1d3"><a href="#123109" label="[12:31:09]">&lt;dannym&gt;</a></span><span class="message">It has an emulator and everything</span></div><div class="line" id="123135"><span class="nick" style="color:#80b1d3"><a href="#123135" label="[12:31:35]">&lt;dannym&gt;</a></span><span class="message">So, situation slowly improving :)</span></div><div class="line" id="123243"><span class="nick" style="color:#6d2462"><a href="#123243" label="[12:32:43]">&lt;g_bor[m]&gt;</a></span><span class="message">Wow, nice</span></div><div class="line" id="123304"><span class="nick" style="color:#80b1d3"><a href="#123304" label="[12:33:04]">&lt;dannym&gt;</a></span><span class="message">Thanks :)</span></div><div class="line" id="123314"><span class="nick" style="color:#80b1d3"><a href="#123314" label="[12:33:14]">&lt;dannym&gt;</a></span><span class="message">You have no idea how many meetings that took to clear... I'm a pro at meetings now</span></div><div class="line" id="123446"><span class="nick" style="color:#6d2462"><a href="#123446" label="[12:34:46]">&lt;g_bor[m]&gt;</a></span><span class="message">I also have something similar. I started to have a look at the intel fsp. So far I found nothing that could not be done based on the public docs, but I have only checked the first part of fsp-t so far.</span></div><div class="line" id="123450"><span class="nick" style="color:#8dd3c7"><a href="#123450" label="[12:34:50]">&lt;janneke&gt;</a></span><span class="message">dannym: amazing!  well done!</span></div><div class="line" id="123528"><span class="nick" style="color:#8dd3c7"><a href="#123528" label="[12:35:28]">&lt;janneke&gt;</a></span><span class="message">dannym: i was trying to remember in public here what i think you told me :-)</span></div><div class="line" id="123620"><span class="nick" style="color:#80b1d3"><a href="#123620" label="[12:36:20]">&lt;dannym&gt;</a></span><span class="message">:-)</span></div><div class="line" id="123814"><span class="nick" style="color:#80b1d3"><a href="#123814" label="[12:38:14]">&lt;dannym&gt;</a></span><span class="message">g_bor[m]: Very good!</span></div><div class="line" id="124023"><span class="nick" style="color:#6d2462"><a href="#124023" label="[12:40:23]">&lt;g_bor[m]&gt;</a></span><span class="message">Also I have found it problematic to find datasheets for some AMD chipsets, so there might be some guesswork in having those started. I had better luck with intel chpisets in this regard. Do you expect that this will also be solved?</span></div><div class="line" id="124159"><span class="nick" style="color:#80b1d3"><a href="#124159" label="[12:41:59]">&lt;dannym&gt;</a></span><span class="message">Confirming several weeks of guesswork here before it worked well enough that AMD got interested ;)</span></div><div class="line" id="124210"><span class="nick" style="color:#80b1d3"><a href="#124210" label="[12:42:10]">&lt;dannym&gt;</a></span><span class="message">Now we have AMD employees helping, too</span></div><div class="line" id="124235"><span class="nick" style="color:#80b1d3"><a href="#124235" label="[12:42:35]">&lt;dannym&gt;</a></span><span class="message">Like people doing the AMD evaluation boards; and the head of firmware at AMD</span></div><div class="line" id="124306"><span class="nick" style="color:#80b1d3"><a href="#124306" label="[12:43:06]">&lt;dannym&gt;</a></span><span class="message">Hmm, for datasheets it depends on whether it's something that a competitor could use to undercut AMD and produce compatible chips</span></div><div class="line" id="124325"><span class="nick" style="color:#80b1d3"><a href="#124325" label="[12:43:25]">&lt;dannym&gt;</a></span><span class="message">A lot of stuff that is not a competitive advanteage they just straight out publish</span></div><div class="line" id="124358"><span class="nick" style="color:#80b1d3"><a href="#124358" label="[12:43:58]">&lt;dannym&gt;</a></span><span class="message">See this: <a rel="nofollow" href="https://developer.amd.com/resources/epyc-resources/epyc-specifications/">https://developer.amd.com/resources/epyc-resources/epyc-specifications/</a> </span></div><div class="line" id="124424"><span class="nick" style="color:#80b1d3"><a href="#124424" label="[12:44:24]">&lt;dannym&gt;</a></span><span class="message">But for things where you need to know in detail how their chiplet interconnects work, those are under NDA</span></div><div class="line" id="124449"><span class="nick" style="color:#80b1d3"><a href="#124449" label="[12:44:49]">&lt;dannym&gt;</a></span><span class="message">But it's easy enough to get access to those (took under a day for me to get cleared for that)</span></div><div class="line" id="124532"><span class="nick" style="color:#80b1d3"><a href="#124532" label="[12:45:32]">&lt;dannym&gt;</a></span><span class="message">But they are a typical semiconductor company--default mode is &quot;confidential&quot;; it's hard work to make them work the other way, &quot;open first&quot;</span></div><div class="line" id="124606"><span class="nick" style="color:#80b1d3"><a href="#124606" label="[12:46:06]">&lt;dannym&gt;</a></span><span class="message">Advantage is that they've supported coreboot (i.e. written code for coreboot) for AMD CPUs before.  Now it's just a matter of prodding them to do it again...</span></div><div class="line" id="124612"><span class="nick" style="color:#80b1d3"><a href="#124612" label="[12:46:12]">&lt;dannym&gt;</a></span><span class="message">Or let us do it, even</span></div><div class="line" id="125308"><span class="nick" style="color:#80b1d3"><a href="#125308" label="[12:53:08]">&lt;dannym&gt;</a></span><span class="message">Long term, there are people at AMD doing the hard work of convincing their streeting committee to just do silicon initialization in an open source project for ALL future cpus</span></div><div class="line" id="125348"><span class="nick" style="color:#80b1d3"><a href="#125348" label="[12:53:48]">&lt;dannym&gt;</a></span><span class="message">I'll know more about the latter at the end of this month</span></div><div class="line" id="125525"><span class="nick" style="color:#80b1d3"><a href="#125525" label="[12:55:25]">&lt;dannym&gt;</a></span><span class="message">steering*</span></div><div class="line" id="125558"><span class="nick" style="color:#80b1d3"><a href="#125558" label="[12:55:58]">&lt;dannym&gt;</a></span><span class="message">janneke: I'll have a meeting with the security quickscan people tomorrow at 12:00 CET</span></div><div class="line" id="145027"><span class="nick" style="color:#234e69"><a href="#145027" label="[14:50:27]">&lt;OriansJ`&gt;</a></span><span class="message">very impressive dannym</span></div><div class="line" id="145055"><span class="nick" style="color:#234e69"><a href="#145055" label="[14:50:55]">&lt;OriansJ`&gt;</a></span><span class="message">It'll be wonderful to see more blobless computers in the future.</span></div><div class="line" id="145921"><span class="nick" style="color:#8dd3c7"><a href="#145921" label="[14:59:21]">&lt;janneke&gt;</a></span><span class="message">dannym: ah, that's great; let me see if i can join</span></div><div class="line" id="160450"><span class="nick" style="color:#6c3d55"><a href="#160450" label="[16:04:50]">&lt;pder&gt;</a></span><span class="message">stikonas: nice job on getting perl modules working.  Is there a reason you are still using &quot;tcc -ar&quot; instead of ar from binutils in your latest perl branch?</span></div><div class="line" id="160812"><span class="nick" style="color:#6c3d55"><a href="#160812" label="[16:08:12]">&lt;pder&gt;</a></span><span class="message">Oh yeah, nvm, perl is built before binutils.</span></div><div class="line" id="161738"><span class="nick" style="color:#d9d9d9"><a href="#161738" label="[16:17:38]">&lt;stikonas_&gt;</a></span><span class="message">pder: indeed...</span></div><div class="line" id="161743"><span class="nick">***</span><span class="message notice">stikonas_ is now known as stikonas</span></div><div class="line" id="161801"><span class="nick" style="color:#bc80bd"><a href="#161801" label="[16:18:01]">&lt;stikonas&gt;</a></span><span class="message">pder: and apparently for binutils we still need to sort out libtool</span></div><div class="line" id="161816"><span class="nick" style="color:#bc80bd"><a href="#161816" label="[16:18:16]">&lt;stikonas&gt;</a></span><span class="message">which is a bit tricky but hopefully possible</span></div><div class="line" id="161821"><span class="nick" style="color:#6c3d55"><a href="#161821" label="[16:18:21]">&lt;pder&gt;</a></span><span class="message">ive been away, whats the issue with it?</span></div><div class="line" id="161834"><span class="nick" style="color:#bc80bd"><a href="#161834" label="[16:18:34]">&lt;stikonas&gt;</a></span><span class="message">we think we should regenerate libtool files too</span></div><div class="line" id="161847"><span class="nick" style="color:#bc80bd"><a href="#161847" label="[16:18:47]">&lt;stikonas&gt;</a></span><span class="message">so need to install libtool</span></div><div class="line" id="161853"><span class="nick" style="color:#bc80bd"><a href="#161853" label="[16:18:53]">&lt;stikonas&gt;</a></span><span class="message">first of all libtool depends on env</span></div><div class="line" id="161856"><span class="nick" style="color:#bc80bd"><a href="#161856" label="[16:18:56]">&lt;stikonas&gt;</a></span><span class="message">that's easy</span></div><div class="line" id="161923"><span class="nick" style="color:#bc80bd"><a href="#161923" label="[16:19:23]">&lt;stikonas&gt;</a></span><span class="message">then also somewhat depends on ar/ld, but we might be able to get away with setting it to tcc -ar and true</span></div><div class="line" id="161950"><span class="nick" style="color:#bc80bd"><a href="#161950" label="[16:19:50]">&lt;stikonas&gt;</a></span><span class="message">also just in general need to familiarize with libtool</span></div><div class="line" id="162045"><span class="nick" style="color:#bc80bd"><a href="#162045" label="[16:20:45]">&lt;stikonas&gt;</a></span><span class="message">pder: so with perl, I can run newer automake (at leats until it doesn't require newer autoconf)</span></div><div class="line" id="162050"><span class="nick" style="color:#6c3d55"><a href="#162050" label="[16:20:50]">&lt;pder&gt;</a></span><span class="message">for the easy stuff to add to coreutils build, I know we need env and dirname.  Anything else?</span></div><div class="line" id="162052"><span class="nick" style="color:#bc80bd"><a href="#162052" label="[16:20:52]">&lt;stikonas&gt;</a></span><span class="message">with autoconf it's a bit tricker</span></div><div class="line" id="162104"><span class="nick" style="color:#bc80bd"><a href="#162104" label="[16:21:04]">&lt;stikonas&gt;</a></span><span class="message">pder: hostname later...</span></div><div class="line" id="162114"><span class="nick" style="color:#bc80bd"><a href="#162114" label="[16:21:14]">&lt;stikonas&gt;</a></span><span class="message">newer autoconf now can find perl modules</span></div><div class="line" id="162124"><span class="nick" style="color:#bc80bd"><a href="#162124" label="[16:21:24]">&lt;stikonas&gt;</a></span><span class="message">but later autom4te invocation gets stuck</span></div><div class="line" id="162127"><span class="nick" style="color:#bc80bd"><a href="#162127" label="[16:21:27]">&lt;stikonas&gt;</a></span><span class="message">not sure if it's perl problem</span></div><div class="line" id="162131"><span class="nick" style="color:#bc80bd"><a href="#162131" label="[16:21:31]">&lt;stikonas&gt;</a></span><span class="message">might be m4...</span></div><div class="line" id="162203"><span class="nick" style="color:#6c3d55"><a href="#162203" label="[16:22:03]">&lt;pder&gt;</a></span><span class="message">interesting.  I remember a perl Configure script getting stuck as well- not sure if the same issue</span></div><div class="line" id="162305"><span class="nick" style="color:#bc80bd"><a href="#162305" label="[16:23:05]">&lt;stikonas&gt;</a></span><span class="message">perl Configure script probably wouldn't support tcc anyway</span></div><div class="line" id="162343"><span class="nick" style="color:#bc80bd"><a href="#162343" label="[16:23:43]">&lt;stikonas&gt;</a></span><span class="message">it might also be that some perl modules aren't fully working</span></div><div class="line" id="162408"><span class="nick" style="color:#6c3d55"><a href="#162408" label="[16:24:08]">&lt;pder&gt;</a></span><span class="message">What do we need to generate the perl Configure script?</span></div><div class="line" id="162409"><span class="nick" style="color:#bc80bd"><a href="#162409" label="[16:24:09]">&lt;stikonas&gt;</a></span><span class="message">pder: anyway, it's now pushed, so you can try building newer autoconf with ./configure</span></div><div class="line" id="162426"><span class="nick" style="color:#bc80bd"><a href="#162426" label="[16:24:26]">&lt;stikonas&gt;</a></span><span class="message">pder: I'm not fully sure</span></div><div class="line" id="162432"><span class="nick" style="color:#bc80bd"><a href="#162432" label="[16:24:32]">&lt;stikonas&gt;</a></span><span class="message">it probably uses some perl modules</span></div><div class="line" id="162437"><span class="nick" style="color:#bc80bd"><a href="#162437" label="[16:24:37]">&lt;stikonas&gt;</a></span><span class="message">which we might have</span></div><div class="line" id="162441"><span class="nick" style="color:#bc80bd"><a href="#162441" label="[16:24:41]">&lt;stikonas&gt;</a></span><span class="message">but it might use more stuff</span></div><div class="line" id="162445"><span class="nick" style="color:#bc80bd"><a href="#162445" label="[16:24:45]">&lt;stikonas&gt;</a></span><span class="message">it's complicated...</span></div><div class="line" id="162451"><span class="nick" style="color:#6c3d55"><a href="#162451" label="[16:24:51]">&lt;pder&gt;</a></span><span class="message">indeed</span></div><div class="line" id="162459"><span class="nick" style="color:#bc80bd"><a href="#162459" label="[16:24:59]">&lt;stikonas&gt;</a></span><span class="message">so I would rather postpone it...</span></div><div class="line" id="162514"><span class="nick" style="color:#bc80bd"><a href="#162514" label="[16:25:14]">&lt;stikonas&gt;</a></span><span class="message">especially since it's unlikely to work yet in our non-standard environment</span></div><div class="line" id="162643"><span class="nick" style="color:#6c3d55"><a href="#162643" label="[16:26:43]">&lt;pder&gt;</a></span><span class="message">what autoconf should I try building?</span></div><div class="line" id="162743"><span class="nick" style="color:#bc80bd"><a href="#162743" label="[16:27:43]">&lt;stikonas&gt;</a></span><span class="message">anything newer</span></div><div class="line" id="162756"><span class="nick" style="color:#bc80bd"><a href="#162756" label="[16:27:56]">&lt;stikonas&gt;</a></span><span class="message">2.53 or 2.60</span></div><div class="line" id="162803"><span class="nick" style="color:#bc80bd"><a href="#162803" label="[16:28:03]">&lt;stikonas&gt;</a></span><span class="message">would have the same problem</span></div><div class="line" id="162812"><span class="nick" style="color:#bc80bd"><a href="#162812" label="[16:28:12]">&lt;stikonas&gt;</a></span><span class="message">even newer might complain on gawk...</span></div><div class="line" id="162827"><span class="nick" style="color:#bc80bd"><a href="#162827" label="[16:28:27]">&lt;stikonas&gt;</a></span><span class="message">(same problem you saw)</span></div><div class="line" id="173321"><span class="nick" style="color:#6c3d55"><a href="#173321" label="[17:33:21]">&lt;pder&gt;</a></span><span class="message">stikonas: would it be difficult to include Devel-Trace in the perl build?  It could be useful for debugging these hangs- its similar to sh +x</span></div><div class="line" id="173346"><span class="nick" style="color:#bc80bd"><a href="#173346" label="[17:33:46]">&lt;stikonas&gt;</a></span><span class="message">pder: probably not too difficult</span></div><div class="line" id="173352"><span class="nick" style="color:#bc80bd"><a href="#173352" label="[17:33:52]">&lt;stikonas&gt;</a></span><span class="message">but hard to know without trying</span></div><div class="line" id="173433"><span class="nick" style="color:#6c3d55"><a href="#173433" label="[17:34:33]">&lt;pder&gt;</a></span><span class="message">I tried building autoconf-2.57 and ran into that autom4te hang</span></div><div class="line" id="173449"><span class="nick" style="color:#bc80bd"><a href="#173449" label="[17:34:49]">&lt;stikonas&gt;</a></span><span class="message">pder: I don't even see Devel-Trace in extention list in 5.6.2?</span></div><div class="line" id="173452"><span class="nick" style="color:#bc80bd"><a href="#173452" label="[17:34:52]">&lt;stikonas&gt;</a></span><span class="message">is it something newer?</span></div><div class="line" id="173510"><span class="nick" style="color:#bc80bd"><a href="#173510" label="[17:35:10]">&lt;stikonas&gt;</a></span><span class="message">Devel has DProf and Peek</span></div><div class="line" id="173530"><span class="nick" style="color:#bc80bd"><a href="#173530" label="[17:35:30]">&lt;stikonas&gt;</a></span><span class="message">those two are probably easy to build</span></div><div class="line" id="173753"><span class="nick" style="color:#6c3d55"><a href="#173753" label="[17:37:53]">&lt;pder&gt;</a></span><span class="message">Hmm, I am not sure on how old it is</span></div><div class="line" id="173934"><span class="nick" style="color:#bc80bd"><a href="#173934" label="[17:39:34]">&lt;stikonas&gt;</a></span><span class="message">even 5.8 doesn't seem to have it...</span></div><div class="line" id="174059"><span class="nick" style="color:#6c3d55"><a href="#174059" label="[17:40:59]">&lt;pder&gt;</a></span><span class="message">its probably not part of core perl.  But a version of Devel::Trace existed in 1998</span></div><div class="line" id="174215"><span class="nick" style="color:#bc80bd"><a href="#174215" label="[17:42:15]">&lt;stikonas&gt;</a></span><span class="message">maybe can just drop it to perl's lib folder?</span></div><div class="line" id="174318"><span class="nick" style="color:#6c3d55"><a href="#174318" label="[17:43:18]">&lt;pder&gt;</a></span><span class="message">possibly, I need to read up on how all this works</span></div><div class="line" id="192437"><span class="nick" style="color:#6c3d55"><a href="#192437" label="[19:24:37]">&lt;pder&gt;</a></span><span class="message">apparently the perl debugger works with perl -d so hoping that will give some clues to the hang</span></div><div class="line" id="193258"><span class="nick" style="color:#bc80bd"><a href="#193258" label="[19:32:58]">&lt;stikonas&gt;</a></span><span class="message">let's hope you can find something</span></div><div class="line" id="193312"><span class="nick" style="color:#bc80bd"><a href="#193312" label="[19:33:12]">&lt;stikonas&gt;</a></span><span class="message">usually you are quite good at solving these issues</span></div><div class="line" id="193330"><span class="nick" style="color:#bc80bd"><a href="#193330" label="[19:33:30]">&lt;stikonas&gt;</a></span><span class="message">(last time I guess it was that flushing issue in musl)</span></div><div class="line" id="195115"><span class="nick" style="color:#6c3d55"><a href="#195115" label="[19:51:15]">&lt;pder&gt;</a></span><span class="message">So something is hanging in the following command after debugging /after/autoconf-2.57/bin/autom4te</span></div><div class="line" id="195134"><span class="nick" style="color:#6c3d55"><a href="#195134" label="[19:51:34]">&lt;pder&gt;</a></span><span class="message">/after/bin/m4 --nesting-limit=1024 --fatal-warning --include=/after/autoconf-2.57/lib --include=/usr/local/share/autoconf --define=divert /after/autoconf-2.57/lib/m4sugar/m4sugar.m4 /after/autoconf-2.57/lib/m4sugar/m4sh.m4 /after/autoconf-2.57/lib/autoconf/autoconf.m4 &lt;/dev/null</span></div><div class="line" id="195440"><span class="nick" style="color:#6c3d55"><a href="#195440" label="[19:54:40]">&lt;pder&gt;</a></span><span class="message">But I can run that command without issue outside of perl</span></div><div class="line" id="195933"><span class="nick" style="color:#6c3d55"><a href="#195933" label="[19:59:33]">&lt;pder&gt;</a></span><span class="message">I tried creating a trivial perl script that does $result = `m4 command above` and this hangs</span></div><div class="line" id="195947"><span class="nick" style="color:#6c3d55"><a href="#195947" label="[19:59:47]">&lt;pder&gt;</a></span><span class="message">But I can run the m4 command from the shell</span></div><div class="line" id="200738"><span class="nick" style="color:#6c3d55"><a href="#200738" label="[20:07:38]">&lt;pder&gt;</a></span><span class="message">My guess is the issue is in perl and not m4.  I was able to run the same command adjusting all of the paths to ones outside the chroot using the perl on my system</span></div><div class="line" id="200826"><span class="nick" style="color:#bc80bd"><a href="#200826" label="[20:08:26]">&lt;stikonas&gt;</a></span><span class="message">pder: I tried running that command too</span></div><div class="line" id="200840"><span class="nick" style="color:#bc80bd"><a href="#200840" label="[20:08:40]">&lt;stikonas&gt;</a></span><span class="message">but somehow autoconf was not happy with the produced file</span></div><div class="line" id="200900"><span class="nick" style="color:#bc80bd"><a href="#200900" label="[20:09:00]">&lt;stikonas&gt;</a></span><span class="message">or maybe I did something wrong...</span></div><div class="line" id="201452"><span class="nick" style="color:#6c3d55"><a href="#201452" label="[20:14:52]">&lt;pder&gt;</a></span><span class="message">I tried running strace on our perl running the $result = `m4 command above` and it seems to be hanging on read(5, ) so maybe something related to pipes?</span></div><div class="line" id="202303"><span class="nick" style="color:#bc80bd"><a href="#202303" label="[20:23:03]">&lt;stikonas&gt;</a></span><span class="message">hmm, could be</span></div><div class="line" id="202310"><span class="nick" style="color:#bc80bd"><a href="#202310" label="[20:23:10]">&lt;stikonas&gt;</a></span><span class="message">maybe something with musl?</span></div><div class="line" id="202329"><span class="nick" style="color:#bc80bd"><a href="#202329" label="[20:23:29]">&lt;stikonas&gt;</a></span><span class="message">pder: this perl is still built using old musl...</span></div><div class="line" id="202355"><span class="nick" style="color:#bc80bd"><a href="#202355" label="[20:23:55]">&lt;stikonas&gt;</a></span><span class="message">perhaps we need to rebuild it?</span></div><div class="line" id="202458"><span class="nick" style="color:#6c3d55"><a href="#202458" label="[20:24:58]">&lt;pder&gt;</a></span><span class="message">Can't hurt, but I may have already tried that</span></div><div class="line" id="202605"><span class="nick" style="color:#6c3d55"><a href="#202605" label="[20:26:05]">&lt;pder&gt;</a></span><span class="message">Yeah, I just rebuilt perl and still get the same issue</span></div><div class="line" id="202856"><span class="nick" style="color:#bc80bd"><a href="#202856" label="[20:28:56]">&lt;stikonas&gt;</a></span><span class="message">hmm</span></div><div class="line" id="203201"><span class="nick" style="color:#bc80bd"><a href="#203201" label="[20:32:01]">&lt;stikonas&gt;</a></span><span class="message">pder: maybe can try to build perl with HAS_PIPE in config.h</span></div><div class="line" id="203217"><span class="nick" style="color:#bc80bd"><a href="#203217" label="[20:32:17]">&lt;stikonas&gt;</a></span><span class="message">if it's something to do with pipes</span></div><div class="line" id="210413"><span class="nick" style="color:#bc80bd"><a href="#210413" label="[21:04:13]">&lt;stikonas&gt;</a></span><span class="message">no, it's not HAS_PIPE...</span></div><div class="line" id="210426"><span class="nick" style="color:#bc80bd"><a href="#210426" label="[21:04:26]">&lt;stikonas&gt;</a></span><span class="message">still fails with HAS_PIPE...</span></div><div class="line" id="215520"><span class="nick" style="color:#6c3d55"><a href="#215520" label="[21:55:20]">&lt;pder&gt;</a></span><span class="message">stikonas: so I tried extracting the perl-5.6.2 source and ran ./Configure -Dcc=tcc -des &amp;&amp; make</span></div><div class="line" id="215550"><span class="nick" style="color:#6c3d55"><a href="#215550" label="[21:55:50]">&lt;pder&gt;</a></span><span class="message">it builds miniperl but fails a bit later on.  However copying miniperl over /after/bin/perl seems to fix that hanging error in autom4te</span></div><div class="line" id="215608"><span class="nick" style="color:#6c3d55"><a href="#215608" label="[21:56:08]">&lt;pder&gt;</a></span><span class="message">so maybe you can compare what Configure does compared to your build?</span></div><div class="line" id="215807"><span class="nick" style="color:#6c3d55"><a href="#215807" label="[21:58:07]">&lt;pder&gt;</a></span><span class="message">Note that paths will be wrong if you use Configure -des</span></div><div class="line" id="220641"><span class="nick" style="color:#6c3d55"><a href="#220641" label="[22:06:41]">&lt;pder&gt;</a></span><span class="message">I should clarify that the miniperl build after running Configure was able to run my trivial $result = `m4 command`;</span></div><div class="line" id="222837"><span class="nick" style="color:#bc80bd"><a href="#222837" label="[22:28:37]">&lt;stikonas&gt;</a></span><span class="message">what about our miniperl?</span></div><div class="line" id="222909"><span class="nick" style="color:#bc80bd"><a href="#222909" label="[22:29:09]">&lt;stikonas&gt;</a></span><span class="message">if ours is hanging, it's almost surely compile options, so I guess we are hitting some stub due to missing defines in config.h</span></div><div class="line" id="223203"><span class="nick" style="color:#6c3d55"><a href="#223203" label="[22:32:03]">&lt;pder&gt;</a></span><span class="message">Yeah, our current miniperl hangs on the trivial program that calls m4.  The miniperl built by running Configure and make does not hang, so I was suggesting comparing the two different configs</span></div><div class="line" id="223500"><span class="nick" style="color:#bc80bd"><a href="#223500" label="[22:35:00]">&lt;stikonas&gt;</a></span><span class="message">well, I have already tried adding HAS_PIPE...</span></div><div class="line" id="223505"><span class="nick" style="color:#bc80bd"><a href="#223505" label="[22:35:05]">&lt;stikonas&gt;</a></span><span class="message">that might be necessary but is not sufficient</span></div><div class="line" id="223521"><span class="nick" style="color:#bc80bd"><a href="#223521" label="[22:35:21]">&lt;stikonas&gt;</a></span><span class="message">but yeah, I guess we can add quite a few more HAS_* defines</span></div><div class="line" id="223532"><span class="nick" style="color:#bc80bd"><a href="#223532" label="[22:35:32]">&lt;stikonas&gt;</a></span><span class="message">I already had to add a couple extra for autoconf</span></div><div class="line" id="223547"><span class="nick" style="color:#bc80bd"><a href="#223547" label="[22:35:47]">&lt;stikonas&gt;</a></span><span class="message">HAS_FLOCK and and something else</span></div><div class="line" id="223905"><span class="nick" style="color:#bc80bd"><a href="#223905" label="[22:39:05]">&lt;stikonas&gt;</a></span><span class="message">anyway, all of this looks very promising</span></div><div class="line" id="223915"><span class="nick" style="color:#bc80bd"><a href="#223915" label="[22:39:15]">&lt;stikonas&gt;</a></span><span class="message">so I think we'll soon have newer autoconf</span></div><div class="line" id="223935"><span class="nick" style="color:#bc80bd"><a href="#223935" label="[22:39:35]">&lt;stikonas&gt;</a></span><span class="message">then we need to sort out libtool, which might be slightly annoying, but hopefully not too bad</span></div><div class="line" id="224000"><span class="nick" style="color:#bc80bd"><a href="#224000" label="[22:40:00]">&lt;stikonas&gt;</a></span><span class="message">and then I think we'll be getting close to building gcc</span></div><div class="line" id="224159"><span class="nick" style="color:#3c5b35"><a href="#224159" label="[22:41:59]">&lt;Hagfish&gt;</a></span><span class="message">i guess any step can throw in some weird hurdles, but yeah, it does sound like there's not much left before gcc</span></div><div class="line" id="224419"><span class="nick" style="color:#bc80bd"><a href="#224419" label="[22:44:19]">&lt;stikonas&gt;</a></span><span class="message">well, this perl issue, get newer autoconf/automake (hopefully relatively easy), libtool, then a few  trivial rebuilds and/or newer versions (gawk/sed)</span></div><div class="line" id="224504"><span class="nick" style="color:#bc80bd"><a href="#224504" label="[22:45:04]">&lt;stikonas&gt;</a></span><span class="message">and then gcc, which will require some work to cleanup and fix, but it does build</span></div><div class="line" id="225415"><span class="nick" style="color:#bc80bd"><a href="#225415" label="[22:54:15]">&lt;stikonas&gt;</a></span><span class="message">fossy: very small PR to add env to coreutils build <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/pull/59/files">https://github.com/fosslinux/live-bootstrap/pull/59/files</a> </span></div><div class="line" id="225421"><span class="nick" style="color:#bc80bd"><a href="#225421" label="[22:54:21]">&lt;stikonas&gt;</a></span><span class="message">this will be necessary for libtool</span></div><div class="line" id="225429"><span class="nick" style="color:#bc80bd"><a href="#225429" label="[22:54:29]">&lt;stikonas&gt;</a></span><span class="message">although, I don't know yet which libtool to target</span></div><div class="line" id="225450"><span class="nick" style="color:#bc80bd"><a href="#225450" label="[22:54:50]">&lt;stikonas&gt;</a></span><span class="message">I guess depends on whether pder can figure out an issue with perl</span></div><br /></div></body></html>