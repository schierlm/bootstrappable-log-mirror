<!DOCTYPE html><html><head><title>IRC channel logs</title><style>html {
  background: #fdfdfd;
}

h1 {
  font-weight: 300;
}

h2 {
  font-weight: 200;
}

h3 {
  padding: .5em 0;
  border-top: 3px dotted #ddd;
  margin-bottom: 0;
}

form {
  width: 400px;
  display: flex;
}

input {
  width: 100%;
  display: flex;
  border-radius: .25em 0 0 .25em;
  border: 1px solid #aaa;
  border-right: 0;
  padding: 0.5em;
}

button {
  display: flex;
  border-radius: 0 .25em .25em 0;
  background-color: #007bff;
  border: 1px solid #007bff;
  padding: .5em;
  cursor: pointer;
  color: white;
}

button:hover {
  background-color: #0069d9;
  border-color: #0062cc;
}

a {
  color: #007bff;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h4 {
  margin-bottom: .5em;
}

table td {
  padding: 0.75em;
}

table tr:hover {
  background: #eee;
}

.year {
  display: table;
}

.month {
  display: table-cell;
  padding-right: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style: none;
}

.nick {
  padding-right: 0.6rem;
  font-weight: bold;
  text-align: right;
  width: 13rem;
  display: table-cell;
}

.nick a {
  color: inherit;
  text-decoration: none;
}

.message {
  display: table-cell;
  padding-left: 0.6rem;
  border-left: 2px solid #333;
}

.notice {
  color: #859900;
  font-style: italic;
}

.line {
  line-height: 1.8rem;
  display: table;
}

#logs {
  margin-top: 1.5rem;
  padding: 1.5rem;
}
</style></head><body><h1>IRC channel logs</h1><h2>2021-01-17.log</h2><p><a href="/bootstrappable">back to list of logs</a></p><div id="logs"><div class="line" id="000019"><span class="nick" style="color:#389600"><a href="#000019" label="[00:00:19]">&lt;stikonas&gt;</a></span><span class="message">strange...</span></div><div class="line" id="000035"><span class="nick" style="color:#389600"><a href="#000035" label="[00:00:35]">&lt;stikonas&gt;</a></span><span class="message">something must be different...</span></div><div class="line" id="000043"><span class="nick" style="color:#389600"><a href="#000043" label="[00:00:43]">&lt;stikonas&gt;</a></span><span class="message">well, I only tested in chroot</span></div><div class="line" id="000106"><span class="nick" style="color:#389600"><a href="#000106" label="[00:01:06]">&lt;stikonas&gt;</a></span><span class="message">maybe because I had to inject busybox into /after/bin/sh</span></div><div class="line" id="000107"><span class="nick" style="color:#389600"><a href="#000107" label="[00:01:07]">&lt;stikonas&gt;</a></span><span class="message">hmm</span></div><div class="line" id="000153"><span class="nick" style="color:#389600"><a href="#000153" label="[00:01:53]">&lt;stikonas&gt;</a></span><span class="message">but anyway, we still need to somehow properly reach bash...</span></div><div class="line" id="005951"><span class="nick" style="color:#389600"><a href="#005951" label="[00:59:51]">&lt;stikonas&gt;</a></span><span class="message">fossy: I was looking a bit at musl now, any idea  if this error is fixable? src/signal/i386/sigsetjmp.s:8: error: invalid displacement    <a rel="nofollow" href="https://gitlab.com/giomasce/musl/-/blob/master/src/signal/i386/sigsetjmp.s">https://gitlab.com/giomasce/musl/-/blob/master/src/signal/i386/sigsetjmp.s</a> </span></div><div class="line" id="010013"><span class="nick" style="color:#389600"><a href="#010013" label="[01:00:13]">&lt;stikonas&gt;</a></span><span class="message">looks like it chokes on jecxz 1f</span></div><div class="line" id="010026"><span class="nick" style="color:#389600"><a href="#010026" label="[01:00:26]">&lt;stikonas&gt;</a></span><span class="message">but my assembly is not strong enough to fix this :(</span></div><div class="line" id="010154"><span class="nick" style="color:#389600"><a href="#010154" label="[01:01:54]">&lt;stikonas&gt;</a></span><span class="message">I guess 1f is offset for jumping</span></div><div class="line" id="013251"><span class="nick" style="color:#2e2a4a"><a href="#013251" label="[01:32:51]">&lt;siraben&gt;</a></span><span class="message">OriansJ: did my email properly send to the mailing list? I don't use mailing lists often so I may have just replied to you</span></div><div class="line" id="020712"><span class="nick" style="color:#6b8072"><a href="#020712" label="[02:07:12]">&lt;fossy&gt;</a></span><span class="message">stikonas: iirc it might have not worked under busybox but did under kaem</span></div><div class="line" id="020733"><span class="nick" style="color:#6b8072"><a href="#020733" label="[02:07:33]">&lt;fossy&gt;</a></span><span class="message">siraben: sorry my assembly is not very good either</span></div><div class="line" id="020804"><span class="nick" style="color:#389600"><a href="#020804" label="[02:08:04]">&lt;stikonas&gt;</a></span><span class="message">fossy: for now I replaced that jecxz with I think jm and then it compiles</span></div><div class="line" id="020827"><span class="nick" style="color:#6b8072"><a href="#020827" label="[02:08:27]">&lt;fossy&gt;</a></span><span class="message">stikonas: interesting</span></div><div class="line" id="020840"><span class="nick" style="color:#389600"><a href="#020840" label="[02:08:40]">&lt;stikonas&gt;</a></span><span class="message">but I don't know if it breaks something</span></div><div class="line" id="021055"><span class="nick" style="color:#389600"><a href="#021055" label="[02:10:55]">&lt;stikonas&gt;</a></span><span class="message">actually jecxz with jz</span></div><div class="line" id="021208"><span class="nick" style="color:#80b1d3"><a href="#021208" label="[02:12:08]">&lt;OriansJ&gt;</a></span><span class="message">siraben: yes it did, you can see it quite clearly in the archive <a rel="nofollow" href="https://www.freelists.org/post/bootstrappable/wipfullsourcebootstrap-from-a-357byte-hex0-to-hello">https://www.freelists.org/post/bootstrappable/wipfullsourcebootstrap-from-a-357byte-hex0-to-hello</a>,20 </span></div><div class="line" id="021249"><span class="nick" style="color:#2e2a4a"><a href="#021249" label="[02:12:49]">&lt;siraben&gt;</a></span><span class="message">OriansJ: Oh, thanks.</span></div><div class="line" id="021605"><span class="nick" style="color:#389600"><a href="#021605" label="[02:16:05]">&lt;stikonas&gt;</a></span><span class="message">fossy: so I think it might be possible to get musl compiled if that helps us at all...</span></div><div class="line" id="021632"><span class="nick" style="color:#389600"><a href="#021632" label="[02:16:32]">&lt;stikonas&gt;</a></span><span class="message">(I don't have any proper scripts yet, most of my testing was manual)</span></div><div class="line" id="021928"><span class="nick" style="color:#6b8072"><a href="#021928" label="[02:19:28]">&lt;fossy&gt;</a></span><span class="message">stikonas: that would be useful....</span></div><div class="line" id="021937"><span class="nick" style="color:#6b8072"><a href="#021937" label="[02:19:37]">&lt;fossy&gt;</a></span><span class="message">yeah it would</span></div><div class="line" id="021945"><span class="nick" style="color:#6b8072"><a href="#021945" label="[02:19:45]">&lt;fossy&gt;</a></span><span class="message">more complete than mes c library</span></div><div class="line" id="022102"><span class="nick" style="color:#389600"><a href="#022102" label="[02:21:02]">&lt;stikonas&gt;</a></span><span class="message">fossy: so for now I did the following</span></div><div class="line" id="022108"><span class="nick" style="color:#389600"><a href="#022108" label="[02:21:08]">&lt;stikonas&gt;</a></span><span class="message">added <a rel="nofollow" href="https://gitlab.com/giomasce/musl/">https://gitlab.com/giomasce/musl/</a>  to my chroot</span></div><div class="line" id="022132"><span class="nick" style="color:#389600"><a href="#022132" label="[02:21:32]">&lt;stikonas&gt;</a></span><span class="message">configured it with CC=tcc AR=&quot;tcc -ar&quot; sh ./configure --target=i386</span></div><div class="line" id="022155"><span class="nick" style="color:#389600"><a href="#022155" label="[02:21:55]">&lt;stikonas&gt;</a></span><span class="message">but I guess without shell we can still pre-create configuration include file</span></div><div class="line" id="022202"><span class="nick" style="color:#389600"><a href="#022202" label="[02:22:02]">&lt;stikonas&gt;</a></span><span class="message">it's fairly simple</span></div><div class="line" id="022234"><span class="nick" style="color:#389600"><a href="#022234" label="[02:22:34]">&lt;stikonas&gt;</a></span><span class="message">then removed src/complex src/fenv, patched that sigsetjmp.s file</span></div><div class="line" id="022239"><span class="nick" style="color:#389600"><a href="#022239" label="[02:22:39]">&lt;stikonas&gt;</a></span><span class="message">and ran make CFLAGS+=&quot;-DSYSCALL_NO_TLS&quot;</span></div><div class="line" id="022308"><span class="nick" style="color:#6b8072"><a href="#022308" label="[02:23:08]">&lt;fossy&gt;</a></span><span class="message">stikonas: is it autotools or no</span></div><div class="line" id="022309"><span class="nick" style="color:#389600"><a href="#022309" label="[02:23:09]">&lt;stikonas&gt;</a></span><span class="message">this needed some manual help due to missing coreutils</span></div><div class="line" id="022313"><span class="nick" style="color:#389600"><a href="#022313" label="[02:23:13]">&lt;stikonas&gt;</a></span><span class="message">fossy: no, it's not autotools</span></div><div class="line" id="022318"><span class="nick" style="color:#389600"><a href="#022318" label="[02:23:18]">&lt;stikonas&gt;</a></span><span class="message">manually written configure file</span></div><div class="line" id="022328"><span class="nick" style="color:#6b8072"><a href="#022328" label="[02:23:28]">&lt;fossy&gt;</a></span><span class="message">ooh</span></div><div class="line" id="022346"><span class="nick" style="color:#389600"><a href="#022346" label="[02:23:46]">&lt;stikonas&gt;</a></span><span class="message">which creates about 20 line config.mak file with variables</span></div><div class="line" id="022353"><span class="nick" style="color:#389600"><a href="#022353" label="[02:23:53]">&lt;stikonas&gt;</a></span><span class="message">CFLAGS, prefix, etc...</span></div><div class="line" id="022355"><span class="nick" style="color:#6b8072"><a href="#022355" label="[02:23:55]">&lt;fossy&gt;</a></span><span class="message">what if we used heirloom bash</span></div><div class="line" id="022405"><span class="nick" style="color:#389600"><a href="#022405" label="[02:24:05]">&lt;stikonas&gt;</a></span><span class="message">if we can build it...</span></div><div class="line" id="022410"><span class="nick" style="color:#6b8072"><a href="#022410" label="[02:24:10]">&lt;fossy&gt;</a></span><span class="message">yeah</span></div><div class="line" id="022411"><span class="nick" style="color:#389600"><a href="#022411" label="[02:24:11]">&lt;stikonas&gt;</a></span><span class="message">it might depend on those wchars...</span></div><div class="line" id="022421"><span class="nick" style="color:#389600"><a href="#022421" label="[02:24:21]">&lt;stikonas&gt;</a></span><span class="message">but that configure script is not essential</span></div><div class="line" id="022427"><span class="nick" style="color:#6b8072"><a href="#022427" label="[02:24:27]">&lt;fossy&gt;</a></span><span class="message">grr wchar</span></div><div class="line" id="022434"><span class="nick" style="color:#389600"><a href="#022434" label="[02:24:34]">&lt;stikonas&gt;</a></span><span class="message">well, musl has it</span></div><div class="line" id="022437"><span class="nick" style="color:#6b8072"><a href="#022437" label="[02:24:37]">&lt;fossy&gt;</a></span><span class="message">is it still segfaulting</span></div><div class="line" id="022744"><span class="nick" style="color:#389600"><a href="#022744" label="[02:27:44]">&lt;stikonas&gt;</a></span><span class="message">what is segfaulting?</span></div><div class="line" id="022752"><span class="nick" style="color:#389600"><a href="#022752" label="[02:27:52]">&lt;stikonas&gt;</a></span><span class="message">fossy: config.mak is like this <a rel="nofollow" href="https://paste.debian.net/1181439/">https://paste.debian.net/1181439/</a> </span></div><div class="line" id="022824"><span class="nick" style="color:#6b8072"><a href="#022824" label="[02:28:24]">&lt;fossy&gt;</a></span><span class="message">stikonas: yacc was segfaulting right</span></div><div class="line" id="022901"><span class="nick" style="color:#6b8072"><a href="#022901" label="[02:29:01]">&lt;fossy&gt;</a></span><span class="message">or just failing?</span></div><div class="line" id="022921"><span class="nick" style="color:#389600"><a href="#022921" label="[02:29:21]">&lt;stikonas&gt;</a></span><span class="message">well, linking was failing</span></div><div class="line" id="022928"><span class="nick" style="color:#389600"><a href="#022928" label="[02:29:28]">&lt;stikonas&gt;</a></span><span class="message">some missing symbols</span></div><div class="line" id="022934"><span class="nick" style="color:#389600"><a href="#022934" label="[02:29:34]">&lt;stikonas&gt;</a></span><span class="message">I probably need to intall musl more properly...</span></div><div class="line" id="022945"><span class="nick" style="color:#389600"><a href="#022945" label="[02:29:45]">&lt;stikonas&gt;</a></span><span class="message">although, I think I was able to recompile libtcc.a and tcc</span></div><div class="line" id="022951"><span class="nick" style="color:#389600"><a href="#022951" label="[02:29:51]">&lt;stikonas&gt;</a></span><span class="message">and then use it to recompile musl again</span></div><div class="line" id="023003"><span class="nick" style="color:#389600"><a href="#023003" label="[02:30:03]">&lt;stikonas&gt;</a></span><span class="message">but I failed to compile hello world...</span></div><div class="line" id="023010"><span class="nick" style="color:#389600"><a href="#023010" label="[02:30:10]">&lt;stikonas&gt;</a></span><span class="message">so some more investigation is needed...</span></div><div class="line" id="023014"><span class="nick" style="color:#389600"><a href="#023014" label="[02:30:14]">&lt;stikonas&gt;</a></span><span class="message">but I think it's possible</span></div><div class="line" id="023058"><span class="nick" style="color:#389600"><a href="#023058" label="[02:30:58]">&lt;stikonas&gt;</a></span><span class="message">but this is unpatched yacc...</span></div><div class="line" id="023111"><span class="nick" style="color:#389600"><a href="#023111" label="[02:31:11]">&lt;stikonas&gt;</a></span><span class="message">anyway, I'm going to bed now...</span></div><div class="line" id="064547"><span class="nick" style="color:#6d2462"><a href="#064547" label="[06:45:47]">&lt;deesix&gt;</a></span><span class="message">OriansJ, yt_, I'm switching more archs to M2libc in M2-Planet tests (just saying to avoid duplicated work).</span></div><div class="line" id="104201"><span class="nick" style="color:#234e69"><a href="#104201" label="[10:42:01]">&lt;bauen1&gt;</a></span><span class="message">fossy: currently the only syscall supported is exit, i'm working on a proper process model and the open syscall, bash requires quite a few different syscalls (mostly related to process groups) so i'm not sure</span></div><div class="line" id="104246"><span class="nick" style="color:#234e69"><a href="#104246" label="[10:42:46]">&lt;bauen1&gt;</a></span><span class="message">fossy: if you can give me a list of syscalls (normally) used i can tell you if it is feasible to implement without bloating the kernel</span></div><div class="line" id="110239"><span class="nick" style="color:#6b8072"><a href="#110239" label="[11:02:39]">&lt;fossy&gt;</a></span><span class="message">bauen1: okey</span></div><div class="line" id="110313"><span class="nick" style="color:#6b8072"><a href="#110313" label="[11:03:13]">&lt;fossy&gt;</a></span><span class="message">yeah it uses process groups quite siginificantly from strace</span></div><div class="line" id="110318"><span class="nick" style="color:#6b8072"><a href="#110318" label="[11:03:18]">&lt;fossy&gt;</a></span><span class="message">also the rt_* family (idk what that is)</span></div><div class="line" id="110323"><span class="nick" style="color:#6b8072"><a href="#110323" label="[11:03:23]">&lt;fossy&gt;</a></span><span class="message">then mostlry read and write</span></div><div class="line" id="110328"><span class="nick" style="color:#6b8072"><a href="#110328" label="[11:03:28]">&lt;fossy&gt;</a></span><span class="message">not very feasible</span></div><div class="line" id="110516"><span class="nick" style="color:#6b8072"><a href="#110516" label="[11:05:16]">&lt;fossy&gt;</a></span><span class="message">stikonas[m]: i see two options for flex/bison</span></div><div class="line" id="110551"><span class="nick" style="color:#6b8072"><a href="#110551" label="[11:05:51]">&lt;fossy&gt;</a></span><span class="message">1. musl (full) or just src/multibyte make it into a library then nbs</span></div><div class="line" id="110556"><span class="nick" style="color:#6b8072"><a href="#110556" label="[11:05:56]">&lt;fossy&gt;</a></span><span class="message">2. use older versions of flex</span></div><div class="line" id="113517"><span class="nick" style="color:#234e69"><a href="#113517" label="[11:35:17]">&lt;bauen1&gt;</a></span><span class="message">fossy: it kind of depends on how much you can patch out (while retaining critical functionality) tbh, implementing stub syscalls that just return -EPERM (or similiar) is also very easy</span></div><div class="line" id="113541"><span class="nick" style="color:#234e69"><a href="#113541" label="[11:35:41]">&lt;bauen1&gt;</a></span><span class="message">fossy: but yes, it will be a bit before i start to think about process groups, job control or controlling terminals</span></div><div class="line" id="114900"><span class="nick" style="color:#6c3d55"><a href="#114900" label="[11:49:00]">&lt;stikonas[m]&gt;</a></span><span class="message">I think I'll try to get full musl first...</span></div><div class="line" id="115021"><span class="nick" style="color:#6c3d55"><a href="#115021" label="[11:50:21]">&lt;stikonas[m]&gt;</a></span><span class="message">We don't really need interactive terminal for bootstrap kernel</span></div><div class="line" id="115626"><span class="nick" style="color:#6c3d55"><a href="#115626" label="[11:56:26]">&lt;stikonas[m]&gt;</a></span><span class="message">fossy: since older version of heirloom flex might not be able to bootstrap flex. Although, if full musl fails, that's an option</span></div><div class="line" id="115743"><span class="nick" style="color:#6c3d55"><a href="#115743" label="[11:57:43]">&lt;stikonas[m]&gt;</a></span><span class="message">Hmm, for musl i need at least mkdir and rm...</span></div><div class="line" id="120052"><span class="nick" style="color:#d9d9d9"><a href="#120052" label="[12:00:52]">&lt;malina&gt;</a></span><span class="message">stikonas[m], kinda funny, I am building/bootstrapping my musl lfs now, (4 years since I did the original glibc one) and I came across some of your comments or repo and so on. where you mentuoenc heirloom. I happened to compile it myself just some hours ago but for different reasons. I didn't have tr even so kernel headers wouln'd install :D</span></div><div class="line" id="120111"><span class="nick" style="color:#d9d9d9"><a href="#120111" label="[12:01:11]">&lt;malina&gt;</a></span><span class="message">I am trying to keep the toolchain set as minimal as possible so I grabbed the tr from heirloom and compiled that :)</span></div><div class="line" id="120138"><span class="nick" style="color:#d9d9d9"><a href="#120138" label="[12:01:38]">&lt;malina&gt;</a></span><span class="message">the flex however, failed iirc. but I didn't realyl poke around much in it [heirloom] right now.</span></div><div class="line" id="120252"><span class="nick" style="color:#d9d9d9"><a href="#120252" label="[12:02:52]">&lt;malina&gt;</a></span><span class="message">being totally new to musl so. but by the time I return to the heirloom , I am sure you troopers are already far ahead again</span></div><div class="line" id="120336"><span class="nick" style="color:#6c3d55"><a href="#120336" label="[12:03:36]">&lt;stikonas[m]&gt;</a></span><span class="message">Can't be me, I've never heard about heirloom even 3 days ago</span></div><div class="line" id="120641"><span class="nick" style="color:#d9d9d9"><a href="#120641" label="[12:06:41]">&lt;malina&gt;</a></span><span class="message">OH, it seemed from above you are giomarco or something?</span></div><div class="line" id="120646"><span class="nick" style="color:#d9d9d9"><a href="#120646" label="[12:06:46]">&lt;malina&gt;</a></span><span class="message">or is that fossy perhaps?</span></div><div class="line" id="120715"><span class="nick" style="color:#d9d9d9"><a href="#120715" label="[12:07:15]">&lt;malina&gt;</a></span><span class="message">suckless/heirloom/bb/toybox , all KISS.</span></div><div class="line" id="121130"><span class="nick" style="color:#d9d9d9"><a href="#121130" label="[12:11:30]">&lt;malina&gt;</a></span><span class="message">[02:21:08]  &lt;stikonas&gt; added <a rel="nofollow" href="https://gitlab.com/giomasce/musl/">https://gitlab.com/giomasce/musl/</a>  to my chroot &lt;- I guess this was it, and I misunderstood lol :)</span></div><div class="line" id="121230"><span class="nick" style="color:#6c3d55"><a href="#121230" label="[12:12:30]">&lt;stikonas[m]&gt;</a></span><span class="message">Well, by added I meant just cp -r</span></div><div class="line" id="121553"><span class="nick">***</span><span class="message notice">ChanServ sets mode: +o rekado_</span></div><div class="line" id="121555"><span class="nick">***</span><span class="message notice">rekado_ is now known as rekado</span></div><div class="line" id="121648"><span class="nick" style="color:#d9d9d9"><a href="#121648" label="[12:16:48]">&lt;malina&gt;</a></span><span class="message">ya, I ddn't check, was just saw 'giomasce' then came across it later today myself bychance, since im doing finally a musl strap. nvm.</span></div><div class="line" id="121750"><span class="nick" style="color:#6b8072"><a href="#121750" label="[12:17:50]">&lt;fossy&gt;</a></span><span class="message">stikonas[m]: i mean older versions of GNU flex</span></div><div class="line" id="121939"><span class="nick" style="color:#6c3d55"><a href="#121939" label="[12:19:39]">&lt;stikonas[m]&gt;</a></span><span class="message">Hmm, maybe...</span></div><div class="line" id="122002"><span class="nick" style="color:#6c3d55"><a href="#122002" label="[12:20:02]">&lt;stikonas[m]&gt;</a></span><span class="message">Anyway my testing yesterday showed that musl might be feasible</span></div><div class="line" id="122025"><span class="nick" style="color:#6c3d55"><a href="#122025" label="[12:20:25]">&lt;stikonas[m]&gt;</a></span><span class="message">Though, it is quite a bit of work</span></div><div class="line" id="122047"><span class="nick" style="color:#6c3d55"><a href="#122047" label="[12:20:47]">&lt;stikonas[m]&gt;</a></span><span class="message">And I need to understand implications of jecxz better...</span></div><div class="line" id="133948"><span class="nick" style="color:#bc80bd"><a href="#133948" label="[13:39:48]">&lt;Hagfish&gt;</a></span><span class="message">i know javascript tooling written in rust isn't an obvious topic for this channel, but i'm starting to be impressed with how Deno is replacing NodeJS</span></div><div class="line" id="134030"><span class="nick" style="color:#bc80bd"><a href="#134030" label="[13:40:30]">&lt;Hagfish&gt;</a></span><span class="message">they had an interesting failure mode in terms of bootstrapping, which they hint at in this blog post: <a rel="nofollow" href="https://deno.land/posts/registry2">https://deno.land/posts/registry2</a> </span></div><div class="line" id="134106"><span class="nick" style="color:#bc80bd"><a href="#134106" label="[13:41:06]">&lt;Hagfish&gt;</a></span><span class="message">it's something that is often taken for granted, but somehow they had managed to get wrong in their v1.0 design</span></div><div class="line" id="134204"><span class="nick" style="color:#bc80bd"><a href="#134204" label="[13:42:04]">&lt;Hagfish&gt;</a></span><span class="message">basically, all dependencies would be defined as just a package name, without a specific version, and even when you specified a version, there's no guarantee that the code associated with that version wouldn't change</span></div><div class="line" id="134209"><span class="nick" style="color:#bc80bd"><a href="#134209" label="[13:42:09]">&lt;Hagfish&gt;</a></span><span class="message">complete madness</span></div><div class="line" id="134231"><span class="nick" style="color:#bc80bd"><a href="#134231" label="[13:42:31]">&lt;Hagfish&gt;</a></span><span class="message">but now they guarantee: &quot;All files served from the registry are immutable. They can not be changed or removed by the package author.&quot;</span></div><div class="line" id="134259"><span class="nick" style="color:#bc80bd"><a href="#134259" label="[13:42:59]">&lt;Hagfish&gt;</a></span><span class="message">(at the cost of centralisation, although in principle it should be possible to host your own registry)</span></div><div class="line" id="134351"><span class="nick" style="color:#bc80bd"><a href="#134351" label="[13:43:51]">&lt;Hagfish&gt;</a></span><span class="message">and they plan to improve things further: &quot;Give all modules a score based on ... are dependencies pinned to specific version&quot;</span></div><div class="line" id="134502"><span class="nick" style="color:#bc80bd"><a href="#134502" label="[13:45:02]">&lt;Hagfish&gt;</a></span><span class="message">it'll be interesting to see how well packages deal with security vulnerabilities in their (transitive) dependencies</span></div><div class="line" id="134628"><span class="nick" style="color:#bc80bd"><a href="#134628" label="[13:46:28]">&lt;Hagfish&gt;</a></span><span class="message">i don't think they have an equivalent of &quot;npm audit&quot; yet, or a culture of packages updating their dependencies to non-vulnerable versions</span></div><div class="line" id="134727"><span class="nick" style="color:#bc80bd"><a href="#134727" label="[13:47:27]">&lt;Hagfish&gt;</a></span><span class="message">there's also the question of whether packages backport security fixes to old versions, or if the solution for a vulnerability in version 3.x is to upgrade to version 8.y</span></div><div class="line" id="134909"><span class="nick" style="color:#bc80bd"><a href="#134909" label="[13:49:09]">&lt;Hagfish&gt;</a></span><span class="message">maybe next year it will be clearer what the engineering culture is like in that ecosystem, and whether the packages available are enough to base any serious projects on</span></div><div class="line" id="135212"><span class="nick" style="color:#389600"><a href="#135212" label="[13:52:12]">&lt;stikonas&gt;</a></span><span class="message">ok, finally got some more progress on live-bootstrap, although, on slightly orthogonal thing. grep seems to build fine</span></div><div class="line" id="140138"><span class="nick" style="color:#389600"><a href="#140138" label="[14:01:38]">&lt;stikonas&gt;</a></span><span class="message">(and somewhat newer than guix in commencement.scm, got 2.4 working rather than 2.0)</span></div><div class="line" id="140922"><span class="nick" style="color:#389600"><a href="#140922" label="[14:09:22]">&lt;stikonas&gt;</a></span><span class="message">bauen1: so maybe then we build bash later, not in bootsrap kernel. but do you know if it would be possible to easily reboot into newly compiled kernel?</span></div><div class="line" id="140929"><span class="nick" style="color:#389600"><a href="#140929" label="[14:09:29]">&lt;stikonas&gt;</a></span><span class="message">bauen1: something like kexec?</span></div><div class="line" id="145221"><span class="nick" style="color:#3c5b35"><a href="#145221" label="[14:52:21]">&lt;Profpatsch&gt;</a></span><span class="message">Hagfish: are they just making all the golang mistakes all over again?</span></div><div class="line" id="145228"><span class="nick" style="color:#3c5b35"><a href="#145228" label="[14:52:28]">&lt;Profpatsch&gt;</a></span><span class="message">Combined with all npm mistakes I assume</span></div><div class="line" id="150317"><span class="nick" style="color:#af8d2f"><a href="#150317" label="[15:03:17]">&lt;gforce_d11977&gt;</a></span><span class="message">fossy: are you there? i have a proposal for CI-integration of live-bootstrap: question: i will introduce an ARG1 of 'CI', which does the things -&gt; (./rootfs CI) - are you OK with this approach?</span></div><div class="line" id="150337"><span class="nick" style="color:#af8d2f"><a href="#150337" label="[15:03:37]">&lt;gforce_d11977&gt;</a></span><span class="message">(I'm preparing the pull request)</span></div><div class="line" id="165831"><span class="nick" style="color:#bc80bd"><a href="#165831" label="[16:58:31]">&lt;Hagfish&gt;</a></span><span class="message">Profpatsch: yup, it seems like it, except they are also trying to fix them.  maybe that's easier with a newer ecosystem, although it would have been easier not to make the mistakes in the first place</span></div><div class="line" id="172213"><span class="nick" style="color:#af8d2f"><a href="#172213" label="[17:22:13]">&lt;gforce_d11977&gt;</a></span><span class="message">fossy: i have problems starting 'init' from your live-boot in a x86_64 qemu-instance. &quot;file init&quot; says it is &quot;ELF 32-bit LSB executable, Intel 80386, version 1&quot;, maybe this is the underlying problem?</span></div><div class="line" id="172247"><span class="nick" style="color:#af8d2f"><a href="#172247" label="[17:22:47]">&lt;gforce_d11977&gt;</a></span><span class="message">fossy: Run /init as init process -&gt; Failed to execute /init (error -8)</span></div><div class="line" id="172947"><span class="nick" style="color:#389600"><a href="#172947" label="[17:29:47]">&lt;stikonas&gt;</a></span><span class="message">gforce_d11977: hmm, it works fine here</span></div><div class="line" id="173032"><span class="nick" style="color:#389600"><a href="#173032" label="[17:30:32]">&lt;stikonas&gt;</a></span><span class="message">init is indeed 32-bit variable</span></div><div class="line" id="173039"><span class="nick" style="color:#389600"><a href="#173039" label="[17:30:39]">&lt;stikonas&gt;</a></span><span class="message">s/variable/executable</span></div><div class="line" id="173046"><span class="nick" style="color:#389600"><a href="#173046" label="[17:30:46]">&lt;stikonas&gt;</a></span><span class="message">(it's kaem seed)</span></div><div class="line" id="173120"><span class="nick" style="color:#af8d2f"><a href="#173120" label="[17:31:20]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: i &quot;compiled&quot; the AMD64 hex0 kaem and will test (fingers crossed!)</span></div><div class="line" id="173203"><span class="nick" style="color:#389600"><a href="#173203" label="[17:32:03]">&lt;stikonas&gt;</a></span><span class="message">well, I only tried AMD64 manually on mescc-tools-seed</span></div><div class="line" id="173208"><span class="nick" style="color:#389600"><a href="#173208" label="[17:32:08]">&lt;stikonas&gt;</a></span><span class="message">not in live-environment</span></div><div class="line" id="173215"><span class="nick" style="color:#389600"><a href="#173215" label="[17:32:15]">&lt;stikonas&gt;</a></span><span class="message">x86 binary is smaller anyway</span></div><div class="line" id="173229"><span class="nick" style="color:#389600"><a href="#173229" label="[17:32:29]">&lt;stikonas&gt;</a></span><span class="message">and x86 should just run on x86_64</span></div><div class="line" id="173407"><span class="nick" style="color:#389600"><a href="#173407" label="[17:34:07]">&lt;stikonas&gt;</a></span><span class="message">fossy: grep is ready <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/pull/15">https://github.com/fosslinux/live-bootstrap/pull/15</a> </span></div><div class="line" id="173414"><span class="nick" style="color:#389600"><a href="#173414" label="[17:34:14]">&lt;stikonas&gt;</a></span><span class="message">I inserted it before bash</span></div><div class="line" id="173437"><span class="nick" style="color:#389600"><a href="#173437" label="[17:34:37]">&lt;stikonas&gt;</a></span><span class="message">since bash is so heavy on syscalls, it might be easier later to do more stuff earlier on bootstrap kernel if we insert it before bash...</span></div><div class="line" id="173729"><span class="nick" style="color:#af8d2f"><a href="#173729" label="[17:37:29]">&lt;gforce_d11977&gt;</a></span><span class="message">wow, now further progress on QEMU, there seems to be more wrong than just init. init now works, but i get:</span></div><div class="line" id="173758"><span class="nick" style="color:#af8d2f"><a href="#173758" label="[17:37:58]">&lt;gforce_d11977&gt;</a></span><span class="message">Run /init as init process +&gt; ./bootstrap-seeds/POSIX/x86/kaem-optional-seed mescc-tools-srandom: fast init done</span></div><div class="line" id="173801"><span class="nick" style="color:#af8d2f"><a href="#173801" label="[17:38:01]">&lt;gforce_d11977&gt;</a></span><span class="message">eed.kaem.run</span></div><div class="line" id="173804"><span class="nick" style="color:#af8d2f"><a href="#173804" label="[17:38:04]">&lt;gforce_d11977&gt;</a></span><span class="message">Subprocess error</span></div><div class="line" id="173806"><span class="nick" style="color:#af8d2f"><a href="#173806" label="[17:38:06]">&lt;gforce_d11977&gt;</a></span><span class="message">ABORTING HARD</span></div><div class="line" id="173809"><span class="nick" style="color:#af8d2f"><a href="#173809" label="[17:38:09]">&lt;gforce_d11977&gt;</a></span><span class="message">Kernel panic - not syncing: Attempted to kill init! exitcode=0x00000100</span></div><div class="line" id="173818"><span class="nick" style="color:#389600"><a href="#173818" label="[17:38:18]">&lt;stikonas&gt;</a></span><span class="message">well, non-zero exit code</span></div><div class="line" id="173831"><span class="nick" style="color:#389600"><a href="#173831" label="[17:38:31]">&lt;stikonas&gt;</a></span><span class="message">random: fast init done is unrelated</span></div><div class="line" id="173841"><span class="nick" style="color:#389600"><a href="#173841" label="[17:38:41]">&lt;stikonas&gt;</a></span><span class="message">that printk from kernel that just happened to be printed at the same time</span></div><div class="line" id="173908"><span class="nick" style="color:#389600"><a href="#173908" label="[17:39:08]">&lt;stikonas&gt;</a></span><span class="message">gforce_d11977: I think you need to look at why your qemu fails to run 32 bit binaries...</span></div><div class="line" id="173911"><span class="nick" style="color:#389600"><a href="#173911" label="[17:39:11]">&lt;stikonas&gt;</a></span><span class="message">or maybe your kernel?</span></div><div class="line" id="173918"><span class="nick" style="color:#389600"><a href="#173918" label="[17:39:18]">&lt;stikonas&gt;</a></span><span class="message">that's probably more likely</span></div><div class="line" id="174901"><span class="nick" style="color:#af8d2f"><a href="#174901" label="[17:49:01]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: the error is not on my side 8-)</span></div><div class="line" id="174938"><span class="nick" style="color:#af8d2f"><a href="#174938" label="[17:49:38]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: when i just run on my laptop: bootstrap-seeds/POSIX/x86/kaem-optional-seed mescc-tools-seed.kaem.run</span></div><div class="line" id="174952"><span class="nick" style="color:#af8d2f"><a href="#174952" label="[17:49:52]">&lt;gforce_d11977&gt;</a></span><span class="message">i get:  +&gt; ../bootstrap-seeds/POSIX/x86/kaem-optional-seed mescc-tools-seed-kaem.kaem</span></div><div class="line" id="174955"><span class="nick" style="color:#af8d2f"><a href="#174955" label="[17:49:55]">&lt;gforce_d11977&gt;</a></span><span class="message">Subprocess error</span></div><div class="line" id="174957"><span class="nick" style="color:#af8d2f"><a href="#174957" label="[17:49:57]">&lt;gforce_d11977&gt;</a></span><span class="message">ABORTING HARD</span></div><div class="line" id="175024"><span class="nick" style="color:#af8d2f"><a href="#175024" label="[17:50:24]">&lt;gforce_d11977&gt;</a></span><span class="message">(laptop is x86_64)</span></div><div class="line" id="175057"><span class="nick" style="color:#af8d2f"><a href="#175057" label="[17:50:57]">&lt;gforce_d11977&gt;</a></span><span class="message">in theory 32bit binaries should not be a problem, i know...</span></div><div class="line" id="175300"><span class="nick" style="color:#af8d2f"><a href="#175300" label="[17:53:00]">&lt;gforce_d11977&gt;</a></span><span class="message">the error is strange and i a chroot the live-bootstrap works for me, but the real test (a minimal x86_64 qemu) should also work</span></div><div class="line" id="175402"><span class="nick" style="color:#af8d2f"><a href="#175402" label="[17:54:02]">&lt;gforce_d11977&gt;</a></span><span class="message">fossy: do you test in qemu or chroot? for the qemu-case: what is your kernel .config?</span></div><div class="line" id="175548"><span class="nick" style="color:#389600"><a href="#175548" label="[17:55:48]">&lt;stikonas&gt;</a></span><span class="message">I think both fossy and I use both qemu and chroot</span></div><div class="line" id="175856"><span class="nick" style="color:#af8d2f"><a href="#175856" label="[17:58:56]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: your kernel .config?</span></div><div class="line" id="175919"><span class="nick" style="color:#389600"><a href="#175919" label="[17:59:19]">&lt;stikonas&gt;</a></span><span class="message">one moment</span></div><div class="line" id="175926"><span class="nick" style="color:#389600"><a href="#175926" label="[17:59:26]">&lt;stikonas&gt;</a></span><span class="message">but first check if you have enabled</span></div><div class="line" id="175934"><span class="nick" style="color:#389600"><a href="#175934" label="[17:59:34]">&lt;stikonas&gt;</a></span><span class="message">CONFIG_IA32_EMULATION</span></div><div class="line" id="175949"><span class="nick" style="color:#af8d2f"><a href="#175949" label="[17:59:49]">&lt;gforce_d11977&gt;</a></span><span class="message">no, i have not enable CONFIG_IA32_EMULATION</span></div><div class="line" id="175956"><span class="nick" style="color:#389600"><a href="#175956" label="[17:59:56]">&lt;stikonas&gt;</a></span><span class="message">ok, that's the reason</span></div><div class="line" id="175956"><span class="nick" style="color:#af8d2f"><a href="#175956" label="[17:59:56]">&lt;gforce_d11977&gt;</a></span><span class="message">ok...will do</span></div><div class="line" id="180003"><span class="nick" style="color:#389600"><a href="#180003" label="[18:00:03]">&lt;stikonas&gt;</a></span><span class="message">you need it to run 32 bit binaries</span></div><div class="line" id="180059"><span class="nick" style="color:#389600"><a href="#180059" label="[18:00:59]">&lt;stikonas&gt;</a></span><span class="message"> <a rel="nofollow" href="https://cateee.net/lkddb/web-lkddb/IA32_EMULATION.html">https://cateee.net/lkddb/web-lkddb/IA32_EMULATION.html</a> </span></div><div class="line" id="180107"><span class="nick" style="color:#389600"><a href="#180107" label="[18:01:07]">&lt;stikonas&gt;</a></span><span class="message">You should likely turn this on, unless you're 100% sure that you don't have any 32-bit programs left.</span></div><div class="line" id="180203"><span class="nick" style="color:#af8d2f"><a href="#180203" label="[18:02:03]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: thank you, i did not know this, i was always thinking, the CPU handles it automatically</span></div><div class="line" id="180250"><span class="nick" style="color:#389600"><a href="#180250" label="[18:02:50]">&lt;stikonas&gt;</a></span><span class="message">well, running executables involves both kernel and CPU</span></div><div class="line" id="180258"><span class="nick" style="color:#389600"><a href="#180258" label="[18:02:58]">&lt;stikonas&gt;</a></span><span class="message">so both have to support it</span></div><div class="line" id="180416"><span class="nick" style="color:#af8d2f"><a href="#180416" label="[18:04:16]">&lt;gforce_d11977&gt;</a></span><span class="message">(*IT*DOES*RUN*DANCING*ON*THE*TABLE*)</span></div><div class="line" id="180516"><span class="nick" style="color:#af8d2f"><a href="#180516" label="[18:05:16]">&lt;gforce_d11977&gt;</a></span><span class="message">Tasks state (memory values in pages):</span></div><div class="line" id="180516"><span class="nick" style="color:#af8d2f"><a href="#180516" label="[18:05:16]">&lt;gforce_d11977&gt;</a></span><span class="message">[  pid  ]   uid  tgid total_vm      rss pgtables_bytes swapents oom_score_adj name</span></div><div class="line" id="180519"><span class="nick" style="color:#af8d2f"><a href="#180519" label="[18:05:19]">&lt;gforce_d11977&gt;</a></span><span class="message">[     72]     0    72      161      125    24576        0             0 kaem</span></div><div class="line" id="180522"><span class="nick" style="color:#af8d2f"><a href="#180522" label="[18:05:22]">&lt;gforce_d11977&gt;</a></span><span class="message">[     73]     0    73      402      365    28672        0             0 kaem</span></div><div class="line" id="180525"><span class="nick" style="color:#af8d2f"><a href="#180525" label="[18:05:25]">&lt;gforce_d11977&gt;</a></span><span class="message">[     92]     0    92     1108     1072    28672        0             0 kaem</span></div><div class="line" id="180528"><span class="nick" style="color:#af8d2f"><a href="#180528" label="[18:05:28]">&lt;gforce_d11977&gt;</a></span><span class="message">[    108]     0   108    33072    14238   143360        0             0 vm</span></div><div class="line" id="180531"><span class="nick" style="color:#af8d2f"><a href="#180531" label="[18:05:31]">&lt;gforce_d11977&gt;</a></span><span class="message">oom-kill:constraint=CONSTRAINT_NONE,nodemask=(null),task=vm,pid=108,uid=0</span></div><div class="line" id="180539"><span class="nick" style="color:#af8d2f"><a href="#180539" label="[18:05:39]">&lt;gforce_d11977&gt;</a></span><span class="message">8-))) how much RAM should be enough?</span></div><div class="line" id="180648"><span class="nick" style="color:#389600"><a href="#180648" label="[18:06:48]">&lt;stikonas&gt;</a></span><span class="message">well, VM requests 8 GB</span></div><div class="line" id="180655"><span class="nick" style="color:#389600"><a href="#180655" label="[18:06:55]">&lt;stikonas&gt;</a></span><span class="message">I don't think we use all 8 for now</span></div><div class="line" id="180706"><span class="nick" style="color:#389600"><a href="#180706" label="[18:07:06]">&lt;stikonas&gt;</a></span><span class="message">we are building minor stuff...</span></div><div class="line" id="180720"><span class="nick" style="color:#389600"><a href="#180720" label="[18:07:20]">&lt;stikonas&gt;</a></span><span class="message">gforce_d11977: how much RAM do you have?</span></div><div class="line" id="180729"><span class="nick" style="color:#af8d2f"><a href="#180729" label="[18:07:29]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: 128mb</span></div><div class="line" id="180730"><span class="nick" style="color:#389600"><a href="#180730" label="[18:07:30]">&lt;stikonas&gt;</a></span><span class="message">well, RAM is needed to store all sources...</span></div><div class="line" id="180732"><span class="nick" style="color:#389600"><a href="#180732" label="[18:07:32]">&lt;stikonas&gt;</a></span><span class="message">oh</span></div><div class="line" id="180735"><span class="nick" style="color:#389600"><a href="#180735" label="[18:07:35]">&lt;stikonas&gt;</a></span><span class="message">that's not enough</span></div><div class="line" id="180753"><span class="nick" style="color:#389600"><a href="#180753" label="[18:07:53]">&lt;stikonas&gt;</a></span><span class="message">where did you get a box with 128 MB ram?</span></div><div class="line" id="180753"><span class="nick" style="color:#af8d2f"><a href="#180753" label="[18:07:53]">&lt;gforce_d11977&gt;</a></span><span class="message">(for QEMU) - i have to raise this...</span></div><div class="line" id="180756"><span class="nick" style="color:#389600"><a href="#180756" label="[18:07:56]">&lt;stikonas&gt;</a></span><span class="message">oh</span></div><div class="line" id="180803"><span class="nick" style="color:#389600"><a href="#180803" label="[18:08:03]">&lt;stikonas&gt;</a></span><span class="message">yeah, I run it with 8</span></div><div class="line" id="180828"><span class="nick" style="color:#389600"><a href="#180828" label="[18:08:28]">&lt;stikonas&gt;</a></span><span class="message">compressed initramfs is already 13 MB</span></div><div class="line" id="180858"><span class="nick" style="color:#389600"><a href="#180858" label="[18:08:58]">&lt;stikonas&gt;</a></span><span class="message">then you need to unpack it + kernel</span></div><div class="line" id="180908"><span class="nick" style="color:#389600"><a href="#180908" label="[18:09:08]">&lt;stikonas&gt;</a></span><span class="message">and most of your ram is already used up before you even start bootstrapping</span></div><div class="line" id="184933"><span class="nick" style="color:#af8d2f"><a href="#184933" label="[18:49:33]">&lt;gforce_d11977&gt;</a></span><span class="message">wow:</span></div><div class="line" id="184936"><span class="nick" style="color:#af8d2f"><a href="#184936" label="[18:49:36]">&lt;gforce_d11977&gt;</a></span><span class="message">+&gt; cd tcc-0.9.26 +&gt; catm config.h +&gt; /after/bin/mes --no-auto-compile -e main /after/bin/mescc.scm -- -S -o tcc.s -I /after/mes/lib -I /after/mes/include -D BOOTSTRAP=1 -I .</span></div><div class="line" id="184940"><span class="nick" style="color:#af8d2f"><a href="#184940" label="[18:49:40]">&lt;gforce_d11977&gt;</a></span><span class="message">system-error: (&quot;No such file or directory&quot; . &quot;tcc.c&quot;)</span></div><div class="line" id="184943"><span class="nick" style="color:#af8d2f"><a href="#184943" label="[18:49:43]">&lt;gforce_d11977&gt;</a></span><span class="message">assert fail: ERROR</span></div><div class="line" id="184945"><span class="nick" style="color:#af8d2f"><a href="#184945" label="[18:49:45]">&lt;gforce_d11977&gt;</a></span><span class="message">mes[559]: segfault at 0 ip 00000000010187d4 sp 00000000ffbc3454 error 6 in mes[1000000+1b000]</span></div><div class="line" id="184948"><span class="nick" style="color:#af8d2f"><a href="#184948" label="[18:49:48]">&lt;gforce_d11977&gt;</a></span><span class="message">Code: 83 c4 04 85 c0 8b 45 08 89 45 fc b8 00 00 00 00 89 45 fc 85 c0 b8 00 00 00 00 bb 00 00 00 00 50 89 d8 8b 5d fc 01 d8 89 c3 58 &lt;88&gt; 03 80</span></div><div class="line" id="184952"><span class="nick" style="color:#af8d2f"><a href="#184952" label="[18:49:52]">&lt;gforce_d11977&gt;</a></span><span class="message">Subprocess error 11</span></div><div class="line" id="185010"><span class="nick" style="color:#af8d2f"><a href="#185010" label="[18:50:10]">&lt;gforce_d11977&gt;</a></span><span class="message">during live-bootstrap. is this known in that early stage?</span></div><div class="line" id="203441"><span class="nick" style="color:#234e69"><a href="#203441" label="[20:34:41]">&lt;bauen1&gt;</a></span><span class="message">stikonas: yes, you could implement something like kexec in myunix, or you could implement module loading, so you could have the core kernel very simple and then as you get tinycc available build + load more complex modules (like an journaled ext4 rw driver)</span></div><div class="line" id="203546"><span class="nick" style="color:#234e69"><a href="#203546" label="[20:35:46]">&lt;bauen1&gt;</a></span><span class="message">stikonas: it would probably be easiest to make myunix (or a similiar bootstrap kernel) capable of (cross) compiling (and all dependencies necessary) the linux kernel, glibc, bash, gcc, and other toolchain tools you need</span></div><div class="line" id="203644"><span class="nick" style="color:#234e69"><a href="#203644" label="[20:36:44]">&lt;bauen1&gt;</a></span><span class="message">stikonas: so you somehow get to myunix, then build the intermediate toolchain (in stages, starting from hex0 or something similiar) up until you receive a minimal linux system from which you can continue bootstrapping other things with potentially more complex feature requirements against the kernel (maybe utilising containers and other features if you want to)</span></div><div class="line" id="203710"><span class="nick" style="color:#234e69"><a href="#203710" label="[20:37:10]">&lt;bauen1&gt;</a></span><span class="message">stikonas: this minimal linux image could then serve as the base for distributions to compile their own distribution-specific (patched) toolchain</span></div><div class="line" id="203841"><span class="nick" style="color:#234e69"><a href="#203841" label="[20:38:41]">&lt;bauen1&gt;</a></span><span class="message">i personally would really like allowing modules to be loaded into the myunix kernel, care must be taken to ensure that there is no cross-contamination, but makes bootstrapping the bootstrap-kernel easier</span></div><div class="line" id="203918"><span class="nick" style="color:#234e69"><a href="#203918" label="[20:39:18]">&lt;bauen1&gt;</a></span><span class="message">while you can write a rw ext4 driver in (pseudo) assembly, it isn't very fun and probably harder to verify that it does the job correctly</span></div><div class="line" id="204054"><span class="nick" style="color:#234e69"><a href="#204054" label="[20:40:54]">&lt;bauen1&gt;</a></span><span class="message">in the end a modular to micro kernel might be the best thing for the bootstrap-kernel</span></div><div class="line" id="204315"><span class="nick" style="color:#389600"><a href="#204315" label="[20:43:15]">&lt;stikonas&gt;</a></span><span class="message">hmm, yeah, module system sounds nice</span></div><div class="line" id="204352"><span class="nick" style="color:#389600"><a href="#204352" label="[20:43:52]">&lt;stikonas&gt;</a></span><span class="message">we can probably reach tcc and some basic utils with fairly few syscalls</span></div><div class="line" id="204738"><span class="nick" style="color:#234e69"><a href="#204738" label="[20:47:38]">&lt;bauen1&gt;</a></span><span class="message">do keep in mind that myunix is an experiment of mine, so has some weird C code, e.g. using enums as error values, so while it can be compiled using tcc it might not be a good fit for bootstrapping</span></div><div class="line" id="205405"><span class="nick" style="color:#389600"><a href="#205405" label="[20:54:05]">&lt;stikonas&gt;</a></span><span class="message">well, we'll see...</span></div><div class="line" id="205416"><span class="nick" style="color:#389600"><a href="#205416" label="[20:54:16]">&lt;stikonas&gt;</a></span><span class="message">at first we can try to use some slimmed down linux kernel...</span></div><div class="line" id="205422"><span class="nick" style="color:#389600"><a href="#205422" label="[20:54:22]">&lt;stikonas&gt;</a></span><span class="message">with few modules</span></div><div class="line" id="205949"><span class="nick" style="color:#af8d2f"><a href="#205949" label="[20:59:49]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: my qemu-instance runs with an 'allnokonfig' kernel + 6 options (e.g. ELF + 32bit support 8-))</span></div><div class="line" id="210007"><span class="nick" style="color:#af8d2f"><a href="#210007" label="[21:00:07]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: so really slimmed down...</span></div><div class="line" id="210510"><span class="nick" style="color:#389600"><a href="#210510" label="[21:05:10]">&lt;stikonas&gt;</a></span><span class="message">ok, it might be worth documenting which options are needed</span></div><div class="line" id="210514"><span class="nick" style="color:#389600"><a href="#210514" label="[21:05:14]">&lt;stikonas&gt;</a></span><span class="message">how big is the kernel?</span></div><div class="line" id="211352"><span class="nick" style="color:#af8d2f"><a href="#211352" label="[21:13:52]">&lt;gforce_d11977&gt;</a></span><span class="message"> <a rel="nofollow" href="https://github.com/bittorf/GNU-mes-documentation-attempt/blob/main/kernel.bin">https://github.com/bittorf/GNU-mes-documentation-attempt/blob/main/kernel.bin</a> </span></div><div class="line" id="211422"><span class="nick" style="color:#af8d2f"><a href="#211422" label="[21:14:22]">&lt;gforce_d11977&gt;</a></span><span class="message">but it still has procfs,sysfs and printk support, so it can be around 300k smaller</span></div><div class="line" id="211444"><span class="nick" style="color:#af8d2f"><a href="#211444" label="[21:14:44]">&lt;gforce_d11977&gt;</a></span><span class="message">it's latest 5.10.8</span></div><div class="line" id="214708"><span class="nick" style="color:#af8d2f"><a href="#214708" label="[21:47:08]">&lt;gforce_d11977&gt;</a></span><span class="message">(but when it comes to small kernels, we can also boot an early 2.6kernel which boils down to ~300k</span></div><div class="line" id="215235"><span class="nick" style="color:#234e69"><a href="#215235" label="[21:52:35]">&lt;bauen1&gt;</a></span><span class="message">that's quite good, very close to ~280kb myunix currently uses if you disable debug informations</span></div><div class="line" id="220109"><span class="nick" style="color:#389600"><a href="#220109" label="[22:01:09]">&lt;stikonas&gt;</a></span><span class="message">linux kernel is probably compressed</span></div><div class="line" id="220614"><span class="nick" style="color:#6b8072"><a href="#220614" label="[22:06:14]">&lt;fossy&gt;</a></span><span class="message">gforce_d11977: please do document your config</span></div><div class="line" id="220626"><span class="nick" style="color:#6b8072"><a href="#220626" label="[22:06:26]">&lt;fossy&gt;</a></span><span class="message">if you could pastebin it I would be very ahppy</span></div><div class="line" id="220634"><span class="nick" style="color:#6b8072"><a href="#220634" label="[22:06:34]">&lt;fossy&gt;</a></span><span class="message">But it sounds like it is not working?</span></div><div class="line" id="220702"><span class="nick" style="color:#6b8072"><a href="#220702" label="[22:07:02]">&lt;fossy&gt;</a></span><span class="message">gforce_d11977: can you elaborate on how the CI would work?</span></div><div class="line" id="220715"><span class="nick" style="color:#6b8072"><a href="#220715" label="[22:07:15]">&lt;fossy&gt;</a></span><span class="message">I have a CI PR done.'m</span></div><div class="line" id="220821"><span class="nick" style="color:#6b8072"><a href="#220821" label="[22:08:21]">&lt;fossy&gt;</a></span><span class="message">stikonas: any progress on musl? all good if not</span></div><div class="line" id="220920"><span class="nick" style="color:#389600"><a href="#220920" label="[22:09:20]">&lt;stikonas&gt;</a></span><span class="message">fossy: kind of but indirect</span></div><div class="line" id="220933"><span class="nick" style="color:#389600"><a href="#220933" label="[22:09:33]">&lt;stikonas&gt;</a></span><span class="message">fossy: first of all I have grep (but that is a bit orthogonal)</span></div><div class="line" id="220938"><span class="nick" style="color:#389600"><a href="#220938" label="[22:09:38]">&lt;stikonas&gt;</a></span><span class="message">fossy: now I'm working on coreutils</span></div><div class="line" id="220941"><span class="nick" style="color:#af8d2f"><a href="#220941" label="[22:09:41]">&lt;gforce_d11977&gt;</a></span><span class="message">fossy: <a rel="nofollow" href="https://github.com/bittorf/GNU-mes-documentation-attempt/blob/main/build_qemu_image.sh">https://github.com/bittorf/GNU-mes-documentation-attempt/blob/main/build_qemu_image.sh</a> </span></div><div class="line" id="220942"><span class="nick" style="color:#389600"><a href="#220942" label="[22:09:42]">&lt;stikonas&gt;</a></span><span class="message">which will help with musl</span></div><div class="line" id="221004"><span class="nick" style="color:#389600"><a href="#221004" label="[22:10:04]">&lt;stikonas&gt;</a></span><span class="message">fossy: since musl build needs rm/mkdir, etc...</span></div><div class="line" id="221039"><span class="nick" style="color:#af8d2f"><a href="#221039" label="[22:10:39]">&lt;gforce_d11977&gt;</a></span><span class="message">fossy: this is about the CI integration</span></div><div class="line" id="221126"><span class="nick" style="color:#af8d2f"><a href="#221126" label="[22:11:26]">&lt;gforce_d11977&gt;</a></span><span class="message">fossy: i will add documentation about kconfig/config tomorrow</span></div><div class="line" id="221128"><span class="nick" style="color:#389600"><a href="#221128" label="[22:11:28]">&lt;stikonas&gt;</a></span><span class="message">fossy: it's a huuuge Makefile for coreutils...</span></div><div class="line" id="221204"><span class="nick" style="color:#af8d2f"><a href="#221204" label="[22:12:04]">&lt;gforce_d11977&gt;</a></span><span class="message">stikonas: you are right, these sizes are compressed, so 'myunix' is much smaller</span></div><div class="line" id="221207"><span class="nick" style="color:#6b8072"><a href="#221207" label="[22:12:07]">&lt;fossy&gt;</a></span><span class="message">gforce_d11977: I have an almost complete CI for live bootstrap <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/pull/3">https://github.com/fosslinux/live-bootstrap/pull/3</a> </span></div><div class="line" id="221221"><span class="nick" style="color:#6b8072"><a href="#221221" label="[22:12:21]">&lt;fossy&gt;</a></span><span class="message">gforce_d11977: myunix is not complete enough yet for use</span></div><div class="line" id="221226"><span class="nick" style="color:#af8d2f"><a href="#221226" label="[22:12:26]">&lt;gforce_d11977&gt;</a></span><span class="message">fossy: yes, but is does not work locally</span></div><div class="line" id="221230"><span class="nick" style="color:#6b8072"><a href="#221230" label="[22:12:30]">&lt;fossy&gt;</a></span><span class="message">stikonas: unsuprsing.</span></div><div class="line" id="221246"><span class="nick" style="color:#389600"><a href="#221246" label="[22:12:46]">&lt;stikonas&gt;</a></span><span class="message">fossy: I've got most important utils working (last one is &quot;ls&quot;)</span></div><div class="line" id="221312"><span class="nick" style="color:#389600"><a href="#221312" label="[22:13:12]">&lt;stikonas&gt;</a></span><span class="message">that's in my test environment, not in live-bootstrap, but usually it's close enough</span></div><div class="line" id="221318"><span class="nick" style="color:#6b8072"><a href="#221318" label="[22:13:18]">&lt;fossy&gt;</a></span><span class="message">gforce_d11977: its going to be because of the slimmed down kernel, some option will be missing</span></div><div class="line" id="221334"><span class="nick" style="color:#6b8072"><a href="#221334" label="[22:13:34]">&lt;fossy&gt;</a></span><span class="message">stikonas: cool, what tools do you think we need?</span></div><div class="line" id="221345"><span class="nick" style="color:#389600"><a href="#221345" label="[22:13:45]">&lt;stikonas&gt;</a></span><span class="message">well, I've got most of them working</span></div><div class="line" id="221357"><span class="nick" style="color:#389600"><a href="#221357" label="[22:13:57]">&lt;stikonas&gt;</a></span><span class="message">basename cat chmod cksum csplit cut echo expand factor false fmt fold head id kill li\</span></div><div class="line" id="221358"><span class="nick" style="color:#389600"><a href="#221358" label="[22:13:58]">&lt;stikonas&gt;</a></span><span class="message">nk ln logname mkfifo mkdir mv nl od paste pathchk printf ptx pwd readlink rmdir seq split sum tai\</span></div><div class="line" id="221400"><span class="nick" style="color:#389600"><a href="#221400" label="[22:14:00]">&lt;stikonas&gt;</a></span><span class="message">l tr tsort unexpand unlink wc whoami</span></div><div class="line" id="221412"><span class="nick" style="color:#389600"><a href="#221412" label="[22:14:12]">&lt;stikonas&gt;</a></span><span class="message">also md5sum rm mv sha1sum</span></div><div class="line" id="221431"><span class="nick" style="color:#389600"><a href="#221431" label="[22:14:31]">&lt;stikonas&gt;</a></span><span class="message">fossy: some are a bit broken, but I think important ones are working</span></div><div class="line" id="221435"><span class="nick" style="color:#6b8072"><a href="#221435" label="[22:14:35]">&lt;fossy&gt;</a></span><span class="message">nice!!</span></div><div class="line" id="221437"><span class="nick" style="color:#389600"><a href="#221437" label="[22:14:37]">&lt;stikonas&gt;</a></span><span class="message">e.g. seq prints zeroes...</span></div><div class="line" id="221502"><span class="nick" style="color:#389600"><a href="#221502" label="[22:15:02]">&lt;stikonas&gt;</a></span><span class="message">I probably need another 2hours or so to finish this</span></div><div class="line" id="221549"><span class="nick" style="color:#6b8072"><a href="#221549" label="[22:15:49]">&lt;fossy&gt;</a></span><span class="message">take your time</span></div><div class="line" id="221723"><span class="nick" style="color:#389600"><a href="#221723" label="[22:17:23]">&lt;stikonas&gt;</a></span><span class="message">anyway, review and merge grep</span></div><div class="line" id="221728"><span class="nick" style="color:#389600"><a href="#221728" label="[22:17:28]">&lt;stikonas&gt;</a></span><span class="message">it was fairly easy</span></div><div class="line" id="223915"><span class="nick" style="color:#389600"><a href="#223915" label="[22:39:15]">&lt;stikonas&gt;</a></span><span class="message">fossy: ls will probably have to wait</span></div><div class="line" id="223922"><span class="nick" style="color:#389600"><a href="#223922" label="[22:39:22]">&lt;stikonas&gt;</a></span><span class="message">until we get better libc</span></div><div class="line" id="223949"><span class="nick" style="color:#389600"><a href="#223949" label="[22:39:49]">&lt;stikonas&gt;</a></span><span class="message">or we add more patches...</span></div><div class="line" id="224006"><span class="nick" style="color:#389600"><a href="#224006" label="[22:40:06]">&lt;stikonas&gt;</a></span><span class="message">but I think we can live without ls for a bit longer</span></div><div class="line" id="230857"><span class="nick" style="color:#389600"><a href="#230857" label="[23:08:57]">&lt;stikonas&gt;</a></span><span class="message">fossy: fixed that PR and tested again</span></div><div class="line" id="233252"><span class="nick" style="color:#6b8072"><a href="#233252" label="[23:32:52]">&lt;fossy&gt;</a></span><span class="message">stikonas: I think we can too</span></div><div class="line" id="233402"><span class="nick" style="color:#389600"><a href="#233402" label="[23:34:02]">&lt;stikonas&gt;</a></span><span class="message">anyway, I'm now starting to test coreutils in live-bootstrap</span></div><div class="line" id="235020"><span class="nick" style="color:#389600"><a href="#235020" label="[23:50:20]">&lt;stikonas&gt;</a></span><span class="message">fossy: hmm, something is wrong with GH PR request...</span></div><div class="line" id="235035"><span class="nick" style="color:#389600"><a href="#235035" label="[23:50:35]">&lt;stikonas&gt;</a></span><span class="message">I've pushed those fixes into my branch, but somehow PR didn't spot new changes...</span></div><div class="line" id="235227"><span class="nick" style="color:#389600"><a href="#235227" label="[23:52:27]">&lt;stikonas&gt;</a></span><span class="message">I've opened a new one <a rel="nofollow" href="https://github.com/fosslinux/live-bootstrap/pull/16/files">https://github.com/fosslinux/live-bootstrap/pull/16/files</a> </span></div><br /></div></body></html>